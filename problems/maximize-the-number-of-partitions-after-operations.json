{
  "id": "maximize-the-number-of-partitions-after-operations",
  "title": "Maximize The Number Of Partitions After Operations",
  "difficulty": "Hard",
  "tags": [
    "Bit Manipulation",
    "String",
    "Dynamic Programming",
    "Bitmask"
  ],
  "description": "You are given a string s and an integer k.\nFirst, you are allowed to change at most one index in s to another lowercase English letter.\nAfter that, do the following partitioning operation until s is empty:\n\nChoose the longest prefix of s containing at most k distinct characters.\nDelete the prefix from s and increase the number of partitions by one. The remaining characters (if any) in s maintain their initial order.\n\nReturn an integer denoting the maximum number of resulting partitions after the operations by optimally choosing at most one index to change.\n\u00a0\nExample 1:\n\nInput: s = \"accca\", k = 2\nOutput: 3\nExplanation:\nThe optimal way is to change s[2] to something other than a and c, for example, b. then it becomes \"acbca\".\nThen we perform the operations:\n\nThe longest prefix containing at most 2 distinct characters is \"ac\", we remove it and s becomes \"bca\".\nNow The longest prefix containing at most 2 distinct characters is \"bc\", so we remove it and s becomes \"a\".\nFinally, we remove \"a\" and s becomes empty, so the procedure ends.\n\nDoing the operations, the string is divided into 3 partitions, so the answer is 3.\n\nExample 2:\n\nInput: s = \"aabaab\", k = 3\nOutput: 1\nExplanation:\nInitially\u00a0s\u00a0contains 2 distinct characters, so whichever character we change, it will contain at most 3 distinct characters, so the longest prefix with at most 3 distinct characters would always be all of it, therefore the answer is 1.\n\nExample 3:\n\nInput: s = \"xxyz\", k = 1\nOutput: 4\nExplanation:\nThe optimal way is to change\u00a0s[0]\u00a0or\u00a0s[1]\u00a0to something other than characters in\u00a0s, for example, to change\u00a0s[0]\u00a0to\u00a0w.\nThen\u00a0s\u00a0becomes \"wxyz\", which consists of 4 distinct characters, so as k is 1, it will divide into 4 partitions.\n\n\u00a0\nConstraints:\n\n1 <= s.length <= 104\ns consists only of lowercase English letters.\n1 <= k <= 26\n\n",
  "entry_point": "Solution().maxPartitionsAfterOperations",
  "starter_code": "class Solution:\n    def maxPartitionsAfterOperations(self, s: str, k: int) -> int:\n        ",
  "preamble": "from typing import *\nfrom collections import *\nfrom functools import *\nfrom itertools import *\nfrom heapq import *\nfrom bisect import *\nfrom math import *\nimport math, collections, functools, itertools, bisect, heapq, string, re\n",
  "check_function": "def check(candidate):\n    assert candidate(s = \"zzzzzzz\",k = 1) == 3\n    assert candidate(s = \"abcdef\",k = 6) == 1\n    assert candidate(s = \"aaaaaaa\",k = 1) == 3\n    assert candidate(s = \"abcdefghijklmnop\",k = 5) == 4\n    assert candidate(s = \"aabacbebebe\",k = 3) == 2\n    assert candidate(s = \"aaaabbbbcccc\",k = 3) == 2\n    assert candidate(s = \"zzzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"abcd\",k = 2) == 2\n    assert candidate(s = \"abacabadabacaba\",k = 3) == 4\n    assert candidate(s = \"aabaab\",k = 3) == 1\n    assert candidate(s = \"aabbccddeeffgg\",k = 2) == 4\n    assert candidate(s = \"accca\",k = 2) == 3\n    assert candidate(s = \"aabbaa\",k = 2) == 2\n    assert candidate(s = \"zzzzz\",k = 1) == 3\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 10) == 3\n    assert candidate(s = \"aabbccddeeff\",k = 3) == 3\n    assert candidate(s = \"xxyz\",k = 1) == 4\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 26) == 1\n    assert candidate(s = \"abcdabcd\",k = 4) == 2\n    assert candidate(s = \"zzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"abcdefg\",k = 7) == 1\n    assert candidate(s = \"aabbaabb\",k = 2) == 3\n    assert candidate(s = \"zzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"abacabadabacaba\",k = 2) == 7\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyz\",k = 26) == 1\n    assert candidate(s = \"abcdefabcdef\",k = 4) == 3\n    assert candidate(s = \"aabbccddeeff\",k = 2) == 4\n    assert candidate(s = \"abcabcabcabcabcabcabcabcabcabc\",k = 2) == 15\n    assert candidate(s = \"abcdefg\",k = 3) == 3\n    assert candidate(s = \"abcabcabc\",k = 3) == 3\n    assert candidate(s = \"abacabad\",k = 2) == 4\n    assert candidate(s = \"aaaa\",k = 1) == 3\n    assert candidate(s = \"abcabcabcabc\",k = 3) == 3\n    assert candidate(s = \"aabcccccaabaab\",k = 2) == 4\n    assert candidate(s = \"mnopqrstuvw\",k = 6) == 2\n    assert candidate(s = \"abcdabcdabcdabcd\",k = 4) == 3\n    assert candidate(s = \"xyzxyzxyzxyzxyz\",k = 3) == 3\n    assert candidate(s = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 5) == 1\n    assert candidate(s = \"qwertyuiopasdfghjklzxcvbnm\",k = 10) == 3\n    assert candidate(s = \"ababababababab\",k = 2) == 3\n    assert candidate(s = \"banana\",k = 2) == 3\n    assert candidate(s = \"aaaaabbbbbaaaaabbbbb\",k = 2) == 3\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 1) == 27\n    assert candidate(s = \"aaabbbcccdddeeefffggghhh\",k = 2) == 5\n    assert candidate(s = \"abcdefghijklaaaa\",k = 4) == 4\n    assert candidate(s = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"zzzzzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"ababababababababab\",k = 2) == 3\n    assert candidate(s = \"abcdefgabcdefg\",k = 4) == 4\n    assert candidate(s = \"mississippi\",k = 2) == 4\n    assert candidate(s = \"zzzzzzzzzzzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"llllllllllllllllllllllllll\",k = 1) == 3\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 5) == 6\n    assert candidate(s = \"abcabcabcabcabc\",k = 2) == 8\n    assert candidate(s = \"xyxyxyxyxyxyxyxy\",k = 2) == 3\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyza\",k = 10) == 3\n    assert candidate(s = \"abcabcabcabcabcabc\",k = 3) == 3\n    assert candidate(s = \"zzzzzzzzzzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"xyzzzzxyzzzz\",k = 2) == 4\n    assert candidate(s = \"abcabcaabbccbbaccc\",k = 2) == 7\n    assert candidate(s = \"abcdeabcdeabcde\",k = 5) == 3\n    assert candidate(s = \"abcdefghijabcdefghijabcdefghij\",k = 5) == 6\n    assert candidate(s = \"abcabcabcabcabcabcabcabc\",k = 2) == 12\n    assert candidate(s = \"abcdefabcdefabcdef\",k = 5) == 4\n    assert candidate(s = \"aabbaabbaabbaabbaabbaabb\",k = 2) == 3\n    assert candidate(s = \"abcdabcdabcd\",k = 3) == 4\n    assert candidate(s = \"abcdefghij\",k = 5) == 2\n    assert candidate(s = \"aaabbbcccddd\",k = 3) == 2\n    assert candidate(s = \"aabbccddeeffgghhii\",k = 26) == 1\n    assert candidate(s = \"abcabcabcabc\",k = 2) == 6\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyza\",k = 25) == 2\n    assert candidate(s = \"abababababababababababababababababababababababababababababab\",k = 2) == 3\n    assert candidate(s = \"ababababababababababababababab\",k = 2) == 3\n    assert candidate(s = \"zzzzzzzzzzzzzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"abcabcabcabcabcabcabcabcabcabc\",k = 3) == 3\n    assert candidate(s = \"zzzzzzzzzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"abcdefghij\",k = 1) == 10\n    assert candidate(s = \"aabbbcccccdddd\",k = 3) == 2\n    assert candidate(s = \"aaaaaaaaabbbbbbb\",k = 2) == 2\n    assert candidate(s = \"aabbaabbaabbaabb\",k = 2) == 3\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcd\",k = 4) == 3\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyz\",k = 10) == 3\n    assert candidate(s = \"aabccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 5) == 6\n    assert candidate(s = \"abcdefg\",k = 1) == 7\n    assert candidate(s = \"abbaabbaabba\",k = 2) == 3\n    assert candidate(s = \"abracadabra\",k = 4) == 3\n    assert candidate(s = \"aabbaabbccddeeffgg\",k = 3) == 3\n    assert candidate(s = \"zzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 3\n    assert candidate(s = \"abcabcabc\",k = 2) == 5\n    assert candidate(s = \"xyzzxyzzxyzzxyzzxyzzxyzzxyzzxyzzxyzzxyzz\",k = 2) == 16\n    assert candidate(s = \"aabbccddeeffgghhii\",k = 5) == 2\n    assert candidate(s = \"abababababab\",k = 2) == 3\n    assert candidate(s = \"ababababababababababababab\",k = 2) == 3\n    assert candidate(s = \"xyzzxyzzxyzz\",k = 3) == 3\n    assert candidate(s = \"aaaaaaaaaabbbbbbbbccccccccdddddddd\",k = 4) == 2\n    assert candidate(s = \"mississippi\",k = 3) == 3\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyz\",k = 1) == 26\n    assert candidate(s = \"lalalalalala\",k = 2) == 3\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 3) == 9\n    assert candidate(s = \"aaabbbcccdddeeefffggghhhiiijjjkkklllmmmnnnooopppqqqrrrssstttuuuvvvwwwxxxxyyyyzzzz\",k = 4) == 7\n    assert candidate(s = \"aaaaaabbbbbbbccc\",k = 2) == 3\n    assert candidate(s = \"xyzxyzxyzxyzxyzxyz\",k = 3) == 3\n    assert candidate(s = \"xyzzzxyzzzxyzzz\",k = 3) == 3\n    assert candidate(s = \"abracadabra\",k = 2) == 6\n    assert candidate(s = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 3) == 3\n    assert candidate(s = \"abacbacbacbacba\",k = 4) == 1\n    assert candidate(s = \"abcdefg\",k = 2) == 4\n    assert candidate(s = \"abababababababab\",k = 2) == 3\n    assert candidate(s = \"xyzzzxyzzzxyzzz\",k = 2) == 6\n    assert candidate(s = \"abracadabraabracadabraabracadabra\",k = 3) == 8\n    assert candidate(s = \"abcdabcdbca\",k = 3) == 4\n    assert candidate(s = \"zzzzzabczzzzzdefzzzzzghizzzzzjklzzzzzmnopzzzzzqrstzzzzzuvwxyz\",k = 26) == 1\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz\",k = 13) == 4\n",
  "test_cases": [
    "assert candidate(s = \"zzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"abcdef\",k = 6) == 1",
    "assert candidate(s = \"aaaaaaa\",k = 1) == 3",
    "assert candidate(s = \"abcdefghijklmnop\",k = 5) == 4",
    "assert candidate(s = \"aabacbebebe\",k = 3) == 2",
    "assert candidate(s = \"aaaabbbbcccc\",k = 3) == 2",
    "assert candidate(s = \"zzzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"abcd\",k = 2) == 2",
    "assert candidate(s = \"abacabadabacaba\",k = 3) == 4",
    "assert candidate(s = \"aabaab\",k = 3) == 1",
    "assert candidate(s = \"aabbccddeeffgg\",k = 2) == 4",
    "assert candidate(s = \"accca\",k = 2) == 3",
    "assert candidate(s = \"aabbaa\",k = 2) == 2",
    "assert candidate(s = \"zzzzz\",k = 1) == 3",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 10) == 3",
    "assert candidate(s = \"aabbccddeeff\",k = 3) == 3",
    "assert candidate(s = \"xxyz\",k = 1) == 4",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 26) == 1",
    "assert candidate(s = \"abcdabcd\",k = 4) == 2",
    "assert candidate(s = \"zzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"abcdefg\",k = 7) == 1",
    "assert candidate(s = \"aabbaabb\",k = 2) == 3",
    "assert candidate(s = \"zzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"abacabadabacaba\",k = 2) == 7",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyz\",k = 26) == 1",
    "assert candidate(s = \"abcdefabcdef\",k = 4) == 3",
    "assert candidate(s = \"aabbccddeeff\",k = 2) == 4",
    "assert candidate(s = \"abcabcabcabcabcabcabcabcabcabc\",k = 2) == 15",
    "assert candidate(s = \"abcdefg\",k = 3) == 3",
    "assert candidate(s = \"abcabcabc\",k = 3) == 3",
    "assert candidate(s = \"abacabad\",k = 2) == 4",
    "assert candidate(s = \"aaaa\",k = 1) == 3",
    "assert candidate(s = \"abcabcabcabc\",k = 3) == 3",
    "assert candidate(s = \"aabcccccaabaab\",k = 2) == 4",
    "assert candidate(s = \"mnopqrstuvw\",k = 6) == 2",
    "assert candidate(s = \"abcdabcdabcdabcd\",k = 4) == 3",
    "assert candidate(s = \"xyzxyzxyzxyzxyz\",k = 3) == 3",
    "assert candidate(s = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 5) == 1",
    "assert candidate(s = \"qwertyuiopasdfghjklzxcvbnm\",k = 10) == 3",
    "assert candidate(s = \"ababababababab\",k = 2) == 3",
    "assert candidate(s = \"banana\",k = 2) == 3",
    "assert candidate(s = \"aaaaabbbbbaaaaabbbbb\",k = 2) == 3",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 1) == 27",
    "assert candidate(s = \"aaabbbcccdddeeefffggghhh\",k = 2) == 5",
    "assert candidate(s = \"abcdefghijklaaaa\",k = 4) == 4",
    "assert candidate(s = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"zzzzzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"ababababababababab\",k = 2) == 3",
    "assert candidate(s = \"abcdefgabcdefg\",k = 4) == 4",
    "assert candidate(s = \"mississippi\",k = 2) == 4",
    "assert candidate(s = \"zzzzzzzzzzzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"llllllllllllllllllllllllll\",k = 1) == 3",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 5) == 6",
    "assert candidate(s = \"abcabcabcabcabc\",k = 2) == 8",
    "assert candidate(s = \"xyxyxyxyxyxyxyxy\",k = 2) == 3",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyza\",k = 10) == 3",
    "assert candidate(s = \"abcabcabcabcabcabc\",k = 3) == 3",
    "assert candidate(s = \"zzzzzzzzzzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"xyzzzzxyzzzz\",k = 2) == 4",
    "assert candidate(s = \"abcabcaabbccbbaccc\",k = 2) == 7",
    "assert candidate(s = \"abcdeabcdeabcde\",k = 5) == 3",
    "assert candidate(s = \"abcdefghijabcdefghijabcdefghij\",k = 5) == 6",
    "assert candidate(s = \"abcabcabcabcabcabcabcabc\",k = 2) == 12",
    "assert candidate(s = \"abcdefabcdefabcdef\",k = 5) == 4",
    "assert candidate(s = \"aabbaabbaabbaabbaabbaabb\",k = 2) == 3",
    "assert candidate(s = \"abcdabcdabcd\",k = 3) == 4",
    "assert candidate(s = \"abcdefghij\",k = 5) == 2",
    "assert candidate(s = \"aaabbbcccddd\",k = 3) == 2",
    "assert candidate(s = \"aabbccddeeffgghhii\",k = 26) == 1",
    "assert candidate(s = \"abcabcabcabc\",k = 2) == 6",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyza\",k = 25) == 2",
    "assert candidate(s = \"abababababababababababababababababababababababababababababab\",k = 2) == 3",
    "assert candidate(s = \"ababababababababababababababab\",k = 2) == 3",
    "assert candidate(s = \"zzzzzzzzzzzzzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"abcabcabcabcabcabcabcabcabcabc\",k = 3) == 3",
    "assert candidate(s = \"zzzzzzzzzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"abcdefghij\",k = 1) == 10",
    "assert candidate(s = \"aabbbcccccdddd\",k = 3) == 2",
    "assert candidate(s = \"aaaaaaaaabbbbbbb\",k = 2) == 2",
    "assert candidate(s = \"aabbaabbaabbaabb\",k = 2) == 3",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcd\",k = 4) == 3",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyz\",k = 10) == 3",
    "assert candidate(s = \"aabccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 5) == 6",
    "assert candidate(s = \"abcdefg\",k = 1) == 7",
    "assert candidate(s = \"abbaabbaabba\",k = 2) == 3",
    "assert candidate(s = \"abracadabra\",k = 4) == 3",
    "assert candidate(s = \"aabbaabbccddeeffgg\",k = 3) == 3",
    "assert candidate(s = \"zzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 3",
    "assert candidate(s = \"abcabcabc\",k = 2) == 5",
    "assert candidate(s = \"xyzzxyzzxyzzxyzzxyzzxyzzxyzzxyzzxyzzxyzz\",k = 2) == 16",
    "assert candidate(s = \"aabbccddeeffgghhii\",k = 5) == 2",
    "assert candidate(s = \"abababababab\",k = 2) == 3",
    "assert candidate(s = \"ababababababababababababab\",k = 2) == 3",
    "assert candidate(s = \"xyzzxyzzxyzz\",k = 3) == 3",
    "assert candidate(s = \"aaaaaaaaaabbbbbbbbccccccccdddddddd\",k = 4) == 2",
    "assert candidate(s = \"mississippi\",k = 3) == 3",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyz\",k = 1) == 26",
    "assert candidate(s = \"lalalalalala\",k = 2) == 3",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 3) == 9",
    "assert candidate(s = \"aaabbbcccdddeeefffggghhhiiijjjkkklllmmmnnnooopppqqqrrrssstttuuuvvvwwwxxxxyyyyzzzz\",k = 4) == 7",
    "assert candidate(s = \"aaaaaabbbbbbbccc\",k = 2) == 3",
    "assert candidate(s = \"xyzxyzxyzxyzxyzxyz\",k = 3) == 3",
    "assert candidate(s = \"xyzzzxyzzzxyzzz\",k = 3) == 3",
    "assert candidate(s = \"abracadabra\",k = 2) == 6",
    "assert candidate(s = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 3) == 3",
    "assert candidate(s = \"abacbacbacbacba\",k = 4) == 1",
    "assert candidate(s = \"abcdefg\",k = 2) == 4",
    "assert candidate(s = \"abababababababab\",k = 2) == 3",
    "assert candidate(s = \"xyzzzxyzzzxyzzz\",k = 2) == 6",
    "assert candidate(s = \"abracadabraabracadabraabracadabra\",k = 3) == 8",
    "assert candidate(s = \"abcdabcdbca\",k = 3) == 4",
    "assert candidate(s = \"zzzzzabczzzzzdefzzzzzghizzzzzjklzzzzzmnopzzzzzqrstzzzzzuvwxyz\",k = 26) == 1",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz\",k = 13) == 4"
  ]
}