{
  "id": "count-different-palindromic-subsequences",
  "title": "Count Different Palindromic Subsequences",
  "difficulty": "Hard",
  "tags": [
    "String",
    "Dynamic Programming"
  ],
  "description": "Given a string s, return the number of different non-empty palindromic subsequences in s. Since the answer may be very large, return it modulo 109 + 7.\nA subsequence of a string is obtained by deleting zero or more characters from the string.\nA sequence is palindromic if it is equal to the sequence reversed.\nTwo sequences a1, a2, ... and b1, b2, ... are different if there is some i for which ai != bi.\n\u00a0\nExample 1:\n\nInput: s = \"bccb\"\nOutput: 6\nExplanation: The 6 different non-empty palindromic subsequences are 'b', 'c', 'bb', 'cc', 'bcb', 'bccb'.\nNote that 'bcb' is counted only once, even though it occurs twice.\n\nExample 2:\n\nInput: s = \"abcdabcdabcdabcdabcdabcdabcdabcddcbadcbadcbadcbadcbadcbadcbadcba\"\nOutput: 104860361\nExplanation: There are 3104860382 different non-empty palindromic subsequences, which is 104860361 modulo 109 + 7.\n\n\u00a0\nConstraints:\n\n1 <= s.length <= 1000\ns[i] is either 'a', 'b', 'c', or 'd'.\n\n",
  "entry_point": "Solution().countPalindromicSubsequences",
  "starter_code": "class Solution:\n    def countPalindromicSubsequences(self, s: str) -> int:\n        ",
  "preamble": "from typing import *\nfrom collections import *\nfrom functools import *\nfrom itertools import *\nfrom heapq import *\nfrom bisect import *\nfrom math import *\nimport math, collections, functools, itertools, bisect, heapq, string, re\n",
  "check_function": "def check(candidate):\n    assert candidate(s = \"abba\") == 6\n    assert candidate(s = \"abccba\") == 14\n    assert candidate(s = \"abcba\") == 10\n    assert candidate(s = \"abac\") == 5\n    assert candidate(s = \"a\") == 1\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcddcbadcbadcbadcbadcbadcbadcbadcba\") == 104860361\n    assert candidate(s = \"aabbaa\") == 10\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcd\") == 29348\n    assert candidate(s = \"abcddcba\") == 30\n    assert candidate(s = \"bccb\") == 6\n    assert candidate(s = \"aaa\") == 3\n    assert candidate(s = \"abcd\") == 4\n    assert candidate(s = \"aabb\") == 4\n    assert candidate(s = \"aaaa\") == 4\n    assert candidate(s = \"abab\") == 6\n    assert candidate(s = \"abacabadabacabadabacaba\") == 2571\n    assert candidate(s = \"ababbabaabbababbab\") == 212\n    assert candidate(s = \"aabbaabbaabb\") == 44\n    assert candidate(s = \"aaaabbbbccccaaaabbbbccccaaaabbbbcccc\") == 996\n    assert candidate(s = \"ddccbbbaaacccbdd\") == 94\n    assert candidate(s = \"abcabcabcabc\") == 84\n    assert candidate(s = \"aaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccdddd\") == 127372410\n    assert candidate(s = \"abcddcbaabcddcba\") == 340\n    assert candidate(s = \"abcdabcdabcd\") == 72\n    assert candidate(s = \"abababababababababababababababab\") == 8358\n    assert candidate(s = \"aaaabbbbccccddddaaaabbbbccccdddd\") == 224\n    assert candidate(s = \"abacaba\") == 19\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 450061485\n    assert candidate(s = \"aaaabbbaaaaabbbbaaaaabbbbaaaaabbbbaaaaabbbbaaaaabbbbaaaa\") == 61293\n    assert candidate(s = \"abcdcba\") == 22\n    assert candidate(s = \"acbdca\") == 14\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 320164\n    assert candidate(s = \"ababababababababababababababababababababababababababababababababababababababababababab\") == 672623781\n    assert candidate(s = \"abcdbca\") == 20\n    assert candidate(s = \"abccbaabccbaabccba\") == 446\n    assert candidate(s = \"abcdabcdaabbccbddc\") == 184\n    assert candidate(s = \"ababababababab\") == 106\n    assert candidate(s = \"abababababab\") == 64\n    assert candidate(s = \"abcababcababcababcababcababcababcababcab\") == 237716\n    assert candidate(s = \"abcdabcdaabbccbddcddcbaabccbddcddcba\") == 17166\n    assert candidate(s = \"abcabcabcabcabcabc\") == 504\n    assert candidate(s = \"aababaababaababaababaababaababaababaababaababaababa\") == 442187\n    assert candidate(s = \"abbbccaddccbbbaabbbccaddccbbba\") == 4260\n    assert candidate(s = \"abcdabcdabcdabcd\") == 244\n    assert candidate(s = \"abcdabcdabcdabcdabcd\") == 812\n    assert candidate(s = \"ddccbbbaaacccbbbaaacccbdd\") == 607\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 38097140\n    assert candidate(s = \"dddddddddddddddddddddddd\") == 24\n    assert candidate(s = \"abababababababababab\") == 462\n    assert candidate(s = \"aaaaa\") == 5\n    assert candidate(s = \"abacabadabacaba\") == 232\n    assert candidate(s = \"dcbadcbadcbadcbadcbadcb\") == 2219\n    assert candidate(s = \"aabababababababa\") == 161\n    assert candidate(s = \"abcdabcd\") == 20\n    assert candidate(s = \"aaaaabbbbbcccc\") == 14\n    assert candidate(s = \"abccccddddddbbbaaaadddbbbbccccaaaabbbccbbccbbccbbccbbccbbccbbbbaaaaddbbbbccccaaaaadddbbbbccccaaaabbbccbbccbbccbbccbbccbbccbbbbaaaadd\") == 584072730\n    assert candidate(s = \"dcbaabcd\") == 30\n    assert candidate(s = \"abcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcd\") == 852725823\n    assert candidate(s = \"abcdabcdbabcdbabcdb\") == 607\n    assert candidate(s = \"aaaabbbbccccdddd\") == 16\n    assert candidate(s = \"abacabadabacabadabacabad\") == 2784\n    assert candidate(s = \"abbaabbaabba\") == 54\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 96936\n    assert candidate(s = \"aabbccddccbbaa\") == 106\n    assert candidate(s = \"abccbaabcba\") == 56\n    assert candidate(s = \"abababababababababababab\") == 1216\n    assert candidate(s = \"ababababab\") == 38\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcda\") == 198263755\n    assert candidate(s = \"abcabc\") == 12\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 125826312\n    assert candidate(s = \"abcdcbadcbadcbabcd\") == 432\n    assert candidate(s = \"abcabcabcabcabcabcabcabc\") == 2952\n    assert candidate(s = \"dcbbabdccacbaaadbcbbabcbbb\") == 934\n    assert candidate(s = \"ababa\") == 9\n    assert candidate(s = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\") == 320443980\n    assert candidate(s = \"ddddcbbaabcdccbdddbddbcccbdbabdbbaccabdbdddcbbaabaddabbdcbbaabcddbacccbadcbbaabcdccbdddbddbcccbdbabdbbaccabdbddd\") == 923039370\n    assert candidate(s = \"abcadcbadcbadcb\") == 210\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcddcbadcbadcbadcbadcbadcbadcbadcbaabcd\") == 649659461\n    assert candidate(s = \"abcdcbaabcdcbaabcdcba\") == 1694\n",
  "test_cases": [
    "assert candidate(s = \"abba\") == 6",
    "assert candidate(s = \"abccba\") == 14",
    "assert candidate(s = \"abcba\") == 10",
    "assert candidate(s = \"abac\") == 5",
    "assert candidate(s = \"a\") == 1",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcddcbadcbadcbadcbadcbadcbadcbadcba\") == 104860361",
    "assert candidate(s = \"aabbaa\") == 10",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcd\") == 29348",
    "assert candidate(s = \"abcddcba\") == 30",
    "assert candidate(s = \"bccb\") == 6",
    "assert candidate(s = \"aaa\") == 3",
    "assert candidate(s = \"abcd\") == 4",
    "assert candidate(s = \"aabb\") == 4",
    "assert candidate(s = \"aaaa\") == 4",
    "assert candidate(s = \"abab\") == 6",
    "assert candidate(s = \"abacabadabacabadabacaba\") == 2571",
    "assert candidate(s = \"ababbabaabbababbab\") == 212",
    "assert candidate(s = \"aabbaabbaabb\") == 44",
    "assert candidate(s = \"aaaabbbbccccaaaabbbbccccaaaabbbbcccc\") == 996",
    "assert candidate(s = \"ddccbbbaaacccbdd\") == 94",
    "assert candidate(s = \"abcabcabcabc\") == 84",
    "assert candidate(s = \"aaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccddddaaaaabbbbbccccdddd\") == 127372410",
    "assert candidate(s = \"abcddcbaabcddcba\") == 340",
    "assert candidate(s = \"abcdabcdabcd\") == 72",
    "assert candidate(s = \"abababababababababababababababab\") == 8358",
    "assert candidate(s = \"aaaabbbbccccddddaaaabbbbccccdddd\") == 224",
    "assert candidate(s = \"abacaba\") == 19",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 450061485",
    "assert candidate(s = \"aaaabbbaaaaabbbbaaaaabbbbaaaaabbbbaaaaabbbbaaaaabbbbaaaa\") == 61293",
    "assert candidate(s = \"abcdcba\") == 22",
    "assert candidate(s = \"acbdca\") == 14",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 320164",
    "assert candidate(s = \"ababababababababababababababababababababababababababababababababababababababababababab\") == 672623781",
    "assert candidate(s = \"abcdbca\") == 20",
    "assert candidate(s = \"abccbaabccbaabccba\") == 446",
    "assert candidate(s = \"abcdabcdaabbccbddc\") == 184",
    "assert candidate(s = \"ababababababab\") == 106",
    "assert candidate(s = \"abababababab\") == 64",
    "assert candidate(s = \"abcababcababcababcababcababcababcababcab\") == 237716",
    "assert candidate(s = \"abcdabcdaabbccbddcddcbaabccbddcddcba\") == 17166",
    "assert candidate(s = \"abcabcabcabcabcabc\") == 504",
    "assert candidate(s = \"aababaababaababaababaababaababaababaababaababaababa\") == 442187",
    "assert candidate(s = \"abbbccaddccbbbaabbbccaddccbbba\") == 4260",
    "assert candidate(s = \"abcdabcdabcdabcd\") == 244",
    "assert candidate(s = \"abcdabcdabcdabcdabcd\") == 812",
    "assert candidate(s = \"ddccbbbaaacccbbbaaacccbdd\") == 607",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 38097140",
    "assert candidate(s = \"dddddddddddddddddddddddd\") == 24",
    "assert candidate(s = \"abababababababababab\") == 462",
    "assert candidate(s = \"aaaaa\") == 5",
    "assert candidate(s = \"abacabadabacaba\") == 232",
    "assert candidate(s = \"dcbadcbadcbadcbadcbadcb\") == 2219",
    "assert candidate(s = \"aabababababababa\") == 161",
    "assert candidate(s = \"abcdabcd\") == 20",
    "assert candidate(s = \"aaaaabbbbbcccc\") == 14",
    "assert candidate(s = \"abccccddddddbbbaaaadddbbbbccccaaaabbbccbbccbbccbbccbbccbbccbbbbaaaaddbbbbccccaaaaadddbbbbccccaaaabbbccbbccbbccbbccbbccbbccbbbbaaaadd\") == 584072730",
    "assert candidate(s = \"dcbaabcd\") == 30",
    "assert candidate(s = \"abcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcdabcabcd\") == 852725823",
    "assert candidate(s = \"abcdabcdbabcdbabcdb\") == 607",
    "assert candidate(s = \"aaaabbbbccccdddd\") == 16",
    "assert candidate(s = \"abacabadabacabadabacabad\") == 2784",
    "assert candidate(s = \"abbaabbaabba\") == 54",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 96936",
    "assert candidate(s = \"aabbccddccbbaa\") == 106",
    "assert candidate(s = \"abccbaabcba\") == 56",
    "assert candidate(s = \"abababababababababababab\") == 1216",
    "assert candidate(s = \"ababababab\") == 38",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcda\") == 198263755",
    "assert candidate(s = \"abcabc\") == 12",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == 125826312",
    "assert candidate(s = \"abcdcbadcbadcbabcd\") == 432",
    "assert candidate(s = \"abcabcabcabcabcabcabcabc\") == 2952",
    "assert candidate(s = \"dcbbabdccacbaaadbcbbabcbbb\") == 934",
    "assert candidate(s = \"ababa\") == 9",
    "assert candidate(s = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\") == 320443980",
    "assert candidate(s = \"ddddcbbaabcdccbdddbddbcccbdbabdbbaccabdbdddcbbaabaddabbdcbbaabcddbacccbadcbbaabcdccbdddbddbcccbdbabdbbaccabdbddd\") == 923039370",
    "assert candidate(s = \"abcadcbadcbadcb\") == 210",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcddcbadcbadcbadcbadcbadcbadcbadcbaabcd\") == 649659461",
    "assert candidate(s = \"abcdcbaabcdcbaabcdcba\") == 1694"
  ]
}