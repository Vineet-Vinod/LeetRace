{
  "id": "evaluate-the-bracket-pairs-of-a-string",
  "title": "Evaluate The Bracket Pairs Of A String",
  "difficulty": "Medium",
  "tags": [
    "Array",
    "Hash Table",
    "String"
  ],
  "description": "You are given a string s that contains some bracket pairs, with each pair containing a non-empty key.\n\nFor example, in the string \"(name)is(age)yearsold\", there are two bracket pairs that contain the keys \"name\" and \"age\".\n\nYou know the values of a wide range of keys. This is represented by a 2D string array knowledge where each knowledge[i] = [keyi, valuei] indicates that key keyi has a value of valuei.\nYou are tasked to evaluate all of the bracket pairs. When you evaluate a bracket pair that contains some key keyi, you will:\n\nReplace keyi and the bracket pair with the key's corresponding valuei.\nIf you do not know the value of the key, you will replace keyi and the bracket pair with a question mark \"?\" (without the quotation marks).\n\nEach key will appear at most once in your knowledge. There will not be any nested brackets in s.\nReturn the resulting string after evaluating all of the bracket pairs.\n\u00a0\nExample 1:\n\nInput: s = \"(name)is(age)yearsold\", knowledge = [[\"name\",\"bob\"],[\"age\",\"two\"]]\nOutput: \"bobistwoyearsold\"\nExplanation:\nThe key \"name\" has a value of \"bob\", so replace \"(name)\" with \"bob\".\nThe key \"age\" has a value of \"two\", so replace \"(age)\" with \"two\".\n\nExample 2:\n\nInput: s = \"hi(name)\", knowledge = [[\"a\",\"b\"]]\nOutput: \"hi?\"\nExplanation: As you do not know the value of the key \"name\", replace \"(name)\" with \"?\".\n\nExample 3:\n\nInput: s = \"(a)(a)(a)aaa\", knowledge = [[\"a\",\"yes\"]]\nOutput: \"yesyesyesaaa\"\nExplanation: The same key can appear multiple times.\nThe key \"a\" has a value of \"yes\", so replace all occurrences of \"(a)\" with \"yes\".\nNotice that the \"a\"s not in a bracket pair are not evaluated.\n\n\u00a0\nConstraints:\n\n1 <= s.length <= 105\n0 <= knowledge.length <= 105\nknowledge[i].length == 2\n1 <= keyi.length, valuei.length <= 10\ns consists of lowercase English letters and round brackets '(' and ')'.\nEvery open bracket '(' in s will have a corresponding close bracket ')'.\nThe key in each bracket pair of s will be non-empty.\nThere will not be any nested bracket pairs in s.\nkeyi and valuei consist of lowercase English letters.\nEach keyi in knowledge is unique.\n\n",
  "entry_point": "Solution().evaluate",
  "starter_code": "class Solution:\n    def evaluate(self, s: str, knowledge: List[List[str]]) -> str:\n        ",
  "preamble": "from typing import *\nfrom collections import *\nfrom functools import *\nfrom itertools import *\nfrom heapq import *\nfrom bisect import *\nfrom math import *\nimport math, collections, functools, itertools, bisect, heapq, string, re\n",
  "check_function": "def check(candidate):\n    assert candidate(s = \"(a)(a)(a)aaa\",knowledge = [['a', 'yes']]) == \"yesyesyesaaa\"\n    assert candidate(s = \"(a)(b)(c)(d)\",knowledge = [['a', '1'], ['b', '2'], ['c', '3']]) == \"123?\"\n    assert candidate(s = \"hi(name)\",knowledge = [['a', 'b']]) == \"hi?\"\n    assert candidate(s = \"(a)(a)(a)aaa\",knowledge = [['a', 'yes']]) == \"yesyesyesaaa\"\n    assert candidate(s = \"\",knowledge = []) == \"\"\n    assert candidate(s = \"noknowledgehere\",knowledge = []) == \"noknowledgehere\"\n    assert candidate(s = \"no(brackets)here\",knowledge = []) == \"no?here\"\n    assert candidate(s = \"hi(name)\",knowledge = [['a', 'b']]) == \"hi?\"\n    assert candidate(s = \"(nested)but(not)really\",knowledge = [['nested', 'nested'], ['not', 'not']]) == \"nestedbutnotreally\"\n    assert candidate(s = \"(key1)(key2)(key3)\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"value1value2?\"\n    assert candidate(s = \"this(is)a(test)\",knowledge = [['is', 'was'], ['test', 'trial']]) == \"thiswasatrial\"\n    assert candidate(s = \"(name)is(age)yearsold\",knowledge = [['name', 'bob'], ['age', 'two']]) == \"bobistwoyearsold\"\n    assert candidate(s = \"(key1)(key2)\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"value1value2\"\n    assert candidate(s = \"(single)\",knowledge = [['single', 'one']]) == \"one\"\n    assert candidate(s = \"(last)one\",knowledge = [['last', 'final']]) == \"finalone\"\n    assert candidate(s = \"single\",knowledge = [['single', 'word']]) == \"single\"\n    assert candidate(s = \"hello\",knowledge = []) == \"hello\"\n    assert candidate(s = \"(unknown)key\",knowledge = [['known', 'value']]) == \"?key\"\n    assert candidate(s = \"(name)is(age)yearsold\",knowledge = [['name', 'bob'], ['age', 'two']]) == \"bobistwoyearsold\"\n    assert candidate(s = \"(key1)(key2)(key3)\",knowledge = [['key1', 'val1'], ['key2', 'val2'], ['key3', 'val3']]) == \"val1val2val3\"\n    assert candidate(s = \"(book)written(by)(author)\",knowledge = [['book', '1984'], ['author', 'George']]) == \"1984written?George\"\n    assert candidate(s = \"(city)(in)(country)\",knowledge = [['city', 'Tokyo'], ['country', 'Japan']]) == \"Tokyo?Japan\"\n    assert candidate(s = \"(nested)(key)(nested)\",knowledge = [['key', 'value'], ['nested', 'deep']]) == \"deepvaluedeep\"\n    assert candidate(s = \"(ingredient)requiresto(cooktime)mins\",knowledge = [['ingredient', 'Cookies'], ['cooktime', '15']]) == \"Cookiesrequiresto15mins\"\n    assert candidate(s = \"(one)(two)(three)(four)(five)\",knowledge = [['one', '1'], ['two', '2'], ['three', '3'], ['four', '4']]) == \"1234?\"\n    assert candidate(s = \"(customer)(order)at(store)\",knowledge = [['customer', 'Alice'], ['order', 'Order123']]) == \"AliceOrder123at?\"\n    assert candidate(s = \"(keyA)and(keyB)and(keyC)and(keyD)\",knowledge = [['keyA', 'valA'], ['keyB', 'valB']]) == \"valAandvalBand?and?\"\n    assert candidate(s = \"(key)with(missing)knowledge\",knowledge = [['key', 'value1'], ['missing', 'value2'], ['knowledge', 'value3']]) == \"value1withvalue2knowledge\"\n    assert candidate(s = \"(greeting)(world)(planet)\",knowledge = [['greeting', 'hello'], ['world', 'earth'], ['planet', 'mars']]) == \"helloearthmars\"\n    assert candidate(s = \"(this)(is)(a)(test)(string)(with)(multiple)(keys)\",knowledge = [['this', 'it'], ['is', 'be'], ['a', 'an'], ['test', 'example'], ['string', 'sequence'], ['with', 'having'], ['multiple', 'several'], ['keys', 'identifiers']]) == \"itbeanexamplesequencehavingseveralidentifiers\"\n    assert candidate(s = \"(language)programmingis(fun)\",knowledge = [['language', 'python'], ['fun', 'awesome']]) == \"pythonprogrammingisawesome\"\n    assert candidate(s = \"(fruit)(vegetable)\",knowledge = [['fruit', 'apple'], ['vegetable', 'carrot']]) == \"applecarrot\"\n    assert candidate(s = \"(animal)lives(in)(habitat)\",knowledge = [['animal', 'tiger'], ['habitat', 'jungle']]) == \"tigerlives?jungle\"\n    assert candidate(s = \"(name)has(age)yearsand(occupation)\",knowledge = [['name', 'Alice'], ['age', '30']]) == \"Alicehas30yearsand?\"\n    assert candidate(s = \"(longkey)(anotherkey)(yetanotherkey)\",knowledge = [['longkey', 'averylongvalue'], ['anotherkey', 'shortval'], ['yetanotherkey', 'value']]) == \"averylongvalueshortvalvalue\"\n    assert candidate(s = \"(language)is(cool)\",knowledge = [['language', 'Python'], ['cool', 'awesome']]) == \"Pythonisawesome\"\n    assert candidate(s = \"(first)and(last)name\",knowledge = [['first', 'john'], ['last', 'doe']]) == \"johnanddoename\"\n    assert candidate(s = \"(name)is(living)(in)(city)\",knowledge = [['name', 'bob'], ['in', 'at'], ['city', 'london']]) == \"bobis?atlondon\"\n    assert candidate(s = \"(animal)(eats)(food)\",knowledge = [['animal', 'lion'], ['food', 'meat']]) == \"lion?meat\"\n    assert candidate(s = \"(user)likes(to)(eat)(food)\",knowledge = [['user', 'alice'], ['eat', 'enjoy'], ['food', 'pizza']]) == \"alicelikes?enjoypizza\"\n    assert candidate(s = \"(prefix)middle(suffix)\",knowledge = [['prefix', 'start'], ['suffix', 'end']]) == \"startmiddleend\"\n    assert candidate(s = \"(flower)grows(in)(soil)\",knowledge = [['flower', 'rose'], ['soil', 'dirt']]) == \"rosegrows?dirt\"\n    assert candidate(s = \"(first)nameis(last)name\",knowledge = [['first', 'john'], ['last', 'doe']]) == \"johnnameisdoename\"\n    assert candidate(s = \"(longkey1)and(longkey2)and(longkey3)and(longkey4)\",knowledge = [['longkey1', 'value1'], ['longkey2', 'value2'], ['longkey3', 'value3'], ['longkey4', 'value4']]) == \"value1andvalue2andvalue3andvalue4\"\n    assert candidate(s = \"(department)islocatedat(address)\",knowledge = [['department', 'Sales'], ['address', '123BusinessSt']]) == \"Salesislocatedat123BusinessSt\"\n    assert candidate(s = \"(name)has(a)(pet)\",knowledge = [['name', 'Mary'], ['pet', 'dog']]) == \"Maryhas?dog\"\n    assert candidate(s = \"(drink)is(served)in(glass)\",knowledge = [['drink', 'water'], ['glass', 'big']]) == \"wateris?inbig\"\n    assert candidate(s = \"prefix(key1)middle(key2)suffix\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"prefixvalue1middlevalue2suffix\"\n    assert candidate(s = \"(key1)(key2)(key1)\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"value1value2value1\"\n    assert candidate(s = \"(item1)(item2)(item3)(item4)\",knowledge = [['item1', 'itemA'], ['item2', 'itemB'], ['item4', 'itemD']]) == \"itemAitemB?itemD\"\n    assert candidate(s = \"(greeting)world\",knowledge = [['greeting', 'hello'], ['farewell', 'bye']]) == \"helloworld\"\n    assert candidate(s = \"(user)(name)livesin(city)with(zip)\",knowledge = [['user', 'John'], ['city', 'San Francisco'], ['zip', '94111']]) == \"John?livesinSan Franciscowith94111\"\n    assert candidate(s = \"(person)(from)(place)isvisiting(placeofinterest)\",knowledge = [['person', 'Bob'], ['from', 'LosAngeles'], ['place', 'SanFrancisco'], ['placeofinterest', 'Alcatraz']]) == \"BobLosAngelesSanFranciscoisvisitingAlcatraz\"\n    assert candidate(s = \"(longkeyname)is(longervaluename)\",knowledge = [['longkeyname', 'longervaluename']]) == \"longervaluenameis?\"\n    assert candidate(s = \"(name)has(a)(pet)(dog)\",knowledge = [['name', 'john'], ['pet', 'dog'], ['dog', 'buddy']]) == \"johnhas?dogbuddy\"\n    assert candidate(s = \"(key1)and(key2)and(key3)and(key4)and(key5)\",knowledge = [['key1', 'value1'], ['key2', 'value2'], ['key3', 'value3'], ['key4', 'value4']]) == \"value1andvalue2andvalue3andvalue4and?\"\n    assert candidate(s = \"(prefix)_(suffix)\",knowledge = [['prefix', 'start'], ['suffix', 'end']]) == \"start_end\"\n    assert candidate(s = \"(number)plus(number)equals(twice_number)\",knowledge = [['number', '10'], ['twice_number', '20']]) == \"10plus10equals20\"\n    assert candidate(s = \"(name)livesat(address)andworksat(company)\",knowledge = [['name', 'Alice'], ['address', 'Wonderland'], ['company', 'TechCorp']]) == \"AlicelivesatWonderlandandworksatTechCorp\"\n    assert candidate(s = \"(repeated)(key)(repeated)(key)\",knowledge = [['key', 'value']]) == \"?value?value\"\n    assert candidate(s = \"(planet)(orbits)around(star)\",knowledge = [['planet', 'Earth'], ['star', 'Sun']]) == \"Earth?aroundSun\"\n    assert candidate(s = \"(item)isavaliablefrom(date)\",knowledge = [['item', 'Smartphone'], ['date', '2023-12-15']]) == \"Smartphoneisavaliablefrom2023-12-15\"\n    assert candidate(s = \"(conference)heldon(date)\",knowledge = [['conference', 'GDC'], ['date', '2024-03-19']]) == \"GDCheldon2024-03-19\"\n    assert candidate(s = \"(first)(second)(third)(fourth)\",knowledge = [['first', 'one'], ['second', 'two'], ['third', 'three']]) == \"onetwothree?\"\n    assert candidate(s = \"(color)(animal)\",knowledge = [['color', 'blue'], ['animal', 'dog'], ['bird', 'sparrow']]) == \"bluedog\"\n    assert candidate(s = \"(firstName)(lastName)isfrom(city)in(country)\",knowledge = [['firstName', 'Alice'], ['lastName', 'Wonderland'], ['city', 'Wonderland'], ['country', 'Fantasia']]) == \"AliceWonderlandisfromWonderlandinFantasia\"\n    assert candidate(s = \"(product)costs(dollars)and(euros)\",knowledge = [['product', 'Laptop'], ['dollars', '1200'], ['euros', '1020']]) == \"Laptopcosts1200and1020\"\n    assert candidate(s = \"(nested)but(notreally)nested\",knowledge = [['nested', 'deep'], ['notreally', 'shallow']]) == \"deepbutshallownested\"\n    assert candidate(s = \"(first)(last)(age)\",knowledge = [['first', 'john'], ['last', 'doe'], ['age', 'thirty']]) == \"johndoethirty\"\n    assert candidate(s = \"(city)(has)(many)(buildings)\",knowledge = [['city', 'newyork'], ['many', 'lots']]) == \"newyork?lots?\"\n    assert candidate(s = \"(language)(framework)\",knowledge = [['language', 'Python'], ['framework', 'Django'], ['version', '3.9']]) == \"PythonDjango\"\n    assert candidate(s = \"(model)releasedon(year)\",knowledge = [['model', 'iPhone15'], ['year', '2023']]) == \"iPhone15releasedon2023\"\n    assert candidate(s = \"(multiple)(keys)(here)\",knowledge = [['multiple', 'many'], ['keys', 'some'], ['here', 'there']]) == \"manysomethere\"\n    assert candidate(s = \"(username)lastloggedin(on)\",knowledge = [['username', 'Alice'], ['on', '2023-10-01']]) == \"Alicelastloggedin2023-10-01\"\n    assert candidate(s = \"(planet)is(almost)full\",knowledge = [['planet', 'Earth'], ['almost', 'not'], ['full', 'occupied']]) == \"Earthisnotfull\"\n    assert candidate(s = \"(person)loves(to)(eat)\",knowledge = [['person', 'John'], ['eat', 'pizza']]) == \"Johnloves?pizza\"\n    assert candidate(s = \"(car)is(fast)and(economical)\",knowledge = [['car', 'Ferrari'], ['fast', 'very'], ['economical', 'not']]) == \"Ferrariisveryandnot\"\n    assert candidate(s = \"(key1)and(key2)and(key3)and(key4)\",knowledge = [['key1', 'value1'], ['key2', 'value2'], ['key4', 'value4']]) == \"value1andvalue2and?andvalue4\"\n    assert candidate(s = \"(part1)(part2)(part3)\",knowledge = [['part1', 'first'], ['part2', 'second'], ['part3', 'third']]) == \"firstsecondthird\"\n    assert candidate(s = \"(color)(is)(used)in(art)\",knowledge = [['color', 'red'], ['used', 'frequently']]) == \"red?frequentlyin?\"\n    assert candidate(s = \"(key1)is(key2)and(key3)is(key4)\",knowledge = [['key1', 'value1'], ['key2', 'value2'], ['key3', 'value3']]) == \"value1isvalue2andvalue3is?\"\n    assert candidate(s = \"(name)from(country)is(visitor)\",knowledge = [['name', 'Bob'], ['country', 'USA']]) == \"BobfromUSAis?\"\n    assert candidate(s = \"(prefix)example(suffix)\",knowledge = [['prefix', 'pre'], ['suffix', 'post']]) == \"preexamplepost\"\n    assert candidate(s = \"(unknown)(key)(not)(present)\",knowledge = [['present', 'available']]) == \"???available\"\n    assert candidate(s = \"(unknown)(key1)(unknown)(key2)(unknown)\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"?value1?value2?\"\n    assert candidate(s = \"(book)writtenby(author)publishedby(publisher)\",knowledge = [['book', 'GreatExpectations'], ['author', 'CharlesDickens'], ['publisher', 'ChapmanandHall']]) == \"GreatExpectationswrittenbyCharlesDickenspublishedbyChapmanandHall\"\n    assert candidate(s = \"(instrument)plays(music)\",knowledge = [['instrument', 'guitar'], ['music', 'beautiful']]) == \"guitarplaysbeautiful\"\n    assert candidate(s = \"(prefix)(middle)(suffix)\",knowledge = [['prefix', 'pre'], ['middle', 'mid'], ['suffix', 'suf']]) == \"premidsuf\"\n    assert candidate(s = \"(fruit)are(sweet)and(healthy)\",knowledge = [['fruit', 'apples'], ['sweet', 'very'], ['healthy', 'indeed']]) == \"applesareveryandindeed\"\n    assert candidate(s = \"(repeated)repeated(repeated)\",knowledge = [['repeated', 'again']]) == \"againrepeatedagain\"\n    assert candidate(s = \"(planet)(moon)orbiting(planet)\",knowledge = [['planet', 'Earth'], ['moon', 'Moon']]) == \"EarthMoonorbitingEarth\"\n    assert candidate(s = \"(key1)(key1)(key1)(key1)(key1)\",knowledge = [['key1', 'repeat']]) == \"repeatrepeatrepeatrepeatrepeat\"\n    assert candidate(s = \"(key1)is(key2)yearsold(key3)\",knowledge = [['key1', 'bob'], ['key2', 'two']]) == \"bobistwoyearsold?\"\n    assert candidate(s = \"(greeting)everyone(my)name(is)(unknown)\",knowledge = [['greeting', 'hi'], ['my', 'my']]) == \"hieveryonemyname??\"\n    assert candidate(s = \"(bird)can(fly)high\",knowledge = [['bird', 'eagle'], ['fly', 'soar']]) == \"eaglecansoarhigh\"\n    assert candidate(s = \"(country)has(a)(capital)\",knowledge = [['country', 'India'], ['capital', 'Delhi']]) == \"Indiahas?Delhi\"\n    assert candidate(s = \"(a)(b)(c)(d)(e)(f)\",knowledge = [['a', 'one'], ['b', 'two'], ['c', 'three'], ['d', 'four'], ['e', 'five'], ['f', 'six']]) == \"onetwothreefourfivesix\"\n    assert candidate(s = \"(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)(m)(n)(o)(p)(q)(r)(s)(t)(u)(v)(w)(x)(y)(z)\",knowledge = [['a', 'A'], ['b', 'B'], ['c', 'C'], ['d', 'D'], ['e', 'E'], ['f', 'F'], ['g', 'G'], ['h', 'H'], ['i', 'I'], ['j', 'J'], ['k', 'K'], ['l', 'L'], ['m', 'M'], ['n', 'N'], ['o', 'O'], ['p', 'P'], ['q', 'Q'], ['r', 'R'], ['s', 'S'], ['t', 'T'], ['u', 'U'], ['v', 'V'], ['w', 'W'], ['x', 'X'], ['y', 'Y'], ['z', 'Z']]) == \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n    assert candidate(s = \"(color)(of)the(sky)\",knowledge = [['color', 'blue'], ['sky', 'beautiful']]) == \"blue?thebeautiful\"\n    assert candidate(s = \"(name)is(unknown)but(age)yearsold\",knowledge = [['name', 'alice'], ['age', '30']]) == \"aliceis?but30yearsold\"\n    assert candidate(s = \"(product)priceis(price)and(quantity)itemsareavailable\",knowledge = [['product', 'laptop'], ['price', '1000'], ['quantity', '5']]) == \"laptoppriceis1000and5itemsareavailable\"\n    assert candidate(s = \"(item)costs(amount)currency\",knowledge = [['item', 'book'], ['amount', '10'], ['currency', 'dollars']]) == \"bookcosts10currency\"\n    assert candidate(s = \"(a)(b)(c)(d)(e)\",knowledge = [['a', 'alpha'], ['b', 'beta'], ['c', 'gamma'], ['d', 'delta'], ['e', 'epsilon']]) == \"alphabetagammadeltaepsilon\"\n    assert candidate(s = \"(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)(m)(n)(o)(p)(q)(r)(s)(t)(u)(v)(w)(x)(y)(z)\",knowledge = [['a', 'a'], ['b', 'b'], ['c', 'c'], ['d', 'd'], ['e', 'e'], ['f', 'f'], ['g', 'g'], ['h', 'h'], ['i', 'i'], ['j', 'j'], ['k', 'k'], ['l', 'l'], ['m', 'm'], ['n', 'n'], ['o', 'o'], ['p', 'p'], ['q', 'q'], ['r', 'r'], ['s', 's'], ['t', 't'], ['u', 'u'], ['v', 'v'], ['w', 'w'], ['x', 'x'], ['y', 'y'], ['z', 'z']]) == \"abcdefghijklmnopqrstuvwxyz\"\n    assert candidate(s = \"(repeated)(repeated)(repeated)\",knowledge = [['repeated', 'rep']]) == \"repreprep\"\n    assert candidate(s = \"(key1)and(key2)and(key3)and(key4)and(key5)and(key6)and(key7)\",knowledge = [['key1', 'value1'], ['key2', 'value2'], ['key3', 'value3'], ['key4', 'value4'], ['key5', 'value5'], ['key6', 'value6'], ['key7', 'value7']]) == \"value1andvalue2andvalue3andvalue4andvalue5andvalue6andvalue7\"\n    assert candidate(s = \"(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)\",knowledge = [['a', 'one'], ['b', 'two'], ['c', 'three'], ['d', 'four'], ['e', 'five'], ['f', 'six'], ['g', 'seven'], ['h', 'eight'], ['i', 'nine'], ['j', 'ten']]) == \"onetwothreefourfivesixseveneightnineten\"\n    assert candidate(s = \"(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)\",knowledge = [['a', 'yes'], ['b', 'no'], ['c', 'maybe'], ['d', 'sure'], ['e', 'never'], ['f', 'always'], ['g', 'often'], ['h', 'rarely'], ['i', 'sometimes'], ['j', 'usually']]) == \"yesnomaybesureneveralwaysoftenrarelysometimesusually\"\n    assert candidate(s = \"(user)hasposted(numberofposts)times\",knowledge = [['user', 'Charlie'], ['numberofposts', '250']]) == \"Charliehasposted250times\"\n    assert candidate(s = \"(complex)(string)(with)(multiple)(keys)\",knowledge = [['complex', 'com'], ['string', 'str'], ['with', 'wi'], ['multiple', 'mul'], ['keys', 'ke']]) == \"comstrwimulke\"\n    assert candidate(s = \"(key1)is(key2)yearsold(key3)and(key4)livesin(key5)\",knowledge = [['key1', 'bob'], ['key2', 'two'], ['key5', 'NYC']]) == \"bobistwoyearsold?and?livesinNYC\"\n    assert candidate(s = \"(a)(b)(c)(d)(e)(f)\",knowledge = [['a', 'alpha'], ['b', 'beta'], ['c', 'gamma'], ['d', 'delta'], ['e', 'epsilon']]) == \"alphabetagammadeltaepsilon?\"\n    assert candidate(s = \"(nested)brackets(are)not(allowed)\",knowledge = [['nested', 'nested'], ['brackets', 'brackets'], ['not', 'not']]) == \"nestedbrackets?not?\"\n",
  "test_cases": [
    "assert candidate(s = \"(a)(a)(a)aaa\",knowledge = [['a', 'yes']]) == \"yesyesyesaaa\"",
    "assert candidate(s = \"(a)(b)(c)(d)\",knowledge = [['a', '1'], ['b', '2'], ['c', '3']]) == \"123?\"",
    "assert candidate(s = \"hi(name)\",knowledge = [['a', 'b']]) == \"hi?\"",
    "assert candidate(s = \"(a)(a)(a)aaa\",knowledge = [['a', 'yes']]) == \"yesyesyesaaa\"",
    "assert candidate(s = \"\",knowledge = []) == \"\"",
    "assert candidate(s = \"noknowledgehere\",knowledge = []) == \"noknowledgehere\"",
    "assert candidate(s = \"no(brackets)here\",knowledge = []) == \"no?here\"",
    "assert candidate(s = \"hi(name)\",knowledge = [['a', 'b']]) == \"hi?\"",
    "assert candidate(s = \"(nested)but(not)really\",knowledge = [['nested', 'nested'], ['not', 'not']]) == \"nestedbutnotreally\"",
    "assert candidate(s = \"(key1)(key2)(key3)\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"value1value2?\"",
    "assert candidate(s = \"this(is)a(test)\",knowledge = [['is', 'was'], ['test', 'trial']]) == \"thiswasatrial\"",
    "assert candidate(s = \"(name)is(age)yearsold\",knowledge = [['name', 'bob'], ['age', 'two']]) == \"bobistwoyearsold\"",
    "assert candidate(s = \"(key1)(key2)\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"value1value2\"",
    "assert candidate(s = \"(single)\",knowledge = [['single', 'one']]) == \"one\"",
    "assert candidate(s = \"(last)one\",knowledge = [['last', 'final']]) == \"finalone\"",
    "assert candidate(s = \"single\",knowledge = [['single', 'word']]) == \"single\"",
    "assert candidate(s = \"hello\",knowledge = []) == \"hello\"",
    "assert candidate(s = \"(unknown)key\",knowledge = [['known', 'value']]) == \"?key\"",
    "assert candidate(s = \"(name)is(age)yearsold\",knowledge = [['name', 'bob'], ['age', 'two']]) == \"bobistwoyearsold\"",
    "assert candidate(s = \"(key1)(key2)(key3)\",knowledge = [['key1', 'val1'], ['key2', 'val2'], ['key3', 'val3']]) == \"val1val2val3\"",
    "assert candidate(s = \"(book)written(by)(author)\",knowledge = [['book', '1984'], ['author', 'George']]) == \"1984written?George\"",
    "assert candidate(s = \"(city)(in)(country)\",knowledge = [['city', 'Tokyo'], ['country', 'Japan']]) == \"Tokyo?Japan\"",
    "assert candidate(s = \"(nested)(key)(nested)\",knowledge = [['key', 'value'], ['nested', 'deep']]) == \"deepvaluedeep\"",
    "assert candidate(s = \"(ingredient)requiresto(cooktime)mins\",knowledge = [['ingredient', 'Cookies'], ['cooktime', '15']]) == \"Cookiesrequiresto15mins\"",
    "assert candidate(s = \"(one)(two)(three)(four)(five)\",knowledge = [['one', '1'], ['two', '2'], ['three', '3'], ['four', '4']]) == \"1234?\"",
    "assert candidate(s = \"(customer)(order)at(store)\",knowledge = [['customer', 'Alice'], ['order', 'Order123']]) == \"AliceOrder123at?\"",
    "assert candidate(s = \"(keyA)and(keyB)and(keyC)and(keyD)\",knowledge = [['keyA', 'valA'], ['keyB', 'valB']]) == \"valAandvalBand?and?\"",
    "assert candidate(s = \"(key)with(missing)knowledge\",knowledge = [['key', 'value1'], ['missing', 'value2'], ['knowledge', 'value3']]) == \"value1withvalue2knowledge\"",
    "assert candidate(s = \"(greeting)(world)(planet)\",knowledge = [['greeting', 'hello'], ['world', 'earth'], ['planet', 'mars']]) == \"helloearthmars\"",
    "assert candidate(s = \"(this)(is)(a)(test)(string)(with)(multiple)(keys)\",knowledge = [['this', 'it'], ['is', 'be'], ['a', 'an'], ['test', 'example'], ['string', 'sequence'], ['with', 'having'], ['multiple', 'several'], ['keys', 'identifiers']]) == \"itbeanexamplesequencehavingseveralidentifiers\"",
    "assert candidate(s = \"(language)programmingis(fun)\",knowledge = [['language', 'python'], ['fun', 'awesome']]) == \"pythonprogrammingisawesome\"",
    "assert candidate(s = \"(fruit)(vegetable)\",knowledge = [['fruit', 'apple'], ['vegetable', 'carrot']]) == \"applecarrot\"",
    "assert candidate(s = \"(animal)lives(in)(habitat)\",knowledge = [['animal', 'tiger'], ['habitat', 'jungle']]) == \"tigerlives?jungle\"",
    "assert candidate(s = \"(name)has(age)yearsand(occupation)\",knowledge = [['name', 'Alice'], ['age', '30']]) == \"Alicehas30yearsand?\"",
    "assert candidate(s = \"(longkey)(anotherkey)(yetanotherkey)\",knowledge = [['longkey', 'averylongvalue'], ['anotherkey', 'shortval'], ['yetanotherkey', 'value']]) == \"averylongvalueshortvalvalue\"",
    "assert candidate(s = \"(language)is(cool)\",knowledge = [['language', 'Python'], ['cool', 'awesome']]) == \"Pythonisawesome\"",
    "assert candidate(s = \"(first)and(last)name\",knowledge = [['first', 'john'], ['last', 'doe']]) == \"johnanddoename\"",
    "assert candidate(s = \"(name)is(living)(in)(city)\",knowledge = [['name', 'bob'], ['in', 'at'], ['city', 'london']]) == \"bobis?atlondon\"",
    "assert candidate(s = \"(animal)(eats)(food)\",knowledge = [['animal', 'lion'], ['food', 'meat']]) == \"lion?meat\"",
    "assert candidate(s = \"(user)likes(to)(eat)(food)\",knowledge = [['user', 'alice'], ['eat', 'enjoy'], ['food', 'pizza']]) == \"alicelikes?enjoypizza\"",
    "assert candidate(s = \"(prefix)middle(suffix)\",knowledge = [['prefix', 'start'], ['suffix', 'end']]) == \"startmiddleend\"",
    "assert candidate(s = \"(flower)grows(in)(soil)\",knowledge = [['flower', 'rose'], ['soil', 'dirt']]) == \"rosegrows?dirt\"",
    "assert candidate(s = \"(first)nameis(last)name\",knowledge = [['first', 'john'], ['last', 'doe']]) == \"johnnameisdoename\"",
    "assert candidate(s = \"(longkey1)and(longkey2)and(longkey3)and(longkey4)\",knowledge = [['longkey1', 'value1'], ['longkey2', 'value2'], ['longkey3', 'value3'], ['longkey4', 'value4']]) == \"value1andvalue2andvalue3andvalue4\"",
    "assert candidate(s = \"(department)islocatedat(address)\",knowledge = [['department', 'Sales'], ['address', '123BusinessSt']]) == \"Salesislocatedat123BusinessSt\"",
    "assert candidate(s = \"(name)has(a)(pet)\",knowledge = [['name', 'Mary'], ['pet', 'dog']]) == \"Maryhas?dog\"",
    "assert candidate(s = \"(drink)is(served)in(glass)\",knowledge = [['drink', 'water'], ['glass', 'big']]) == \"wateris?inbig\"",
    "assert candidate(s = \"prefix(key1)middle(key2)suffix\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"prefixvalue1middlevalue2suffix\"",
    "assert candidate(s = \"(key1)(key2)(key1)\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"value1value2value1\"",
    "assert candidate(s = \"(item1)(item2)(item3)(item4)\",knowledge = [['item1', 'itemA'], ['item2', 'itemB'], ['item4', 'itemD']]) == \"itemAitemB?itemD\"",
    "assert candidate(s = \"(greeting)world\",knowledge = [['greeting', 'hello'], ['farewell', 'bye']]) == \"helloworld\"",
    "assert candidate(s = \"(user)(name)livesin(city)with(zip)\",knowledge = [['user', 'John'], ['city', 'San Francisco'], ['zip', '94111']]) == \"John?livesinSan Franciscowith94111\"",
    "assert candidate(s = \"(person)(from)(place)isvisiting(placeofinterest)\",knowledge = [['person', 'Bob'], ['from', 'LosAngeles'], ['place', 'SanFrancisco'], ['placeofinterest', 'Alcatraz']]) == \"BobLosAngelesSanFranciscoisvisitingAlcatraz\"",
    "assert candidate(s = \"(longkeyname)is(longervaluename)\",knowledge = [['longkeyname', 'longervaluename']]) == \"longervaluenameis?\"",
    "assert candidate(s = \"(name)has(a)(pet)(dog)\",knowledge = [['name', 'john'], ['pet', 'dog'], ['dog', 'buddy']]) == \"johnhas?dogbuddy\"",
    "assert candidate(s = \"(key1)and(key2)and(key3)and(key4)and(key5)\",knowledge = [['key1', 'value1'], ['key2', 'value2'], ['key3', 'value3'], ['key4', 'value4']]) == \"value1andvalue2andvalue3andvalue4and?\"",
    "assert candidate(s = \"(prefix)_(suffix)\",knowledge = [['prefix', 'start'], ['suffix', 'end']]) == \"start_end\"",
    "assert candidate(s = \"(number)plus(number)equals(twice_number)\",knowledge = [['number', '10'], ['twice_number', '20']]) == \"10plus10equals20\"",
    "assert candidate(s = \"(name)livesat(address)andworksat(company)\",knowledge = [['name', 'Alice'], ['address', 'Wonderland'], ['company', 'TechCorp']]) == \"AlicelivesatWonderlandandworksatTechCorp\"",
    "assert candidate(s = \"(repeated)(key)(repeated)(key)\",knowledge = [['key', 'value']]) == \"?value?value\"",
    "assert candidate(s = \"(planet)(orbits)around(star)\",knowledge = [['planet', 'Earth'], ['star', 'Sun']]) == \"Earth?aroundSun\"",
    "assert candidate(s = \"(item)isavaliablefrom(date)\",knowledge = [['item', 'Smartphone'], ['date', '2023-12-15']]) == \"Smartphoneisavaliablefrom2023-12-15\"",
    "assert candidate(s = \"(conference)heldon(date)\",knowledge = [['conference', 'GDC'], ['date', '2024-03-19']]) == \"GDCheldon2024-03-19\"",
    "assert candidate(s = \"(first)(second)(third)(fourth)\",knowledge = [['first', 'one'], ['second', 'two'], ['third', 'three']]) == \"onetwothree?\"",
    "assert candidate(s = \"(color)(animal)\",knowledge = [['color', 'blue'], ['animal', 'dog'], ['bird', 'sparrow']]) == \"bluedog\"",
    "assert candidate(s = \"(firstName)(lastName)isfrom(city)in(country)\",knowledge = [['firstName', 'Alice'], ['lastName', 'Wonderland'], ['city', 'Wonderland'], ['country', 'Fantasia']]) == \"AliceWonderlandisfromWonderlandinFantasia\"",
    "assert candidate(s = \"(product)costs(dollars)and(euros)\",knowledge = [['product', 'Laptop'], ['dollars', '1200'], ['euros', '1020']]) == \"Laptopcosts1200and1020\"",
    "assert candidate(s = \"(nested)but(notreally)nested\",knowledge = [['nested', 'deep'], ['notreally', 'shallow']]) == \"deepbutshallownested\"",
    "assert candidate(s = \"(first)(last)(age)\",knowledge = [['first', 'john'], ['last', 'doe'], ['age', 'thirty']]) == \"johndoethirty\"",
    "assert candidate(s = \"(city)(has)(many)(buildings)\",knowledge = [['city', 'newyork'], ['many', 'lots']]) == \"newyork?lots?\"",
    "assert candidate(s = \"(language)(framework)\",knowledge = [['language', 'Python'], ['framework', 'Django'], ['version', '3.9']]) == \"PythonDjango\"",
    "assert candidate(s = \"(model)releasedon(year)\",knowledge = [['model', 'iPhone15'], ['year', '2023']]) == \"iPhone15releasedon2023\"",
    "assert candidate(s = \"(multiple)(keys)(here)\",knowledge = [['multiple', 'many'], ['keys', 'some'], ['here', 'there']]) == \"manysomethere\"",
    "assert candidate(s = \"(username)lastloggedin(on)\",knowledge = [['username', 'Alice'], ['on', '2023-10-01']]) == \"Alicelastloggedin2023-10-01\"",
    "assert candidate(s = \"(planet)is(almost)full\",knowledge = [['planet', 'Earth'], ['almost', 'not'], ['full', 'occupied']]) == \"Earthisnotfull\"",
    "assert candidate(s = \"(person)loves(to)(eat)\",knowledge = [['person', 'John'], ['eat', 'pizza']]) == \"Johnloves?pizza\"",
    "assert candidate(s = \"(car)is(fast)and(economical)\",knowledge = [['car', 'Ferrari'], ['fast', 'very'], ['economical', 'not']]) == \"Ferrariisveryandnot\"",
    "assert candidate(s = \"(key1)and(key2)and(key3)and(key4)\",knowledge = [['key1', 'value1'], ['key2', 'value2'], ['key4', 'value4']]) == \"value1andvalue2and?andvalue4\"",
    "assert candidate(s = \"(part1)(part2)(part3)\",knowledge = [['part1', 'first'], ['part2', 'second'], ['part3', 'third']]) == \"firstsecondthird\"",
    "assert candidate(s = \"(color)(is)(used)in(art)\",knowledge = [['color', 'red'], ['used', 'frequently']]) == \"red?frequentlyin?\"",
    "assert candidate(s = \"(key1)is(key2)and(key3)is(key4)\",knowledge = [['key1', 'value1'], ['key2', 'value2'], ['key3', 'value3']]) == \"value1isvalue2andvalue3is?\"",
    "assert candidate(s = \"(name)from(country)is(visitor)\",knowledge = [['name', 'Bob'], ['country', 'USA']]) == \"BobfromUSAis?\"",
    "assert candidate(s = \"(prefix)example(suffix)\",knowledge = [['prefix', 'pre'], ['suffix', 'post']]) == \"preexamplepost\"",
    "assert candidate(s = \"(unknown)(key)(not)(present)\",knowledge = [['present', 'available']]) == \"???available\"",
    "assert candidate(s = \"(unknown)(key1)(unknown)(key2)(unknown)\",knowledge = [['key1', 'value1'], ['key2', 'value2']]) == \"?value1?value2?\"",
    "assert candidate(s = \"(book)writtenby(author)publishedby(publisher)\",knowledge = [['book', 'GreatExpectations'], ['author', 'CharlesDickens'], ['publisher', 'ChapmanandHall']]) == \"GreatExpectationswrittenbyCharlesDickenspublishedbyChapmanandHall\"",
    "assert candidate(s = \"(instrument)plays(music)\",knowledge = [['instrument', 'guitar'], ['music', 'beautiful']]) == \"guitarplaysbeautiful\"",
    "assert candidate(s = \"(prefix)(middle)(suffix)\",knowledge = [['prefix', 'pre'], ['middle', 'mid'], ['suffix', 'suf']]) == \"premidsuf\"",
    "assert candidate(s = \"(fruit)are(sweet)and(healthy)\",knowledge = [['fruit', 'apples'], ['sweet', 'very'], ['healthy', 'indeed']]) == \"applesareveryandindeed\"",
    "assert candidate(s = \"(repeated)repeated(repeated)\",knowledge = [['repeated', 'again']]) == \"againrepeatedagain\"",
    "assert candidate(s = \"(planet)(moon)orbiting(planet)\",knowledge = [['planet', 'Earth'], ['moon', 'Moon']]) == \"EarthMoonorbitingEarth\"",
    "assert candidate(s = \"(key1)(key1)(key1)(key1)(key1)\",knowledge = [['key1', 'repeat']]) == \"repeatrepeatrepeatrepeatrepeat\"",
    "assert candidate(s = \"(key1)is(key2)yearsold(key3)\",knowledge = [['key1', 'bob'], ['key2', 'two']]) == \"bobistwoyearsold?\"",
    "assert candidate(s = \"(greeting)everyone(my)name(is)(unknown)\",knowledge = [['greeting', 'hi'], ['my', 'my']]) == \"hieveryonemyname??\"",
    "assert candidate(s = \"(bird)can(fly)high\",knowledge = [['bird', 'eagle'], ['fly', 'soar']]) == \"eaglecansoarhigh\"",
    "assert candidate(s = \"(country)has(a)(capital)\",knowledge = [['country', 'India'], ['capital', 'Delhi']]) == \"Indiahas?Delhi\"",
    "assert candidate(s = \"(a)(b)(c)(d)(e)(f)\",knowledge = [['a', 'one'], ['b', 'two'], ['c', 'three'], ['d', 'four'], ['e', 'five'], ['f', 'six']]) == \"onetwothreefourfivesix\"",
    "assert candidate(s = \"(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)(m)(n)(o)(p)(q)(r)(s)(t)(u)(v)(w)(x)(y)(z)\",knowledge = [['a', 'A'], ['b', 'B'], ['c', 'C'], ['d', 'D'], ['e', 'E'], ['f', 'F'], ['g', 'G'], ['h', 'H'], ['i', 'I'], ['j', 'J'], ['k', 'K'], ['l', 'L'], ['m', 'M'], ['n', 'N'], ['o', 'O'], ['p', 'P'], ['q', 'Q'], ['r', 'R'], ['s', 'S'], ['t', 'T'], ['u', 'U'], ['v', 'V'], ['w', 'W'], ['x', 'X'], ['y', 'Y'], ['z', 'Z']]) == \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"",
    "assert candidate(s = \"(color)(of)the(sky)\",knowledge = [['color', 'blue'], ['sky', 'beautiful']]) == \"blue?thebeautiful\"",
    "assert candidate(s = \"(name)is(unknown)but(age)yearsold\",knowledge = [['name', 'alice'], ['age', '30']]) == \"aliceis?but30yearsold\"",
    "assert candidate(s = \"(product)priceis(price)and(quantity)itemsareavailable\",knowledge = [['product', 'laptop'], ['price', '1000'], ['quantity', '5']]) == \"laptoppriceis1000and5itemsareavailable\"",
    "assert candidate(s = \"(item)costs(amount)currency\",knowledge = [['item', 'book'], ['amount', '10'], ['currency', 'dollars']]) == \"bookcosts10currency\"",
    "assert candidate(s = \"(a)(b)(c)(d)(e)\",knowledge = [['a', 'alpha'], ['b', 'beta'], ['c', 'gamma'], ['d', 'delta'], ['e', 'epsilon']]) == \"alphabetagammadeltaepsilon\"",
    "assert candidate(s = \"(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)(m)(n)(o)(p)(q)(r)(s)(t)(u)(v)(w)(x)(y)(z)\",knowledge = [['a', 'a'], ['b', 'b'], ['c', 'c'], ['d', 'd'], ['e', 'e'], ['f', 'f'], ['g', 'g'], ['h', 'h'], ['i', 'i'], ['j', 'j'], ['k', 'k'], ['l', 'l'], ['m', 'm'], ['n', 'n'], ['o', 'o'], ['p', 'p'], ['q', 'q'], ['r', 'r'], ['s', 's'], ['t', 't'], ['u', 'u'], ['v', 'v'], ['w', 'w'], ['x', 'x'], ['y', 'y'], ['z', 'z']]) == \"abcdefghijklmnopqrstuvwxyz\"",
    "assert candidate(s = \"(repeated)(repeated)(repeated)\",knowledge = [['repeated', 'rep']]) == \"repreprep\"",
    "assert candidate(s = \"(key1)and(key2)and(key3)and(key4)and(key5)and(key6)and(key7)\",knowledge = [['key1', 'value1'], ['key2', 'value2'], ['key3', 'value3'], ['key4', 'value4'], ['key5', 'value5'], ['key6', 'value6'], ['key7', 'value7']]) == \"value1andvalue2andvalue3andvalue4andvalue5andvalue6andvalue7\"",
    "assert candidate(s = \"(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)\",knowledge = [['a', 'one'], ['b', 'two'], ['c', 'three'], ['d', 'four'], ['e', 'five'], ['f', 'six'], ['g', 'seven'], ['h', 'eight'], ['i', 'nine'], ['j', 'ten']]) == \"onetwothreefourfivesixseveneightnineten\"",
    "assert candidate(s = \"(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)\",knowledge = [['a', 'yes'], ['b', 'no'], ['c', 'maybe'], ['d', 'sure'], ['e', 'never'], ['f', 'always'], ['g', 'often'], ['h', 'rarely'], ['i', 'sometimes'], ['j', 'usually']]) == \"yesnomaybesureneveralwaysoftenrarelysometimesusually\"",
    "assert candidate(s = \"(user)hasposted(numberofposts)times\",knowledge = [['user', 'Charlie'], ['numberofposts', '250']]) == \"Charliehasposted250times\"",
    "assert candidate(s = \"(complex)(string)(with)(multiple)(keys)\",knowledge = [['complex', 'com'], ['string', 'str'], ['with', 'wi'], ['multiple', 'mul'], ['keys', 'ke']]) == \"comstrwimulke\"",
    "assert candidate(s = \"(key1)is(key2)yearsold(key3)and(key4)livesin(key5)\",knowledge = [['key1', 'bob'], ['key2', 'two'], ['key5', 'NYC']]) == \"bobistwoyearsold?and?livesinNYC\"",
    "assert candidate(s = \"(a)(b)(c)(d)(e)(f)\",knowledge = [['a', 'alpha'], ['b', 'beta'], ['c', 'gamma'], ['d', 'delta'], ['e', 'epsilon']]) == \"alphabetagammadeltaepsilon?\"",
    "assert candidate(s = \"(nested)brackets(are)not(allowed)\",knowledge = [['nested', 'nested'], ['brackets', 'brackets'], ['not', 'not']]) == \"nestedbrackets?not?\""
  ]
}