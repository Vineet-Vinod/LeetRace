{
  "id": "max-sum-of-rectangle-no-larger-than-k",
  "title": "Max Sum Of Rectangle No Larger Than K",
  "difficulty": "Hard",
  "tags": [
    "Array",
    "Binary Search",
    "Matrix",
    "Ordered Set",
    "Prefix Sum"
  ],
  "description": "Given an m x n matrix matrix and an integer k, return the max sum of a rectangle in the matrix such that its sum is no larger than k.\nIt is guaranteed that there will be a rectangle with a sum no larger than k.\n\u00a0\nExample 1:\n\n\nInput: matrix = [[1,0,1],[0,-2,3]], k = 2\nOutput: 2\nExplanation: Because the sum of the blue rectangle [[0, 1], [-2, 3]] is 2, and 2 is the max number no larger than k (k = 2).\n\nExample 2:\n\nInput: matrix = [[2,2,-1]], k = 3\nOutput: 3\n\n\u00a0\nConstraints:\n\nm == matrix.length\nn == matrix[i].length\n1 <= m, n <= 100\n-100 <= matrix[i][j] <= 100\n-105 <= k <= 105\n\n\u00a0\nFollow up: What if the number of rows is much larger than the number of columns?\n",
  "entry_point": "Solution().maxSumSubmatrix",
  "starter_code": "class Solution:\n    def maxSumSubmatrix(self, matrix: List[List[int]], k: int) -> int:\n        ",
  "preamble": "from typing import *\nfrom collections import *\nfrom functools import *\nfrom itertools import *\nfrom heapq import *\nfrom bisect import *\nfrom math import *\nimport math, collections, functools, itertools, bisect, heapq, string, re\n",
  "check_function": "def check(candidate):\n    assert candidate(matrix = [[1, 0, 1], [0, 1, 0], [1, 0, 1]],k = 2) == 2\n    assert candidate(matrix = [[5, 12, 4], [3, 9, 1], [11, 1, 3]],k = 17) == 17\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3]],k = 2) == 2\n    assert candidate(matrix = [[1, 1, 1], [1, 1, 1], [1, 1, 1]],k = 2) == 2\n    assert candidate(matrix = [[-1, -1, -1], [-1, -1, -1], [-1, -1, -1]],k = -3) == -3\n    assert candidate(matrix = [[5, 6, 7], [8, 9, 10]],k = 24) == 19\n    assert candidate(matrix = [[5, -4, -3, 4], [-3, -4, 4, 5], [5, 1, 5, -4]],k = 10) == 10\n    assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]],k = 20) == 18\n    assert candidate(matrix = [[-10, -20, -30], [-40, -50, -60], [-70, -80, -90]],k = -200) == -210\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, 2, 1]],k = 4) == 4\n    assert candidate(matrix = [[2, 2, -1]],k = 3) == 3\n    assert candidate(matrix = [[-1, 0, 1, 0, -1], [0, 1, 0, -1, 0], [1, 0, -1, 0, 1]],k = 0) == 0\n    assert candidate(matrix = [[10, 20, 30], [40, 50, 60], [70, 80, 90]],k = 200) == 180\n    assert candidate(matrix = [[-1, -1, -1], [-1, -2, -3], [-3, -3, -4]],k = -5) == -5\n    assert candidate(matrix = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1]],k = 15) == 15\n    assert candidate(matrix = [[10, 20, 30], [-10, -20, -30], [15, 25, 35]],k = 25) == 25\n    assert candidate(matrix = [[5, 5, -5, 0, -5], [5, 5, 0, 0, -5], [5, 5, -5, -5, 0], [0, -5, 0, 0, 5], [0, -5, 5, 5, 5]],k = 15) == 15\n    assert candidate(matrix = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1]],k = 10) == 10\n    assert candidate(matrix = [[-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1]],k = 0) == 0\n    assert candidate(matrix = [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [6, 7, 8, 9, 10], [10, 9, 8, 7, 6], [11, 12, 13, 14, 15]],k = 30) == 30\n    assert candidate(matrix = [[-1, -2, -3, -4, -5], [-6, -7, -8, -9, -10], [-11, -12, -13, -14, -15], [-16, -17, -18, -19, -20], [-21, -22, -23, -24, -25]],k = -100) == -102\n    assert candidate(matrix = [[-5, 2, 3, -1, 4], [1, -6, 7, 8, -2], [0, 9, -3, 4, 5], [-1, -2, 3, 4, -6]],k = 5) == 5\n    assert candidate(matrix = [[-10, -20, -30, -40, -50], [-40, -50, -60, -70, -80], [-30, -40, -50, -60, -70], [-20, -30, -40, -50, -60], [-10, -20, -30, -40, -50]],k = -100) == -100\n    assert candidate(matrix = [[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],k = 0) == 0\n    assert candidate(matrix = [[100, -200, 300, -400, 500], [-500, 400, -300, 200, -100], [100, 200, 300, 400, 500], [0, -1, -2, -3, -4]],k = 100) == 100\n    assert candidate(matrix = [[-100, 100, -100, 100], [-100, 100, -100, 100], [-100, 100, -100, 100], [-100, 100, -100, 100]],k = -100) == -100\n    assert candidate(matrix = [[100, -100, 100, -100], [100, -100, 100, -100], [100, -100, 100, -100], [100, -100, 100, -100]],k = 99) == 0\n    assert candidate(matrix = [[1, 2, 3, 4, 5, 6], [2, 3, 4, 5, 6, 1], [3, 4, 5, 6, 1, 2], [4, 5, 6, 1, 2, 3], [5, 6, 1, 2, 3, 4], [6, 1, 2, 3, 4, 5]],k = 20) == 20\n    assert candidate(matrix = [[-10, -10, -10], [-10, -10, -10], [-10, -10, -10]],k = -29) == -30\n    assert candidate(matrix = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]],k = 0) == 0\n    assert candidate(matrix = [[100, -100, 100, -100], [100, -100, 100, -100], [-100, 100, -100, 100], [-100, 100, -100, 100]],k = 0) == 0\n    assert candidate(matrix = [[-10, 10, 20, 30], [-20, 5, -15, 10], [15, -25, 20, 5], [0, -5, 10, 15]],k = 25) == 25\n    assert candidate(matrix = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]],k = 10) == 9\n    assert candidate(matrix = [[3, 2, 1, 4], [1, -1, 2, 3], [2, 1, 1, 2], [4, 2, -1, 3]],k = 5) == 5\n    assert candidate(matrix = [[-2, -3, -4, 0], [-5, -3, -2, -1], [0, -1, 2, 3], [4, 2, -1, 3]],k = -1) == -1\n    assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15]],k = 40) == 40\n    assert candidate(matrix = [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10, 11, 12, 13, 14], [15, 16, 17, 18, 19]],k = 50) == 50\n    assert candidate(matrix = [[-1, -2, -3, -4, -5], [-6, -7, -8, -9, -10], [-11, -12, -13, -14, -15], [-16, -17, -18, -19, -20], [-21, -22, -23, -24, -25]],k = -10) == -10\n    assert candidate(matrix = [[5, -4, -3, 4, -2], [2, -3, 4, 5, -1], [-3, 5, 1, 5, -4], [0, 0, 0, 0, 0]],k = 10) == 10\n    assert candidate(matrix = [[1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1]],k = 5) == 5\n    assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15], [16, 17, 18, 19, 20], [21, 22, 23, 24, 25]],k = 200) == 198\n    assert candidate(matrix = [[-10, -20, -30, -40, -50], [-50, -40, -30, -20, -10], [0, 10, 20, 30, 40], [50, 40, 30, 20, 10], [60, 50, 40, 30, 20]],k = -25) == -30\n    assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12]],k = 30) == 30\n    assert candidate(matrix = [[-1, -2, -3], [-3, -4, -5], [-5, -6, -7], [-7, -8, -9], [-9, -10, -11]],k = -20) == -20\n    assert candidate(matrix = [[5, 10, 15, -5, 20], [10, -20, 25, 30, -15], [5, 15, -25, 10, 0], [0, 5, 10, -15, 20]],k = 40) == 40\n    assert candidate(matrix = [[1, -2, 3, -4, 5], [2, -3, 4, -5, 6], [3, -4, 5, -6, 7], [4, -5, 6, -7, 8]],k = 5) == 5\n    assert candidate(matrix = [[-5, 4, -10, 5], [-2, -3, 8, -4], [3, 5, -9, 1], [7, -6, 4, 2]],k = -1) == -1\n    assert candidate(matrix = [[-5, 3, 4, 1, -2], [-1, 2, -3, 4, 5], [2, -1, -1, 1, -1], [3, -3, 2, -2, 1]],k = 5) == 5\n    assert candidate(matrix = [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]],k = 0) == 0\n    assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -4, 5], [1, 2, -1, 3, -2]],k = 3) == 3\n    assert candidate(matrix = [[-1, 3, 2, 4, -5, -3], [2, 1, 2, 3, -1, 2], [4, 0, -1, 2, -1, 3], [-2, -2, 3, -3, -2, 2], [3, 3, 0, -2, -3, 1], [3, 0, -2, 3, 1, 3]],k = 5) == 5\n    assert candidate(matrix = [[9, 7, -6, -4, 8], [-2, -5, 7, 2, -3], [3, 10, -4, 1, -2], [7, -6, 5, 4, 3]],k = 15) == 15\n    assert candidate(matrix = [[-5, 3, 6, 2, -2], [-1, 2, -4, -4, 1], [2, -3, -3, -1, 5], [3, 1, 1, 2, -1], [3, 2, -1, 0, -4]],k = 3) == 3\n    assert candidate(matrix = [[-1, -2, -3, -4, -5], [-5, -4, -3, -2, -1], [1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [-2, -3, -4, -5, -6]],k = -10) == -10\n    assert candidate(matrix = [[-1, -2, -3, -4, -5], [-6, -7, -8, -9, -10], [-11, -12, -13, -14, -15], [-16, -17, -18, -19, -20], [-21, -22, -23, -24, -25]],k = -50) == -50\n    assert candidate(matrix = [[100, -100, 100], [-100, 100, -100], [100, -100, 100]],k = 150) == 100\n    assert candidate(matrix = [[100, -100, 100, -100, 100], [-100, 100, -100, 100, -100], [100, -100, 100, -100, 100], [-100, 100, -100, 100, -100], [100, -100, 100, -100, 100]],k = 0) == 0\n    assert candidate(matrix = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]],k = 5) == 5\n    assert candidate(matrix = [[1, -1, 1, -1, 1, -1], [-1, 1, -1, 1, -1, 1], [1, -1, 1, -1, 1, -1], [-1, 1, -1, 1, -1, 1], [1, -1, 1, -1, 1, -1], [-1, 1, -1, 1, -1, 1]],k = 1) == 1\n    assert candidate(matrix = [[-5, -4, -3, -2, -1], [-4, -3, -2, -1, 0], [-3, -2, -1, 0, 1], [-2, -1, 0, 1, 2], [-1, 0, 1, 2, 3]],k = -1) == -1\n    assert candidate(matrix = [[-1, 2, -3, 4, -5], [5, -4, 3, -2, 1], [-1, 2, -3, 4, -5], [5, -4, 3, -2, 1], [-1, 2, -3, 4, -5]],k = 0) == 0\n    assert candidate(matrix = [[1, -1, 2, -2, 3, -3], [4, -4, 5, -5, 6, -6], [7, -7, 8, -8, 9, -9]],k = 15) == 15\n    assert candidate(matrix = [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10], [10, 9, 8, 7, 6, 5, 4, 3, 2, 1], [1, 3, 5, 7, 9, 11, 13, 15, 17, 19], [20, 19, 18, 17, 16, 15, 14, 13, 12, 11]],k = 50) == 50\n    assert candidate(matrix = [[-1, 2, -3, 4, 5, -6], [7, 8, -9, 10, 11, -12], [13, 14, -15, 16, 17, -18]],k = 15) == 15\n    assert candidate(matrix = [[1, -1, 1, -1, 1], [-1, 1, -1, 1, -1], [1, -1, 1, -1, 1], [-1, 1, -1, 1, -1], [1, -1, 1, -1, 1]],k = 2) == 1\n    assert candidate(matrix = [[100, -100, 100], [-100, 100, -100], [100, -100, 100]],k = 0) == 0\n    assert candidate(matrix = [[1, 2, 3, 4, 5, 6], [7, 8, 9, 10, 11, 12], [13, 14, 15, 16, 17, 18], [19, 20, 21, 22, 23, 24], [25, 26, 27, 28, 29, 30], [31, 32, 33, 34, 35, 36]],k = 150) == 150\n    assert candidate(matrix = [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]],k = 0) == 0\n    assert candidate(matrix = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]],k = 0) == 0\n    assert candidate(matrix = [[100, -100, 100], [-100, 100, -100], [100, -100, 100], [100, -100, 100]],k = 50) == 0\n    assert candidate(matrix = [[1, -1, 1, -1, 1, -1], [1, -1, 1, -1, 1, -1], [1, -1, 1, -1, 1, -1], [1, -1, 1, -1, 1, -1], [1, -1, 1, -1, 1, -1]],k = 0) == 0\n    assert candidate(matrix = [[100, -100, 100], [-100, 100, -100], [100, -100, 100]],k = 200) == 100\n    assert candidate(matrix = [[-1, -2, -3, -4, -5], [-2, -3, -4, -5, -6], [-3, -4, -5, -6, -7], [-4, -5, -6, -7, -8], [-5, -6, -7, -8, -9]],k = -15) == -15\n    assert candidate(matrix = [[-10, 0, 10, -20, 0, 20], [-100, 0, 100, -200, 0, 200], [-1000, 0, 1000, -2000, 0, 2000], [-10000, 0, 10000, -20000, 0, 20000]],k = 5000) == 2220\n    assert candidate(matrix = [[1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1]],k = 15) == 15\n    assert candidate(matrix = [[50, -50, 50, -50, 50], [-50, 50, -50, 50, -50], [50, -50, 50, -50, 50], [-50, 50, -50, 50, -50], [50, -50, 50, -50, 50]],k = 50) == 50\n    assert candidate(matrix = [[-1, 0, 0, 0, -1], [-1, 1, 1, 1, -1], [-1, 1, 0, 1, -1], [-1, 0, 1, 0, -1]],k = 2) == 2\n    assert candidate(matrix = [[-2, 3, 5, -1], [1, -3, 2, 4], [3, 2, -4, 1], [-1, 5, 2, -6]],k = 5) == 5\n    assert candidate(matrix = [[-1, -1, 2, -2, 3, -3], [1, -2, -1, -3, 4, -4], [2, 3, 1, -1, 2, -2], [-1, 2, 0, -3, 3, 2], [3, 3, 3, 3, 3, 3], [0, 0, 0, 0, 0, 0]],k = 10) == 10\n    assert candidate(matrix = [[1, 2, 3, 4, 5, 6], [2, 3, 4, 5, 6, 7], [3, 4, 5, 6, 7, 8]],k = 30) == 30\n    assert candidate(matrix = [[-1, -2, -3, -4], [-2, -3, -4, -5], [-3, -4, -5, -6]],k = -5) == -5\n    assert candidate(matrix = [[-5, -4, -3, -2, -1], [0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10, 11, 12, 13, 14], [15, 16, 17, 18, 19]],k = 20) == 20\n    assert candidate(matrix = [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10], [11, 12, 13, 14, 15, 16, 17, 18, 19, 20], [21, 22, 23, 24, 25, 26, 27, 28, 29, 30]],k = 150) == 150\n    assert candidate(matrix = [[1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1]],k = 18) == 18\n    assert candidate(matrix = [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]],k = 1) == 1\n    assert candidate(matrix = [[-5, 10, -20, 15, 25], [-1, 2, 3, -4, 5], [20, -25, 30, -35, 40], [-10, 15, 20, -25, 30]],k = 10) == 10\n    assert candidate(matrix = [[-1, 0, 1, -1, 0, 1], [-1, 0, 1, -1, 0, 1], [-1, 0, 1, -1, 0, 1]],k = 0) == 0\n    assert candidate(matrix = [[100, -100, 200, -200, 300], [10, -10, 20, -20, 30], [1, -1, 2, -2, 3], [100, -100, 200, -200, 300], [10, -10, 20, -20, 30]],k = 250) == 242\n    assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15], [16, 17, 18, 19, 20], [21, 22, 23, 24, 25]],k = 100) == 99\n    assert candidate(matrix = [[-5, 0, 4, -1, 1], [-3, -3, 3, 0, -2], [1, -2, 4, 1, -1], [-1, 0, -1, 0, 0], [1, 1, 1, -1, 1]],k = 3) == 3\n    assert candidate(matrix = [[-10, -20, -30], [-40, -50, -60], [-70, -80, -90]],k = -150) == -150\n    assert candidate(matrix = [[1, 2, 3, 4], [2, 3, 4, 5], [3, 4, 5, 6], [4, 5, 6, 7]],k = 15) == 15\n    assert candidate(matrix = [[1, -1, 2, -2], [-1, 1, -2, 2], [2, -2, 1, -1], [-2, 2, -1, 1]],k = 3) == 2\n    assert candidate(matrix = [[1, 0, -1, 0, 1], [0, 1, 0, -1, 0], [-1, 0, 1, 0, -1], [0, -1, 0, 1, 0], [1, 0, -1, 0, 1]],k = 2) == 2\n    assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -2, 3], [1, 0, 1, 0, 1]],k = 2) == 2\n    assert candidate(matrix = [[-5, -4, -3, -2, -1], [0, 1, 2, 3, 4], [5, 6, 7, 8, 9]],k = 15) == 15\n    assert candidate(matrix = [[5, 6, 7, 8], [4, 3, 2, 1], [9, 10, 11, 12]],k = 30) == 30\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, -1, 2]],k = 2) == 2\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, -1]],k = 4) == 4\n    assert candidate(matrix = [[5, 9, 7, 4, 6], [9, 7, 4, 6, 5], [4, 6, 5, 9, 7], [6, 5, 9, 7, 4]],k = 20) == 20\n    assert candidate(matrix = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]],k = 15) == 15\n    assert candidate(matrix = [[1, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]],k = 0) == 0\n    assert candidate(matrix = [[-100, -100, -100], [-100, -100, -100], [-100, -100, -100]],k = -300) == -300\n    assert candidate(matrix = [[-5, 6, -7, 8], [4, -3, 2, -1], [9, -10, 11, -12]],k = 5) == 5\n    assert candidate(matrix = [[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]],k = -5) == -5\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, 1], [-1, -1, -1]],k = 2) == 2\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, 1]],k = 5) == 5\n    assert candidate(matrix = [[1, 1, 1], [1, 1, 1], [1, 1, 1]],k = 5) == 4\n    assert candidate(matrix = [[10, 10, 10], [10, 10, 10], [10, 10, 10]],k = 30) == 30\n    assert candidate(matrix = [[2, 2, 2, 2, 2], [2, 2, 2, 2, 2], [2, 2, 2, 2, 2], [2, 2, 2, 2, 2], [2, 2, 2, 2, 2]],k = 10) == 10\n    assert candidate(matrix = [[100, 100, 100], [100, 100, 100], [100, 100, 100]],k = 299) == 200\n    assert candidate(matrix = [[-2, -3, -4, -5], [-6, -7, -8, -9], [-10, -11, -12, -13]],k = -15) == -15\n    assert candidate(matrix = [[1]],k = 0) == -inf\n    assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]],k = 15) == 15\n    assert candidate(matrix = [[1, 2, 3, 4, 5], [2, 3, 4, 5, 6], [3, 4, 5, 6, 7], [4, 5, 6, 7, 8], [5, 6, 7, 8, 9]],k = 25) == 25\n    assert candidate(matrix = [[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]],k = -1) == -1\n    assert candidate(matrix = [[-1, 3, 2, -4, 1, 2], [3, 2, -1, 4, -3, -2], [2, 1, -3, 4, 1, -3]],k = 10) == 10\n    assert candidate(matrix = [[1, 0, 1, 0, 1], [0, 1, 0, 1, 0], [1, 0, 1, 0, 1], [0, 1, 0, 1, 0]],k = 3) == 3\n    assert candidate(matrix = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]],k = 20) == 20\n    assert candidate(matrix = [[0, 0, 0], [0, 0, 0], [0, 0, 0]],k = 0) == 0\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, -1, 1]],k = 1) == 1\n    assert candidate(matrix = [[-5, -4, -3], [-4, -3, -2], [-3, -2, -1]],k = -8) == -8\n    assert candidate(matrix = [[100, -100], [100, -100]],k = 0) == 0\n    assert candidate(matrix = [[10, 20, 30], [40, 50, 60], [70, 80, 90]],k = 150) == 150\n    assert candidate(matrix = [[-1, -1, -1], [-1, -1, -1], [-1, -1, -1]],k = -2) == -2\n    assert candidate(matrix = [[10, 11, 12], [9, 10, 11], [8, 9, 10]],k = 29) == 27\n    assert candidate(matrix = [[-1, 0, 1], [-2, -1, 2], [-3, -2, 3]],k = -1) == -1\n    assert candidate(matrix = [[-5, -4, -3], [-2, -1, 0], [1, 2, 3]],k = -5) == -5\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [4, 5, 6]],k = 10) == 10\n    assert candidate(matrix = [[-5, -4, -3, -4], [-3, -4, 4, 5], [5, 1, 5, -4]],k = -10) == -10\n    assert candidate(matrix = [[10, 10, 10], [10, -10, 10], [10, 10, -10]],k = 30) == 30\n    assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15]],k = 30) == 30\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [0, 3, -1]],k = 4) == 4\n    assert candidate(matrix = [[-1, 1], [-2, 2], [-3, 3]],k = 1) == 1\n    assert candidate(matrix = [[3, 3, 3], [3, 3, 3], [3, 3, 3]],k = 27) == 27\n    assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -2, 3], [3, 2, 1, 2, 1]],k = 4) == 4\n    assert candidate(matrix = [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [1, 3, 5, 7, 9], [9, 7, 5, 3, 1]],k = 15) == 15\n    assert candidate(matrix = [[-1, -1, -1], [-1, -1, -1], [-1, -1, -1]],k = -1) == -1\n    assert candidate(matrix = [[1]],k = 1) == 1\n    assert candidate(matrix = [[5, 12, 11, 18, 22], [2, 4, 3, 10, 19], [1, 3, 8, 12, 22], [9, 18, 10, 24, 25], [10, 14, 10, 12, 25]],k = 50) == 50\n    assert candidate(matrix = [[1, 2], [3, 4], [5, 6]],k = 15) == 12\n    assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]],k = 10) == 9\n    assert candidate(matrix = [[3, 2, 1, 4, 7], [2, 1, 3, 2, 5], [1, 4, 2, 2, 3]],k = 13) == 13\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [4, 5, 6], [-3, -4, 4, 5]],k = 3) == 3\n    assert candidate(matrix = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]],k = 25) == 24\n    assert candidate(matrix = [[5, 6, 3, 4, 8], [4, 3, 1, 4, 6], [5, 8, 7, 3, 4], [3, 8, 8, 8, 5], [5, 7, 2, 4, 7]],k = 20) == 20\n    assert candidate(matrix = [[-5, -4, -3, -2, -1], [0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [-9, -8, -7, -6, -5], [-4, -3, -2, -1, 0]],k = 10) == 10\n    assert candidate(matrix = [[1, 0], [0, 1]],k = 2) == 2\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [4, 1, 0]],k = 5) == 5\n    assert candidate(matrix = [[1, 0, 1, 0], [0, -2, 3, 1], [3, 2, -1, 0]],k = 3) == 3\n    assert candidate(matrix = [[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]],k = -10) == -11\n    assert candidate(matrix = [[5, 10, 15], [20, 25, 30]],k = 45) == 45\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, 1]],k = 4) == 4\n    assert candidate(matrix = [[-1, -1, -1, -1], [-1, -1, -1, -1], [-1, -1, -1, -1], [-1, -1, -1, -1]],k = -4) == -4\n    assert candidate(matrix = [[5, 10, 15], [20, 25, 30], [35, 40, 45]],k = 100) == 90\n    assert candidate(matrix = [[5, 12, -100, 4, -5], [-3, 1, 4, -3, -4], [2, 3, 4, -3, 4], [1, -2, 3, -2, 1]],k = 7) == 7\n    assert candidate(matrix = [[5, 2, 3], [1, 6, 7], [4, 8, 9]],k = 20) == 19\n    assert candidate(matrix = [[1, 2], [3, 4], [5, 6], [7, 8]],k = 16) == 16\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, -1]],k = 5) == 5\n    assert candidate(matrix = [[1, 2, 3, 4, 5], [2, 3, 4, 5, 6], [3, 4, 5, 6, 7], [4, 5, 6, 7, 8]],k = 20) == 20\n    assert candidate(matrix = [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]],k = 1) == 1\n    assert candidate(matrix = [[-5, -4, -3, -2, -1], [5, 4, 3, 2, 1], [0, 0, 0, 0, 0], [1, 2, 3, 4, 5], [-1, -2, -3, -4, -5]],k = 2) == 2\n    assert candidate(matrix = [[-1, -1], [-1, -1]],k = -2) == -2\n    assert candidate(matrix = [[2, 2], [2, 2], [2, 2]],k = 6) == 6\n    assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -2, 3], [-3, -4, 4, 5, -4], [5, 1, 5, -4, 1]],k = 5) == 5\n    assert candidate(matrix = [[100, 100, 100], [100, 100, 100], [100, 100, 100]],k = 100) == 100\n    assert candidate(matrix = [[3, 3, 3, 10000], [-10000, -10000, -10000, -3], [3, 3, 3, 10000]],k = 9) == 9\n    assert candidate(matrix = [[1, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 1]],k = 1) == 1\n    assert candidate(matrix = [[1, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 1]],k = 1) == 1\n    assert candidate(matrix = [[1, 0, 1, 0, 1], [0, 1, 0, 1, 0], [1, 0, 1, 0, 1], [0, 1, 0, 1, 0], [1, 0, 1, 0, 1]],k = 2) == 2\n    assert candidate(matrix = [[5, 5, 5], [5, 5, 5], [5, 5, 5]],k = 15) == 15\n    assert candidate(matrix = [[1, 1, 1, 1, 1], [1, 1, 0, 0, 0], [1, 0, 0, 0, 0], [1, 0, 0, 0, 0], [1, 0, 0, 0, 0]],k = 3) == 3\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, 0, 1]],k = 4) == 4\n    assert candidate(matrix = [[0, 0], [0, 0]],k = 0) == 0\n    assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15]],k = 15) == 15\n    assert candidate(matrix = [[2, 2, 2, 2], [2, 2, 2, 2], [2, 2, 2, 2]],k = 7) == 6\n    assert candidate(matrix = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]],k = 8) == 8\n    assert candidate(matrix = [[100, 100], [100, 100]],k = 200) == 200\n    assert candidate(matrix = [[-1, -1], [-2, -2]],k = -2) == -2\n    assert candidate(matrix = [[-1, -1], [-1, -1]],k = -3) == -4\n    assert candidate(matrix = [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11]],k = 25) == 24\n    assert candidate(matrix = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1]],k = 3) == 3\n    assert candidate(matrix = [[1, 2], [3, 4], [5, 6], [7, 8]],k = 10) == 10\n    assert candidate(matrix = [[1, 0, 1, 0], [0, 1, 0, 1], [1, 0, 1, 0], [0, 1, 0, 1]],k = 2) == 2\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, 2, -1]],k = 4) == 4\n    assert candidate(matrix = [[1, 2, 3], [4, 5, 6]],k = 15) == 15\n    assert candidate(matrix = [[1, 1], [1, 1]],k = 3) == 2\n    assert candidate(matrix = [[1, 10, 100, 1000]],k = 1500) == 1111\n    assert candidate(matrix = [[5, 6, 7], [8, 9, 10], [11, 12, 13]],k = 30) == 30\n    assert candidate(matrix = [[-1, -1], [-1, -1], [-1, -1], [-1, -1], [-1, -1]],k = -2) == -2\n    assert candidate(matrix = [[5, 10, 15], [20, 25, 30]],k = 50) == 45\n    assert candidate(matrix = [[-2, -1, -3], [-3, -1, -2], [-1, -3, -2]],k = -4) == -4\n    assert candidate(matrix = [[-1, 7, 8], [-9, 4, 5]],k = 14) == 14\n    assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -2, 1], [1, 1, 1, 1, 1]],k = 3) == 3\n    assert candidate(matrix = [[-1, -1, -1], [-1, -1, -1], [-1, -1, -1]],k = -5) == -6\n    assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [-1, -1, -1]],k = -1) == -1\n    assert candidate(matrix = [[5, 6, 7, 8], [1, 2, 3, 4], [9, 10, 11, 12], [13, 14, 15, 16]],k = 20) == 19\n    assert candidate(matrix = [[1, 2], [3, 4]],k = 10) == 10\n    assert candidate(matrix = [[-1, 2], [-3, 4]],k = 1) == 1\n    assert candidate(matrix = [[5, 3, 1, 4, 2], [8, 6, 9, 7, 5], [3, 2, 8, 6, 4], [1, 4, 5, 2, 3], [7, 5, 4, 8, 6]],k = 25) == 25\n    assert candidate(matrix = [[1, 2], [3, 4]],k = 6) == 6\n    assert candidate(matrix = [[10, 10, 10], [10, 10, 10], [10, 10, 10]],k = 50) == 40\n    assert candidate(matrix = [[-1, 0, -1], [0, 2, -3], [3, -2, 1], [1, -1, 1]],k = 1) == 1\n    assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]],k = 30) == 28\n    assert candidate(matrix = [[-100, -100, -100], [-100, -100, -100], [-100, -100, -100]],k = -100) == -100\n",
  "test_cases": [
    "assert candidate(matrix = [[1, 0, 1], [0, 1, 0], [1, 0, 1]],k = 2) == 2",
    "assert candidate(matrix = [[5, 12, 4], [3, 9, 1], [11, 1, 3]],k = 17) == 17",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3]],k = 2) == 2",
    "assert candidate(matrix = [[1, 1, 1], [1, 1, 1], [1, 1, 1]],k = 2) == 2",
    "assert candidate(matrix = [[-1, -1, -1], [-1, -1, -1], [-1, -1, -1]],k = -3) == -3",
    "assert candidate(matrix = [[5, 6, 7], [8, 9, 10]],k = 24) == 19",
    "assert candidate(matrix = [[5, -4, -3, 4], [-3, -4, 4, 5], [5, 1, 5, -4]],k = 10) == 10",
    "assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]],k = 20) == 18",
    "assert candidate(matrix = [[-10, -20, -30], [-40, -50, -60], [-70, -80, -90]],k = -200) == -210",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, 2, 1]],k = 4) == 4",
    "assert candidate(matrix = [[2, 2, -1]],k = 3) == 3",
    "assert candidate(matrix = [[-1, 0, 1, 0, -1], [0, 1, 0, -1, 0], [1, 0, -1, 0, 1]],k = 0) == 0",
    "assert candidate(matrix = [[10, 20, 30], [40, 50, 60], [70, 80, 90]],k = 200) == 180",
    "assert candidate(matrix = [[-1, -1, -1], [-1, -2, -3], [-3, -3, -4]],k = -5) == -5",
    "assert candidate(matrix = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1]],k = 15) == 15",
    "assert candidate(matrix = [[10, 20, 30], [-10, -20, -30], [15, 25, 35]],k = 25) == 25",
    "assert candidate(matrix = [[5, 5, -5, 0, -5], [5, 5, 0, 0, -5], [5, 5, -5, -5, 0], [0, -5, 0, 0, 5], [0, -5, 5, 5, 5]],k = 15) == 15",
    "assert candidate(matrix = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1]],k = 10) == 10",
    "assert candidate(matrix = [[-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1], [-1, 1, -1, 1, -1, 1, -1, 1, -1, 1]],k = 0) == 0",
    "assert candidate(matrix = [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [6, 7, 8, 9, 10], [10, 9, 8, 7, 6], [11, 12, 13, 14, 15]],k = 30) == 30",
    "assert candidate(matrix = [[-1, -2, -3, -4, -5], [-6, -7, -8, -9, -10], [-11, -12, -13, -14, -15], [-16, -17, -18, -19, -20], [-21, -22, -23, -24, -25]],k = -100) == -102",
    "assert candidate(matrix = [[-5, 2, 3, -1, 4], [1, -6, 7, 8, -2], [0, 9, -3, 4, 5], [-1, -2, 3, 4, -6]],k = 5) == 5",
    "assert candidate(matrix = [[-10, -20, -30, -40, -50], [-40, -50, -60, -70, -80], [-30, -40, -50, -60, -70], [-20, -30, -40, -50, -60], [-10, -20, -30, -40, -50]],k = -100) == -100",
    "assert candidate(matrix = [[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],k = 0) == 0",
    "assert candidate(matrix = [[100, -200, 300, -400, 500], [-500, 400, -300, 200, -100], [100, 200, 300, 400, 500], [0, -1, -2, -3, -4]],k = 100) == 100",
    "assert candidate(matrix = [[-100, 100, -100, 100], [-100, 100, -100, 100], [-100, 100, -100, 100], [-100, 100, -100, 100]],k = -100) == -100",
    "assert candidate(matrix = [[100, -100, 100, -100], [100, -100, 100, -100], [100, -100, 100, -100], [100, -100, 100, -100]],k = 99) == 0",
    "assert candidate(matrix = [[1, 2, 3, 4, 5, 6], [2, 3, 4, 5, 6, 1], [3, 4, 5, 6, 1, 2], [4, 5, 6, 1, 2, 3], [5, 6, 1, 2, 3, 4], [6, 1, 2, 3, 4, 5]],k = 20) == 20",
    "assert candidate(matrix = [[-10, -10, -10], [-10, -10, -10], [-10, -10, -10]],k = -29) == -30",
    "assert candidate(matrix = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]],k = 0) == 0",
    "assert candidate(matrix = [[100, -100, 100, -100], [100, -100, 100, -100], [-100, 100, -100, 100], [-100, 100, -100, 100]],k = 0) == 0",
    "assert candidate(matrix = [[-10, 10, 20, 30], [-20, 5, -15, 10], [15, -25, 20, 5], [0, -5, 10, 15]],k = 25) == 25",
    "assert candidate(matrix = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]],k = 10) == 9",
    "assert candidate(matrix = [[3, 2, 1, 4], [1, -1, 2, 3], [2, 1, 1, 2], [4, 2, -1, 3]],k = 5) == 5",
    "assert candidate(matrix = [[-2, -3, -4, 0], [-5, -3, -2, -1], [0, -1, 2, 3], [4, 2, -1, 3]],k = -1) == -1",
    "assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15]],k = 40) == 40",
    "assert candidate(matrix = [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10, 11, 12, 13, 14], [15, 16, 17, 18, 19]],k = 50) == 50",
    "assert candidate(matrix = [[-1, -2, -3, -4, -5], [-6, -7, -8, -9, -10], [-11, -12, -13, -14, -15], [-16, -17, -18, -19, -20], [-21, -22, -23, -24, -25]],k = -10) == -10",
    "assert candidate(matrix = [[5, -4, -3, 4, -2], [2, -3, 4, 5, -1], [-3, 5, 1, 5, -4], [0, 0, 0, 0, 0]],k = 10) == 10",
    "assert candidate(matrix = [[1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1]],k = 5) == 5",
    "assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15], [16, 17, 18, 19, 20], [21, 22, 23, 24, 25]],k = 200) == 198",
    "assert candidate(matrix = [[-10, -20, -30, -40, -50], [-50, -40, -30, -20, -10], [0, 10, 20, 30, 40], [50, 40, 30, 20, 10], [60, 50, 40, 30, 20]],k = -25) == -30",
    "assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12]],k = 30) == 30",
    "assert candidate(matrix = [[-1, -2, -3], [-3, -4, -5], [-5, -6, -7], [-7, -8, -9], [-9, -10, -11]],k = -20) == -20",
    "assert candidate(matrix = [[5, 10, 15, -5, 20], [10, -20, 25, 30, -15], [5, 15, -25, 10, 0], [0, 5, 10, -15, 20]],k = 40) == 40",
    "assert candidate(matrix = [[1, -2, 3, -4, 5], [2, -3, 4, -5, 6], [3, -4, 5, -6, 7], [4, -5, 6, -7, 8]],k = 5) == 5",
    "assert candidate(matrix = [[-5, 4, -10, 5], [-2, -3, 8, -4], [3, 5, -9, 1], [7, -6, 4, 2]],k = -1) == -1",
    "assert candidate(matrix = [[-5, 3, 4, 1, -2], [-1, 2, -3, 4, 5], [2, -1, -1, 1, -1], [3, -3, 2, -2, 1]],k = 5) == 5",
    "assert candidate(matrix = [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]],k = 0) == 0",
    "assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -4, 5], [1, 2, -1, 3, -2]],k = 3) == 3",
    "assert candidate(matrix = [[-1, 3, 2, 4, -5, -3], [2, 1, 2, 3, -1, 2], [4, 0, -1, 2, -1, 3], [-2, -2, 3, -3, -2, 2], [3, 3, 0, -2, -3, 1], [3, 0, -2, 3, 1, 3]],k = 5) == 5",
    "assert candidate(matrix = [[9, 7, -6, -4, 8], [-2, -5, 7, 2, -3], [3, 10, -4, 1, -2], [7, -6, 5, 4, 3]],k = 15) == 15",
    "assert candidate(matrix = [[-5, 3, 6, 2, -2], [-1, 2, -4, -4, 1], [2, -3, -3, -1, 5], [3, 1, 1, 2, -1], [3, 2, -1, 0, -4]],k = 3) == 3",
    "assert candidate(matrix = [[-1, -2, -3, -4, -5], [-5, -4, -3, -2, -1], [1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [-2, -3, -4, -5, -6]],k = -10) == -10",
    "assert candidate(matrix = [[-1, -2, -3, -4, -5], [-6, -7, -8, -9, -10], [-11, -12, -13, -14, -15], [-16, -17, -18, -19, -20], [-21, -22, -23, -24, -25]],k = -50) == -50",
    "assert candidate(matrix = [[100, -100, 100], [-100, 100, -100], [100, -100, 100]],k = 150) == 100",
    "assert candidate(matrix = [[100, -100, 100, -100, 100], [-100, 100, -100, 100, -100], [100, -100, 100, -100, 100], [-100, 100, -100, 100, -100], [100, -100, 100, -100, 100]],k = 0) == 0",
    "assert candidate(matrix = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]],k = 5) == 5",
    "assert candidate(matrix = [[1, -1, 1, -1, 1, -1], [-1, 1, -1, 1, -1, 1], [1, -1, 1, -1, 1, -1], [-1, 1, -1, 1, -1, 1], [1, -1, 1, -1, 1, -1], [-1, 1, -1, 1, -1, 1]],k = 1) == 1",
    "assert candidate(matrix = [[-5, -4, -3, -2, -1], [-4, -3, -2, -1, 0], [-3, -2, -1, 0, 1], [-2, -1, 0, 1, 2], [-1, 0, 1, 2, 3]],k = -1) == -1",
    "assert candidate(matrix = [[-1, 2, -3, 4, -5], [5, -4, 3, -2, 1], [-1, 2, -3, 4, -5], [5, -4, 3, -2, 1], [-1, 2, -3, 4, -5]],k = 0) == 0",
    "assert candidate(matrix = [[1, -1, 2, -2, 3, -3], [4, -4, 5, -5, 6, -6], [7, -7, 8, -8, 9, -9]],k = 15) == 15",
    "assert candidate(matrix = [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10], [10, 9, 8, 7, 6, 5, 4, 3, 2, 1], [1, 3, 5, 7, 9, 11, 13, 15, 17, 19], [20, 19, 18, 17, 16, 15, 14, 13, 12, 11]],k = 50) == 50",
    "assert candidate(matrix = [[-1, 2, -3, 4, 5, -6], [7, 8, -9, 10, 11, -12], [13, 14, -15, 16, 17, -18]],k = 15) == 15",
    "assert candidate(matrix = [[1, -1, 1, -1, 1], [-1, 1, -1, 1, -1], [1, -1, 1, -1, 1], [-1, 1, -1, 1, -1], [1, -1, 1, -1, 1]],k = 2) == 1",
    "assert candidate(matrix = [[100, -100, 100], [-100, 100, -100], [100, -100, 100]],k = 0) == 0",
    "assert candidate(matrix = [[1, 2, 3, 4, 5, 6], [7, 8, 9, 10, 11, 12], [13, 14, 15, 16, 17, 18], [19, 20, 21, 22, 23, 24], [25, 26, 27, 28, 29, 30], [31, 32, 33, 34, 35, 36]],k = 150) == 150",
    "assert candidate(matrix = [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]],k = 0) == 0",
    "assert candidate(matrix = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]],k = 0) == 0",
    "assert candidate(matrix = [[100, -100, 100], [-100, 100, -100], [100, -100, 100], [100, -100, 100]],k = 50) == 0",
    "assert candidate(matrix = [[1, -1, 1, -1, 1, -1], [1, -1, 1, -1, 1, -1], [1, -1, 1, -1, 1, -1], [1, -1, 1, -1, 1, -1], [1, -1, 1, -1, 1, -1]],k = 0) == 0",
    "assert candidate(matrix = [[100, -100, 100], [-100, 100, -100], [100, -100, 100]],k = 200) == 100",
    "assert candidate(matrix = [[-1, -2, -3, -4, -5], [-2, -3, -4, -5, -6], [-3, -4, -5, -6, -7], [-4, -5, -6, -7, -8], [-5, -6, -7, -8, -9]],k = -15) == -15",
    "assert candidate(matrix = [[-10, 0, 10, -20, 0, 20], [-100, 0, 100, -200, 0, 200], [-1000, 0, 1000, -2000, 0, 2000], [-10000, 0, 10000, -20000, 0, 20000]],k = 5000) == 2220",
    "assert candidate(matrix = [[1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1]],k = 15) == 15",
    "assert candidate(matrix = [[50, -50, 50, -50, 50], [-50, 50, -50, 50, -50], [50, -50, 50, -50, 50], [-50, 50, -50, 50, -50], [50, -50, 50, -50, 50]],k = 50) == 50",
    "assert candidate(matrix = [[-1, 0, 0, 0, -1], [-1, 1, 1, 1, -1], [-1, 1, 0, 1, -1], [-1, 0, 1, 0, -1]],k = 2) == 2",
    "assert candidate(matrix = [[-2, 3, 5, -1], [1, -3, 2, 4], [3, 2, -4, 1], [-1, 5, 2, -6]],k = 5) == 5",
    "assert candidate(matrix = [[-1, -1, 2, -2, 3, -3], [1, -2, -1, -3, 4, -4], [2, 3, 1, -1, 2, -2], [-1, 2, 0, -3, 3, 2], [3, 3, 3, 3, 3, 3], [0, 0, 0, 0, 0, 0]],k = 10) == 10",
    "assert candidate(matrix = [[1, 2, 3, 4, 5, 6], [2, 3, 4, 5, 6, 7], [3, 4, 5, 6, 7, 8]],k = 30) == 30",
    "assert candidate(matrix = [[-1, -2, -3, -4], [-2, -3, -4, -5], [-3, -4, -5, -6]],k = -5) == -5",
    "assert candidate(matrix = [[-5, -4, -3, -2, -1], [0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10, 11, 12, 13, 14], [15, 16, 17, 18, 19]],k = 20) == 20",
    "assert candidate(matrix = [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10], [11, 12, 13, 14, 15, 16, 17, 18, 19, 20], [21, 22, 23, 24, 25, 26, 27, 28, 29, 30]],k = 150) == 150",
    "assert candidate(matrix = [[1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1]],k = 18) == 18",
    "assert candidate(matrix = [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]],k = 1) == 1",
    "assert candidate(matrix = [[-5, 10, -20, 15, 25], [-1, 2, 3, -4, 5], [20, -25, 30, -35, 40], [-10, 15, 20, -25, 30]],k = 10) == 10",
    "assert candidate(matrix = [[-1, 0, 1, -1, 0, 1], [-1, 0, 1, -1, 0, 1], [-1, 0, 1, -1, 0, 1]],k = 0) == 0",
    "assert candidate(matrix = [[100, -100, 200, -200, 300], [10, -10, 20, -20, 30], [1, -1, 2, -2, 3], [100, -100, 200, -200, 300], [10, -10, 20, -20, 30]],k = 250) == 242",
    "assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15], [16, 17, 18, 19, 20], [21, 22, 23, 24, 25]],k = 100) == 99",
    "assert candidate(matrix = [[-5, 0, 4, -1, 1], [-3, -3, 3, 0, -2], [1, -2, 4, 1, -1], [-1, 0, -1, 0, 0], [1, 1, 1, -1, 1]],k = 3) == 3",
    "assert candidate(matrix = [[-10, -20, -30], [-40, -50, -60], [-70, -80, -90]],k = -150) == -150",
    "assert candidate(matrix = [[1, 2, 3, 4], [2, 3, 4, 5], [3, 4, 5, 6], [4, 5, 6, 7]],k = 15) == 15",
    "assert candidate(matrix = [[1, -1, 2, -2], [-1, 1, -2, 2], [2, -2, 1, -1], [-2, 2, -1, 1]],k = 3) == 2",
    "assert candidate(matrix = [[1, 0, -1, 0, 1], [0, 1, 0, -1, 0], [-1, 0, 1, 0, -1], [0, -1, 0, 1, 0], [1, 0, -1, 0, 1]],k = 2) == 2",
    "assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -2, 3], [1, 0, 1, 0, 1]],k = 2) == 2",
    "assert candidate(matrix = [[-5, -4, -3, -2, -1], [0, 1, 2, 3, 4], [5, 6, 7, 8, 9]],k = 15) == 15",
    "assert candidate(matrix = [[5, 6, 7, 8], [4, 3, 2, 1], [9, 10, 11, 12]],k = 30) == 30",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, -1, 2]],k = 2) == 2",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, -1]],k = 4) == 4",
    "assert candidate(matrix = [[5, 9, 7, 4, 6], [9, 7, 4, 6, 5], [4, 6, 5, 9, 7], [6, 5, 9, 7, 4]],k = 20) == 20",
    "assert candidate(matrix = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]],k = 15) == 15",
    "assert candidate(matrix = [[1, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]],k = 0) == 0",
    "assert candidate(matrix = [[-100, -100, -100], [-100, -100, -100], [-100, -100, -100]],k = -300) == -300",
    "assert candidate(matrix = [[-5, 6, -7, 8], [4, -3, 2, -1], [9, -10, 11, -12]],k = 5) == 5",
    "assert candidate(matrix = [[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]],k = -5) == -5",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, 1], [-1, -1, -1]],k = 2) == 2",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, 1]],k = 5) == 5",
    "assert candidate(matrix = [[1, 1, 1], [1, 1, 1], [1, 1, 1]],k = 5) == 4",
    "assert candidate(matrix = [[10, 10, 10], [10, 10, 10], [10, 10, 10]],k = 30) == 30",
    "assert candidate(matrix = [[2, 2, 2, 2, 2], [2, 2, 2, 2, 2], [2, 2, 2, 2, 2], [2, 2, 2, 2, 2], [2, 2, 2, 2, 2]],k = 10) == 10",
    "assert candidate(matrix = [[100, 100, 100], [100, 100, 100], [100, 100, 100]],k = 299) == 200",
    "assert candidate(matrix = [[-2, -3, -4, -5], [-6, -7, -8, -9], [-10, -11, -12, -13]],k = -15) == -15",
    "assert candidate(matrix = [[1]],k = 0) == -inf",
    "assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]],k = 15) == 15",
    "assert candidate(matrix = [[1, 2, 3, 4, 5], [2, 3, 4, 5, 6], [3, 4, 5, 6, 7], [4, 5, 6, 7, 8], [5, 6, 7, 8, 9]],k = 25) == 25",
    "assert candidate(matrix = [[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]],k = -1) == -1",
    "assert candidate(matrix = [[-1, 3, 2, -4, 1, 2], [3, 2, -1, 4, -3, -2], [2, 1, -3, 4, 1, -3]],k = 10) == 10",
    "assert candidate(matrix = [[1, 0, 1, 0, 1], [0, 1, 0, 1, 0], [1, 0, 1, 0, 1], [0, 1, 0, 1, 0]],k = 3) == 3",
    "assert candidate(matrix = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]],k = 20) == 20",
    "assert candidate(matrix = [[0, 0, 0], [0, 0, 0], [0, 0, 0]],k = 0) == 0",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, -1, 1]],k = 1) == 1",
    "assert candidate(matrix = [[-5, -4, -3], [-4, -3, -2], [-3, -2, -1]],k = -8) == -8",
    "assert candidate(matrix = [[100, -100], [100, -100]],k = 0) == 0",
    "assert candidate(matrix = [[10, 20, 30], [40, 50, 60], [70, 80, 90]],k = 150) == 150",
    "assert candidate(matrix = [[-1, -1, -1], [-1, -1, -1], [-1, -1, -1]],k = -2) == -2",
    "assert candidate(matrix = [[10, 11, 12], [9, 10, 11], [8, 9, 10]],k = 29) == 27",
    "assert candidate(matrix = [[-1, 0, 1], [-2, -1, 2], [-3, -2, 3]],k = -1) == -1",
    "assert candidate(matrix = [[-5, -4, -3], [-2, -1, 0], [1, 2, 3]],k = -5) == -5",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [4, 5, 6]],k = 10) == 10",
    "assert candidate(matrix = [[-5, -4, -3, -4], [-3, -4, 4, 5], [5, 1, 5, -4]],k = -10) == -10",
    "assert candidate(matrix = [[10, 10, 10], [10, -10, 10], [10, 10, -10]],k = 30) == 30",
    "assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15]],k = 30) == 30",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [0, 3, -1]],k = 4) == 4",
    "assert candidate(matrix = [[-1, 1], [-2, 2], [-3, 3]],k = 1) == 1",
    "assert candidate(matrix = [[3, 3, 3], [3, 3, 3], [3, 3, 3]],k = 27) == 27",
    "assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -2, 3], [3, 2, 1, 2, 1]],k = 4) == 4",
    "assert candidate(matrix = [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [1, 3, 5, 7, 9], [9, 7, 5, 3, 1]],k = 15) == 15",
    "assert candidate(matrix = [[-1, -1, -1], [-1, -1, -1], [-1, -1, -1]],k = -1) == -1",
    "assert candidate(matrix = [[1]],k = 1) == 1",
    "assert candidate(matrix = [[5, 12, 11, 18, 22], [2, 4, 3, 10, 19], [1, 3, 8, 12, 22], [9, 18, 10, 24, 25], [10, 14, 10, 12, 25]],k = 50) == 50",
    "assert candidate(matrix = [[1, 2], [3, 4], [5, 6]],k = 15) == 12",
    "assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]],k = 10) == 9",
    "assert candidate(matrix = [[3, 2, 1, 4, 7], [2, 1, 3, 2, 5], [1, 4, 2, 2, 3]],k = 13) == 13",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [4, 5, 6], [-3, -4, 4, 5]],k = 3) == 3",
    "assert candidate(matrix = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]],k = 25) == 24",
    "assert candidate(matrix = [[5, 6, 3, 4, 8], [4, 3, 1, 4, 6], [5, 8, 7, 3, 4], [3, 8, 8, 8, 5], [5, 7, 2, 4, 7]],k = 20) == 20",
    "assert candidate(matrix = [[-5, -4, -3, -2, -1], [0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [-9, -8, -7, -6, -5], [-4, -3, -2, -1, 0]],k = 10) == 10",
    "assert candidate(matrix = [[1, 0], [0, 1]],k = 2) == 2",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [4, 1, 0]],k = 5) == 5",
    "assert candidate(matrix = [[1, 0, 1, 0], [0, -2, 3, 1], [3, 2, -1, 0]],k = 3) == 3",
    "assert candidate(matrix = [[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]],k = -10) == -11",
    "assert candidate(matrix = [[5, 10, 15], [20, 25, 30]],k = 45) == 45",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, 1]],k = 4) == 4",
    "assert candidate(matrix = [[-1, -1, -1, -1], [-1, -1, -1, -1], [-1, -1, -1, -1], [-1, -1, -1, -1]],k = -4) == -4",
    "assert candidate(matrix = [[5, 10, 15], [20, 25, 30], [35, 40, 45]],k = 100) == 90",
    "assert candidate(matrix = [[5, 12, -100, 4, -5], [-3, 1, 4, -3, -4], [2, 3, 4, -3, 4], [1, -2, 3, -2, 1]],k = 7) == 7",
    "assert candidate(matrix = [[5, 2, 3], [1, 6, 7], [4, 8, 9]],k = 20) == 19",
    "assert candidate(matrix = [[1, 2], [3, 4], [5, 6], [7, 8]],k = 16) == 16",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [3, 2, -1]],k = 5) == 5",
    "assert candidate(matrix = [[1, 2, 3, 4, 5], [2, 3, 4, 5, 6], [3, 4, 5, 6, 7], [4, 5, 6, 7, 8]],k = 20) == 20",
    "assert candidate(matrix = [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]],k = 1) == 1",
    "assert candidate(matrix = [[-5, -4, -3, -2, -1], [5, 4, 3, 2, 1], [0, 0, 0, 0, 0], [1, 2, 3, 4, 5], [-1, -2, -3, -4, -5]],k = 2) == 2",
    "assert candidate(matrix = [[-1, -1], [-1, -1]],k = -2) == -2",
    "assert candidate(matrix = [[2, 2], [2, 2], [2, 2]],k = 6) == 6",
    "assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -2, 3], [-3, -4, 4, 5, -4], [5, 1, 5, -4, 1]],k = 5) == 5",
    "assert candidate(matrix = [[100, 100, 100], [100, 100, 100], [100, 100, 100]],k = 100) == 100",
    "assert candidate(matrix = [[3, 3, 3, 10000], [-10000, -10000, -10000, -3], [3, 3, 3, 10000]],k = 9) == 9",
    "assert candidate(matrix = [[1, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 1]],k = 1) == 1",
    "assert candidate(matrix = [[1, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 1]],k = 1) == 1",
    "assert candidate(matrix = [[1, 0, 1, 0, 1], [0, 1, 0, 1, 0], [1, 0, 1, 0, 1], [0, 1, 0, 1, 0], [1, 0, 1, 0, 1]],k = 2) == 2",
    "assert candidate(matrix = [[5, 5, 5], [5, 5, 5], [5, 5, 5]],k = 15) == 15",
    "assert candidate(matrix = [[1, 1, 1, 1, 1], [1, 1, 0, 0, 0], [1, 0, 0, 0, 0], [1, 0, 0, 0, 0], [1, 0, 0, 0, 0]],k = 3) == 3",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, 0, 1]],k = 4) == 4",
    "assert candidate(matrix = [[0, 0], [0, 0]],k = 0) == 0",
    "assert candidate(matrix = [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15]],k = 15) == 15",
    "assert candidate(matrix = [[2, 2, 2, 2], [2, 2, 2, 2], [2, 2, 2, 2]],k = 7) == 6",
    "assert candidate(matrix = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]],k = 8) == 8",
    "assert candidate(matrix = [[100, 100], [100, 100]],k = 200) == 200",
    "assert candidate(matrix = [[-1, -1], [-2, -2]],k = -2) == -2",
    "assert candidate(matrix = [[-1, -1], [-1, -1]],k = -3) == -4",
    "assert candidate(matrix = [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11]],k = 25) == 24",
    "assert candidate(matrix = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1]],k = 3) == 3",
    "assert candidate(matrix = [[1, 2], [3, 4], [5, 6], [7, 8]],k = 10) == 10",
    "assert candidate(matrix = [[1, 0, 1, 0], [0, 1, 0, 1], [1, 0, 1, 0], [0, 1, 0, 1]],k = 2) == 2",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [1, 2, -1]],k = 4) == 4",
    "assert candidate(matrix = [[1, 2, 3], [4, 5, 6]],k = 15) == 15",
    "assert candidate(matrix = [[1, 1], [1, 1]],k = 3) == 2",
    "assert candidate(matrix = [[1, 10, 100, 1000]],k = 1500) == 1111",
    "assert candidate(matrix = [[5, 6, 7], [8, 9, 10], [11, 12, 13]],k = 30) == 30",
    "assert candidate(matrix = [[-1, -1], [-1, -1], [-1, -1], [-1, -1], [-1, -1]],k = -2) == -2",
    "assert candidate(matrix = [[5, 10, 15], [20, 25, 30]],k = 50) == 45",
    "assert candidate(matrix = [[-2, -1, -3], [-3, -1, -2], [-1, -3, -2]],k = -4) == -4",
    "assert candidate(matrix = [[-1, 7, 8], [-9, 4, 5]],k = 14) == 14",
    "assert candidate(matrix = [[1, 0, 1, 0, 1], [0, -2, 3, -2, 1], [1, 1, 1, 1, 1]],k = 3) == 3",
    "assert candidate(matrix = [[-1, -1, -1], [-1, -1, -1], [-1, -1, -1]],k = -5) == -6",
    "assert candidate(matrix = [[1, 0, 1], [0, -2, 3], [-1, -1, -1]],k = -1) == -1",
    "assert candidate(matrix = [[5, 6, 7, 8], [1, 2, 3, 4], [9, 10, 11, 12], [13, 14, 15, 16]],k = 20) == 19",
    "assert candidate(matrix = [[1, 2], [3, 4]],k = 10) == 10",
    "assert candidate(matrix = [[-1, 2], [-3, 4]],k = 1) == 1",
    "assert candidate(matrix = [[5, 3, 1, 4, 2], [8, 6, 9, 7, 5], [3, 2, 8, 6, 4], [1, 4, 5, 2, 3], [7, 5, 4, 8, 6]],k = 25) == 25",
    "assert candidate(matrix = [[1, 2], [3, 4]],k = 6) == 6",
    "assert candidate(matrix = [[10, 10, 10], [10, 10, 10], [10, 10, 10]],k = 50) == 40",
    "assert candidate(matrix = [[-1, 0, -1], [0, 2, -3], [3, -2, 1], [1, -1, 1]],k = 1) == 1",
    "assert candidate(matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]],k = 30) == 28",
    "assert candidate(matrix = [[-100, -100, -100], [-100, -100, -100], [-100, -100, -100]],k = -100) == -100"
  ]
}