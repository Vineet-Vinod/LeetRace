{
  "id": "count-complete-substrings",
  "title": "Count Complete Substrings",
  "difficulty": "Hard",
  "tags": [
    "Hash Table",
    "String",
    "Sliding Window"
  ],
  "description": "You are given a string word and an integer k.\nA substring s of word is complete if:\n\nEach character in s occurs exactly k times.\nThe difference between two adjacent characters is at most 2. That is, for any two adjacent characters c1 and c2 in s, the absolute difference in their positions in the alphabet is at most 2.\n\nReturn the number of complete substrings of word.\nA substring is a non-empty contiguous sequence of characters in a string.\n\u00a0\nExample 1:\n\nInput: word = \"igigee\", k = 2\nOutput: 3\nExplanation: The complete substrings where each character appears exactly twice and the difference between adjacent characters is at most 2 are: igigee, igigee, igigee.\n\nExample 2:\n\nInput: word = \"aaabbbccc\", k = 3\nOutput: 6\nExplanation: The complete substrings where each character appears exactly three times and the difference between adjacent characters is at most 2 are: aaabbbccc, aaabbbccc, aaabbbccc, aaabbbccc, aaabbbccc, aaabbbccc.\n\n\u00a0\nConstraints:\n\n1 <= word.length <= 105\nword consists only of lowercase English letters.\n1 <= k <= word.length\n\n",
  "entry_point": "Solution().countCompleteSubstrings",
  "starter_code": "class Solution:\n    def countCompleteSubstrings(self, word: str, k: int) -> int:\n        ",
  "preamble": "from typing import *\nfrom collections import *\nfrom functools import *\nfrom itertools import *\nfrom heapq import *\nfrom bisect import *\nfrom math import *\nimport math, collections, functools, itertools, bisect, heapq, string, re\n",
  "check_function": "def check(candidate):\n    assert candidate(word = \"xyzyxzyzxzyz\",k = 2) == 2\n    assert candidate(word = \"mississippi\",k = 1) == 11\n    assert candidate(word = \"zzzzzzzzz\",k = 9) == 1\n    assert candidate(word = \"abcdefghijklmnopqrstuvwxyz\",k = 1) == 351\n    assert candidate(word = \"ababababab\",k = 1) == 19\n    assert candidate(word = \"ababab\",k = 2) == 3\n    assert candidate(word = \"ababababab\",k = 2) == 7\n    assert candidate(word = \"abcdabcdabcd\",k = 4) == 0\n    assert candidate(word = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 1) == 77\n    assert candidate(word = \"qrstuvqrstuvqrstuv\",k = 3) == 0\n    assert candidate(word = \"mnopqrspqr\",k = 2) == 0\n    assert candidate(word = \"zzzzzzzzz\",k = 3) == 7\n    assert candidate(word = \"zyxwvutsrqponmlkjihgfedcba\",k = 1) == 351\n    assert candidate(word = \"aabbccddeeffgghhii\",k = 2) == 45\n    assert candidate(word = \"abacabadabacaba\",k = 1) == 31\n    assert candidate(word = \"zzzzzzzzz\",k = 2) == 8\n    assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 5) == 46\n    assert candidate(word = \"mnopqrsmnopqrsmnopqrsmnopqrsmnopqrsmnopqrs\",k = 4) == 0\n    assert candidate(word = \"abcdefg\",k = 1) == 28\n    assert candidate(word = \"abcd\",k = 1) == 10\n    assert candidate(word = \"abcabcabcabcabc\",k = 3) == 7\n    assert candidate(word = \"aaabbbccc\",k = 3) == 6\n    assert candidate(word = \"abcde\",k = 1) == 15\n    assert candidate(word = \"abababababababababababababababababababababababababababababababababa\",k = 2) == 64\n    assert candidate(word = \"xyzxyzxyz\",k = 3) == 1\n    assert candidate(word = \"abcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 1) == 114\n    assert candidate(word = \"zzzzzzyyyxx\",k = 2) == 10\n    assert candidate(word = \"xyzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 31\n    assert candidate(word = \"abcabcabcabc\",k = 4) == 1\n    assert candidate(word = \"a\",k = 1) == 1\n    assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 26) == 25\n    assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 5) == 40\n    assert candidate(word = \"abcabcabcabc\",k = 3) == 4\n    assert candidate(word = \"igigee\",k = 2) == 3\n    assert candidate(word = \"aaaaaa\",k = 6) == 1\n    assert candidate(word = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 3) == 58\n    assert candidate(word = \"abcabcabc\",k = 3) == 1\n    assert candidate(word = \"xxxxxxyyyyyzzzzz\",k = 5) == 7\n    assert candidate(word = \"abcabcabcabcabcabcabc\",k = 3) == 13\n    assert candidate(word = \"aabbaa\",k = 2) == 6\n    assert candidate(word = \"qqqqqqqqqqqqqqqqqqqq\",k = 5) == 16\n    assert candidate(word = \"aaaabbbbcccc\",k = 4) == 6\n    assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 50\n    assert candidate(word = \"acacacacacacacacacacacacacacacacacacacacacacacacacacacacacacacacaca\",k = 2) == 64\n    assert candidate(word = \"ababababababababababababab\",k = 2) == 23\n    assert candidate(word = \"zzzzzz\",k = 2) == 5\n    assert candidate(word = \"zzzzzzzzzz\",k = 5) == 6\n    assert candidate(word = \"zzzyyyxxxwwvvuuttrrqqqppponnmmllkkjjiihhggffeeddccbbbaaa\",k = 3) == 12\n    assert candidate(word = \"aaaabbbbccccddddeeeeffff\",k = 4) == 21\n    assert candidate(word = \"aaaabbbbccccdddd\",k = 4) == 10\n    assert candidate(word = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 3) == 55\n    assert candidate(word = \"abacabadabacaba\",k = 3) == 0\n    assert candidate(word = \"mississippi\",k = 2) == 3\n    assert candidate(word = \"aaa\",k = 1) == 3\n    assert candidate(word = \"aabbbcccaabb\",k = 2) == 12\n    assert candidate(word = \"abcdefghi\",k = 1) == 45\n    assert candidate(word = \"ababababababababababababababababababababab\",k = 2) == 39\n    assert candidate(word = \"zzzyyyxxxwwwwvvvuuutttsssrrrqqqpppoonnmmmlllkkkjjjiii\",k = 3) == 61\n    assert candidate(word = \"aabbcc\",k = 2) == 6\n    assert candidate(word = \"abcdefghijklmnopqrstuvwxyzzzz\",k = 1) == 354\n    assert candidate(word = \"xyzyxzyzxzyx\",k = 2) == 3\n    assert candidate(word = \"zzzzz\",k = 5) == 1\n    assert candidate(word = \"abacaba\",k = 1) == 15\n    assert candidate(word = \"aabbaabbaabbaabb\",k = 2) == 21\n    assert candidate(word = \"abacabadabacaba\",k = 2) == 0\n    assert candidate(word = \"abcdabcdeabcdabcde\",k = 2) == 0\n    assert candidate(word = \"abcabcabc\",k = 1) == 24\n    assert candidate(word = \"zzzzz\",k = 1) == 5\n    assert candidate(word = \"mnopqr\",k = 1) == 21\n    assert candidate(word = \"xyxxyxyxyx\",k = 2) == 6\n    assert candidate(word = \"mnopqrsmnopqrsmnopqrsmnopqrs\",k = 5) == 0\n    assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 5) == 47\n    assert candidate(word = \"qwertyuiopasdfghjklzxcvbnm\",k = 1) == 51\n    assert candidate(word = \"abcdefghij\",k = 1) == 55\n    assert candidate(word = \"zzzaaa\",k = 3) == 2\n    assert candidate(word = \"qqwweerrtt\",k = 2) == 6\n    assert candidate(word = \"abcdefghijk\",k = 1) == 66\n    assert candidate(word = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 2) == 351\n    assert candidate(word = \"abcdabcdabcd\",k = 2) == 0\n    assert candidate(word = \"abcabcabcabcabcabcabcabcabcabc\",k = 3) == 22\n    assert candidate(word = \"abcdefghijklmnopqrstuvwxyzaaa\",k = 1) == 354\n    assert candidate(word = \"aaaabbbbccccaaaabbbbcccc\",k = 4) == 24\n    assert candidate(word = \"zzzzzz\",k = 1) == 6\n    assert candidate(word = \"abcabcabcabcabcabc\",k = 3) == 10\n    assert candidate(word = \"abababababababababab\",k = 2) == 17\n    assert candidate(word = \"abcdef\",k = 1) == 21\n    assert candidate(word = \"aabbccddeeaabbccddeeaabbccddeeddeeaabbcc\",k = 2) == 57\n    assert candidate(word = \"abcdabc\",k = 2) == 0\n    assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 10) == 43\n    assert candidate(word = \"zzzyyyxxx\",k = 3) == 6\n    assert candidate(word = \"xyzzzzzyxxyzzzzzyx\",k = 3) == 6\n",
  "test_cases": [
    "assert candidate(word = \"xyzyxzyzxzyz\",k = 2) == 2",
    "assert candidate(word = \"mississippi\",k = 1) == 11",
    "assert candidate(word = \"zzzzzzzzz\",k = 9) == 1",
    "assert candidate(word = \"abcdefghijklmnopqrstuvwxyz\",k = 1) == 351",
    "assert candidate(word = \"ababababab\",k = 1) == 19",
    "assert candidate(word = \"ababab\",k = 2) == 3",
    "assert candidate(word = \"ababababab\",k = 2) == 7",
    "assert candidate(word = \"abcdabcdabcd\",k = 4) == 0",
    "assert candidate(word = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 1) == 77",
    "assert candidate(word = \"qrstuvqrstuvqrstuv\",k = 3) == 0",
    "assert candidate(word = \"mnopqrspqr\",k = 2) == 0",
    "assert candidate(word = \"zzzzzzzzz\",k = 3) == 7",
    "assert candidate(word = \"zyxwvutsrqponmlkjihgfedcba\",k = 1) == 351",
    "assert candidate(word = \"aabbccddeeffgghhii\",k = 2) == 45",
    "assert candidate(word = \"abacabadabacaba\",k = 1) == 31",
    "assert candidate(word = \"zzzzzzzzz\",k = 2) == 8",
    "assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 5) == 46",
    "assert candidate(word = \"mnopqrsmnopqrsmnopqrsmnopqrsmnopqrsmnopqrs\",k = 4) == 0",
    "assert candidate(word = \"abcdefg\",k = 1) == 28",
    "assert candidate(word = \"abcd\",k = 1) == 10",
    "assert candidate(word = \"abcabcabcabcabc\",k = 3) == 7",
    "assert candidate(word = \"aaabbbccc\",k = 3) == 6",
    "assert candidate(word = \"abcde\",k = 1) == 15",
    "assert candidate(word = \"abababababababababababababababababababababababababababababababababa\",k = 2) == 64",
    "assert candidate(word = \"xyzxyzxyz\",k = 3) == 1",
    "assert candidate(word = \"abcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 1) == 114",
    "assert candidate(word = \"zzzzzzyyyxx\",k = 2) == 10",
    "assert candidate(word = \"xyzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 31",
    "assert candidate(word = \"abcabcabcabc\",k = 4) == 1",
    "assert candidate(word = \"a\",k = 1) == 1",
    "assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 26) == 25",
    "assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 5) == 40",
    "assert candidate(word = \"abcabcabcabc\",k = 3) == 4",
    "assert candidate(word = \"igigee\",k = 2) == 3",
    "assert candidate(word = \"aaaaaa\",k = 6) == 1",
    "assert candidate(word = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 3) == 58",
    "assert candidate(word = \"abcabcabc\",k = 3) == 1",
    "assert candidate(word = \"xxxxxxyyyyyzzzzz\",k = 5) == 7",
    "assert candidate(word = \"abcabcabcabcabcabcabc\",k = 3) == 13",
    "assert candidate(word = \"aabbaa\",k = 2) == 6",
    "assert candidate(word = \"qqqqqqqqqqqqqqqqqqqq\",k = 5) == 16",
    "assert candidate(word = \"aaaabbbbcccc\",k = 4) == 6",
    "assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 1) == 50",
    "assert candidate(word = \"acacacacacacacacacacacacacacacacacacacacacacacacacacacacacacacacaca\",k = 2) == 64",
    "assert candidate(word = \"ababababababababababababab\",k = 2) == 23",
    "assert candidate(word = \"zzzzzz\",k = 2) == 5",
    "assert candidate(word = \"zzzzzzzzzz\",k = 5) == 6",
    "assert candidate(word = \"zzzyyyxxxwwvvuuttrrqqqppponnmmllkkjjiihhggffeeddccbbbaaa\",k = 3) == 12",
    "assert candidate(word = \"aaaabbbbccccddddeeeeffff\",k = 4) == 21",
    "assert candidate(word = \"aaaabbbbccccdddd\",k = 4) == 10",
    "assert candidate(word = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabcabc\",k = 3) == 55",
    "assert candidate(word = \"abacabadabacaba\",k = 3) == 0",
    "assert candidate(word = \"mississippi\",k = 2) == 3",
    "assert candidate(word = \"aaa\",k = 1) == 3",
    "assert candidate(word = \"aabbbcccaabb\",k = 2) == 12",
    "assert candidate(word = \"abcdefghi\",k = 1) == 45",
    "assert candidate(word = \"ababababababababababababababababababababab\",k = 2) == 39",
    "assert candidate(word = \"zzzyyyxxxwwwwvvvuuutttsssrrrqqqpppoonnmmmlllkkkjjjiii\",k = 3) == 61",
    "assert candidate(word = \"aabbcc\",k = 2) == 6",
    "assert candidate(word = \"abcdefghijklmnopqrstuvwxyzzzz\",k = 1) == 354",
    "assert candidate(word = \"xyzyxzyzxzyx\",k = 2) == 3",
    "assert candidate(word = \"zzzzz\",k = 5) == 1",
    "assert candidate(word = \"abacaba\",k = 1) == 15",
    "assert candidate(word = \"aabbaabbaabbaabb\",k = 2) == 21",
    "assert candidate(word = \"abacabadabacaba\",k = 2) == 0",
    "assert candidate(word = \"abcdabcdeabcdabcde\",k = 2) == 0",
    "assert candidate(word = \"abcabcabc\",k = 1) == 24",
    "assert candidate(word = \"zzzzz\",k = 1) == 5",
    "assert candidate(word = \"mnopqr\",k = 1) == 21",
    "assert candidate(word = \"xyxxyxyxyx\",k = 2) == 6",
    "assert candidate(word = \"mnopqrsmnopqrsmnopqrsmnopqrs\",k = 5) == 0",
    "assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 5) == 47",
    "assert candidate(word = \"qwertyuiopasdfghjklzxcvbnm\",k = 1) == 51",
    "assert candidate(word = \"abcdefghij\",k = 1) == 55",
    "assert candidate(word = \"zzzaaa\",k = 3) == 2",
    "assert candidate(word = \"qqwweerrtt\",k = 2) == 6",
    "assert candidate(word = \"abcdefghijk\",k = 1) == 66",
    "assert candidate(word = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\",k = 2) == 351",
    "assert candidate(word = \"abcdabcdabcd\",k = 2) == 0",
    "assert candidate(word = \"abcabcabcabcabcabcabcabcabcabc\",k = 3) == 22",
    "assert candidate(word = \"abcdefghijklmnopqrstuvwxyzaaa\",k = 1) == 354",
    "assert candidate(word = \"aaaabbbbccccaaaabbbbcccc\",k = 4) == 24",
    "assert candidate(word = \"zzzzzz\",k = 1) == 6",
    "assert candidate(word = \"abcabcabcabcabcabc\",k = 3) == 10",
    "assert candidate(word = \"abababababababababab\",k = 2) == 17",
    "assert candidate(word = \"abcdef\",k = 1) == 21",
    "assert candidate(word = \"aabbccddeeaabbccddeeaabbccddeeddeeaabbcc\",k = 2) == 57",
    "assert candidate(word = \"abcdabc\",k = 2) == 0",
    "assert candidate(word = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\",k = 10) == 43",
    "assert candidate(word = \"zzzyyyxxx\",k = 3) == 6",
    "assert candidate(word = \"xyzzzzzyxxyzzzzzyx\",k = 3) == 6"
  ]
}