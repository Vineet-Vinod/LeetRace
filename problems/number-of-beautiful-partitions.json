{
  "id": "number-of-beautiful-partitions",
  "title": "Number Of Beautiful Partitions",
  "difficulty": "Hard",
  "tags": [
    "String",
    "Dynamic Programming"
  ],
  "description": "You are given a string s that consists of the digits '1' to '9' and two integers k and minLength.\nA partition of s is called beautiful if:\n\ns is partitioned into k non-intersecting substrings.\nEach substring has a length of at least minLength.\nEach substring starts with a prime digit and ends with a non-prime digit. Prime digits are '2', '3', '5', and '7', and the rest of the digits are non-prime.\n\nReturn the number of beautiful partitions of s. Since the answer may be very large, return it modulo 109 + 7.\nA substring is a contiguous sequence of characters within a string.\n\u00a0\nExample 1:\n\nInput: s = \"23542185131\", k = 3, minLength = 2\nOutput: 3\nExplanation: There exists three ways to create a beautiful partition:\n\"2354 | 218 | 5131\"\n\"2354 | 21851 | 31\"\n\"2354218 | 51 | 31\"\n\nExample 2:\n\nInput: s = \"23542185131\", k = 3, minLength = 3\nOutput: 1\nExplanation: There exists one way to create a beautiful partition: \"2354 | 218 | 5131\".\n\nExample 3:\n\nInput: s = \"3312958\", k = 3, minLength = 1\nOutput: 1\nExplanation: There exists one way to create a beautiful partition: \"331 | 29 | 58\".\n\n\u00a0\nConstraints:\n\n1 <= k, minLength <= s.length <= 1000\ns consists of the digits '1' to '9'.\n\n",
  "entry_point": "Solution().beautifulPartitions",
  "starter_code": "class Solution:\n    def beautifulPartitions(self, s: str, k: int, minLength: int) -> int:\n        ",
  "preamble": "from typing import *\nfrom collections import *\nfrom functools import *\nfrom itertools import *\nfrom heapq import *\nfrom bisect import *\nfrom math import *\nimport math, collections, functools, itertools, bisect, heapq, string, re\n",
  "check_function": "def check(candidate):\n    assert candidate(s = \"52372938462673572\",k = 4,minLength = 2) == 0\n    assert candidate(s = \"33333\",k = 1,minLength = 1) == 0\n    assert candidate(s = \"23542185131\",k = 3,minLength = 3) == 1\n    assert candidate(s = \"3312958\",k = 3,minLength = 1) == 1\n    assert candidate(s = \"253179\",k = 2,minLength = 1) == 1\n    assert candidate(s = \"72531\",k = 1,minLength = 5) == 1\n    assert candidate(s = \"357291\",k = 2,minLength = 2) == 0\n    assert candidate(s = \"22354\",k = 1,minLength = 1) == 1\n    assert candidate(s = \"23542185131\",k = 3,minLength = 2) == 3\n    assert candidate(s = \"77777\",k = 5,minLength = 1) == 0\n    assert candidate(s = \"75319\",k = 1,minLength = 5) == 1\n    assert candidate(s = \"22222\",k = 5,minLength = 1) == 0\n    assert candidate(s = \"2375193\",k = 2,minLength = 2) == 0\n    assert candidate(s = \"3572935729\",k = 5,minLength = 2) == 0\n    assert candidate(s = \"23751\",k = 2,minLength = 1) == 0\n    assert candidate(s = \"2222222222\",k = 5,minLength = 1) == 0\n    assert candidate(s = \"2233445566778899\",k = 2,minLength = 4) == 2\n    assert candidate(s = \"7223357\",k = 2,minLength = 1) == 0\n    assert candidate(s = \"23759237592375923759\",k = 5,minLength = 4) == 0\n    assert candidate(s = \"35757575757575\",k = 7,minLength = 1) == 0\n    assert candidate(s = \"2354218513197531\",k = 4,minLength = 3) == 2\n    assert candidate(s = \"317317317317317317317317317317\",k = 8,minLength = 2) == 0\n    assert candidate(s = \"353535353535353535353535\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"2357235723572357235723572357\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"23572357235723572357235723572357235723\",k = 10,minLength = 4) == 0\n    assert candidate(s = \"235423542354\",k = 3,minLength = 2) == 1\n    assert candidate(s = \"373737373737373737373737\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"2354218513123542185131\",k = 5,minLength = 2) == 35\n    assert candidate(s = \"75319284628462846284\",k = 4,minLength = 3) == 4\n    assert candidate(s = \"331295833129583312958331295833129583312958\",k = 10,minLength = 3) == 110\n    assert candidate(s = \"77777777777777777777777777777777777777\",k = 5,minLength = 1) == 0\n    assert candidate(s = \"235711317113\",k = 3,minLength = 3) == 0\n    assert candidate(s = \"23542185131\",k = 5,minLength = 1) == 0\n    assert candidate(s = \"2233335555777711112222333355557777\",k = 6,minLength = 2) == 0\n    assert candidate(s = \"2333353333533337333313333\",k = 7,minLength = 2) == 0\n    assert candidate(s = \"23572357235723572357235723572357235723\",k = 15,minLength = 5) == 0\n    assert candidate(s = \"235723572357235723572357235723572357\",k = 15,minLength = 2) == 0\n    assert candidate(s = \"23547186918691869\",k = 4,minLength = 2) == 0\n    assert candidate(s = \"331295897531\",k = 4,minLength = 1) == 1\n    assert candidate(s = \"22222222222222222222\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"7777777777777777777777777777\",k = 8,minLength = 3) == 0\n    assert candidate(s = \"235723572357\",k = 6,minLength = 2) == 0\n    assert candidate(s = \"235235235235235235\",k = 7,minLength = 3) == 0\n    assert candidate(s = \"733733733733733733733733\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"2375913759231\",k = 4,minLength = 2) == 0\n    assert candidate(s = \"222333444555666777888999\",k = 3,minLength = 3) == 1\n    assert candidate(s = \"735235235235235235\",k = 7,minLength = 2) == 0\n    assert candidate(s = \"252525252525252525252525\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"223542185131223542185131223542185131\",k = 9,minLength = 3) == 1\n    assert candidate(s = \"732519753189273189\",k = 4,minLength = 3) == 0\n    assert candidate(s = \"233757537537537537537\",k = 8,minLength = 3) == 0\n    assert candidate(s = \"22222222222222222222222222222222222222\",k = 15,minLength = 1) == 0\n    assert candidate(s = \"222333555777111222333\",k = 7,minLength = 2) == 0\n    assert candidate(s = \"735218513735218513735218513735\",k = 7,minLength = 3) == 0\n    assert candidate(s = \"272727272727\",k = 6,minLength = 1) == 0\n    assert candidate(s = \"23572357235723572357\",k = 5,minLength = 2) == 0\n    assert candidate(s = \"222333555777111\",k = 4,minLength = 3) == 0\n    assert candidate(s = \"37537537537537\",k = 6,minLength = 3) == 0\n    assert candidate(s = \"22335577112233557711\",k = 6,minLength = 2) == 0\n    assert candidate(s = \"2573197319731973197319\",k = 9,minLength = 2) == 0\n    assert candidate(s = \"2354218513171925235729\",k = 6,minLength = 3) == 0\n    assert candidate(s = \"232323232323232323232323\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"222333555777111222333555777111\",k = 4,minLength = 3) == 0\n    assert candidate(s = \"753197531975319753\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"33333333333333333333333333333333333333\",k = 10,minLength = 1) == 0\n    assert candidate(s = \"2323232323232323\",k = 8,minLength = 2) == 0\n    assert candidate(s = \"33333333333333\",k = 5,minLength = 2) == 0\n    assert candidate(s = \"33129583312958331295833129583312958331\",k = 10,minLength = 3) == 15\n    assert candidate(s = \"373737373737\",k = 6,minLength = 1) == 0\n    assert candidate(s = \"2233557711886644\",k = 6,minLength = 1) == 0\n    assert candidate(s = \"235476918235476918235476918\",k = 6,minLength = 3) == 1\n    assert candidate(s = \"333222111777555333222111\",k = 9,minLength = 2) == 0\n    assert candidate(s = \"29292929292929\",k = 3,minLength = 3) == 3\n    assert candidate(s = \"7235719753197532\",k = 5,minLength = 2) == 0\n    assert candidate(s = \"35235235235235235235235235235\",k = 10,minLength = 3) == 0\n    assert candidate(s = \"333555777222444666888999\",k = 5,minLength = 2) == 0\n    assert candidate(s = \"373737373737373737\",k = 5,minLength = 3) == 0\n    assert candidate(s = \"222333555777111222333555777111\",k = 6,minLength = 3) == 0\n    assert candidate(s = \"23572357235723\",k = 1,minLength = 1) == 0\n    assert candidate(s = \"23571113171923293137414347\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"22222222222222\",k = 2,minLength = 5) == 0\n    assert candidate(s = \"23751937519375193\",k = 5,minLength = 2) == 0\n    assert candidate(s = \"235421851312354218513123542185\",k = 6,minLength = 4) == 0\n    assert candidate(s = \"22222222222222222222222222222222222222\",k = 20,minLength = 1) == 0\n    assert candidate(s = \"27272727272727272727272727272\",k = 8,minLength = 2) == 0\n    assert candidate(s = \"2222222222222222222222222222\",k = 12,minLength = 1) == 0\n    assert candidate(s = \"753753753753753753753753753753753753753753\",k = 15,minLength = 5) == 0\n    assert candidate(s = \"235421851312354218513123542185131\",k = 6,minLength = 2) == 462\n    assert candidate(s = \"52373197357537325\",k = 5,minLength = 1) == 0\n    assert candidate(s = \"23232323232323232323232323\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"222333555777222333555777222333555777\",k = 6,minLength = 4) == 0\n    assert candidate(s = \"23542185131973\",k = 4,minLength = 2) == 0\n    assert candidate(s = \"375375375375\",k = 5,minLength = 2) == 0\n    assert candidate(s = \"75319753197531975319753197531975\",k = 8,minLength = 4) == 0\n    assert candidate(s = \"3257113257113257113257\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"223355771199\",k = 6,minLength = 2) == 0\n    assert candidate(s = \"375375375375375375375375375375\",k = 7,minLength = 4) == 0\n    assert candidate(s = \"23572357235723\",k = 2,minLength = 5) == 0\n    assert candidate(s = \"2354218513123542185131\",k = 6,minLength = 2) == 21\n    assert candidate(s = \"23572357235723572357235723572357235723\",k = 15,minLength = 3) == 0\n    assert candidate(s = \"3572535725357\",k = 5,minLength = 1) == 0\n    assert candidate(s = \"2357135713571357\",k = 7,minLength = 2) == 0\n    assert candidate(s = \"22223333555577772222\",k = 4,minLength = 5) == 0\n    assert candidate(s = \"53725372537253725372537253725372\",k = 10,minLength = 3) == 0\n    assert candidate(s = \"257357257357\",k = 4,minLength = 2) == 0\n    assert candidate(s = \"2197531975319753\",k = 8,minLength = 3) == 0\n    assert candidate(s = \"2357235723572357\",k = 1,minLength = 15) == 0\n    assert candidate(s = \"23542185131719\",k = 5,minLength = 2) == 1\n    assert candidate(s = \"57575757575757575757575757575\",k = 6,minLength = 4) == 0\n    assert candidate(s = \"22335577223355772233\",k = 6,minLength = 1) == 0\n    assert candidate(s = \"2357235723572357235723572357\",k = 7,minLength = 5) == 0\n    assert candidate(s = \"37531975319753197537531975319753\",k = 12,minLength = 2) == 0\n    assert candidate(s = \"25252525252525\",k = 5,minLength = 2) == 0\n    assert candidate(s = \"21212121212121\",k = 3,minLength = 2) == 15\n    assert candidate(s = \"2357198462357\",k = 4,minLength = 2) == 0\n    assert candidate(s = \"235723572357235723572357\",k = 10,minLength = 2) == 0\n    assert candidate(s = \"23232323232323232323232323232323\",k = 10,minLength = 2) == 0\n",
  "test_cases": [
    "assert candidate(s = \"52372938462673572\",k = 4,minLength = 2) == 0",
    "assert candidate(s = \"33333\",k = 1,minLength = 1) == 0",
    "assert candidate(s = \"23542185131\",k = 3,minLength = 3) == 1",
    "assert candidate(s = \"3312958\",k = 3,minLength = 1) == 1",
    "assert candidate(s = \"253179\",k = 2,minLength = 1) == 1",
    "assert candidate(s = \"72531\",k = 1,minLength = 5) == 1",
    "assert candidate(s = \"357291\",k = 2,minLength = 2) == 0",
    "assert candidate(s = \"22354\",k = 1,minLength = 1) == 1",
    "assert candidate(s = \"23542185131\",k = 3,minLength = 2) == 3",
    "assert candidate(s = \"77777\",k = 5,minLength = 1) == 0",
    "assert candidate(s = \"75319\",k = 1,minLength = 5) == 1",
    "assert candidate(s = \"22222\",k = 5,minLength = 1) == 0",
    "assert candidate(s = \"2375193\",k = 2,minLength = 2) == 0",
    "assert candidate(s = \"3572935729\",k = 5,minLength = 2) == 0",
    "assert candidate(s = \"23751\",k = 2,minLength = 1) == 0",
    "assert candidate(s = \"2222222222\",k = 5,minLength = 1) == 0",
    "assert candidate(s = \"2233445566778899\",k = 2,minLength = 4) == 2",
    "assert candidate(s = \"7223357\",k = 2,minLength = 1) == 0",
    "assert candidate(s = \"23759237592375923759\",k = 5,minLength = 4) == 0",
    "assert candidate(s = \"35757575757575\",k = 7,minLength = 1) == 0",
    "assert candidate(s = \"2354218513197531\",k = 4,minLength = 3) == 2",
    "assert candidate(s = \"317317317317317317317317317317\",k = 8,minLength = 2) == 0",
    "assert candidate(s = \"353535353535353535353535\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"2357235723572357235723572357\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"23572357235723572357235723572357235723\",k = 10,minLength = 4) == 0",
    "assert candidate(s = \"235423542354\",k = 3,minLength = 2) == 1",
    "assert candidate(s = \"373737373737373737373737\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"2354218513123542185131\",k = 5,minLength = 2) == 35",
    "assert candidate(s = \"75319284628462846284\",k = 4,minLength = 3) == 4",
    "assert candidate(s = \"331295833129583312958331295833129583312958\",k = 10,minLength = 3) == 110",
    "assert candidate(s = \"77777777777777777777777777777777777777\",k = 5,minLength = 1) == 0",
    "assert candidate(s = \"235711317113\",k = 3,minLength = 3) == 0",
    "assert candidate(s = \"23542185131\",k = 5,minLength = 1) == 0",
    "assert candidate(s = \"2233335555777711112222333355557777\",k = 6,minLength = 2) == 0",
    "assert candidate(s = \"2333353333533337333313333\",k = 7,minLength = 2) == 0",
    "assert candidate(s = \"23572357235723572357235723572357235723\",k = 15,minLength = 5) == 0",
    "assert candidate(s = \"235723572357235723572357235723572357\",k = 15,minLength = 2) == 0",
    "assert candidate(s = \"23547186918691869\",k = 4,minLength = 2) == 0",
    "assert candidate(s = \"331295897531\",k = 4,minLength = 1) == 1",
    "assert candidate(s = \"22222222222222222222\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"7777777777777777777777777777\",k = 8,minLength = 3) == 0",
    "assert candidate(s = \"235723572357\",k = 6,minLength = 2) == 0",
    "assert candidate(s = \"235235235235235235\",k = 7,minLength = 3) == 0",
    "assert candidate(s = \"733733733733733733733733\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"2375913759231\",k = 4,minLength = 2) == 0",
    "assert candidate(s = \"222333444555666777888999\",k = 3,minLength = 3) == 1",
    "assert candidate(s = \"735235235235235235\",k = 7,minLength = 2) == 0",
    "assert candidate(s = \"252525252525252525252525\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"223542185131223542185131223542185131\",k = 9,minLength = 3) == 1",
    "assert candidate(s = \"732519753189273189\",k = 4,minLength = 3) == 0",
    "assert candidate(s = \"233757537537537537537\",k = 8,minLength = 3) == 0",
    "assert candidate(s = \"22222222222222222222222222222222222222\",k = 15,minLength = 1) == 0",
    "assert candidate(s = \"222333555777111222333\",k = 7,minLength = 2) == 0",
    "assert candidate(s = \"735218513735218513735218513735\",k = 7,minLength = 3) == 0",
    "assert candidate(s = \"272727272727\",k = 6,minLength = 1) == 0",
    "assert candidate(s = \"23572357235723572357\",k = 5,minLength = 2) == 0",
    "assert candidate(s = \"222333555777111\",k = 4,minLength = 3) == 0",
    "assert candidate(s = \"37537537537537\",k = 6,minLength = 3) == 0",
    "assert candidate(s = \"22335577112233557711\",k = 6,minLength = 2) == 0",
    "assert candidate(s = \"2573197319731973197319\",k = 9,minLength = 2) == 0",
    "assert candidate(s = \"2354218513171925235729\",k = 6,minLength = 3) == 0",
    "assert candidate(s = \"232323232323232323232323\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"222333555777111222333555777111\",k = 4,minLength = 3) == 0",
    "assert candidate(s = \"753197531975319753\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"33333333333333333333333333333333333333\",k = 10,minLength = 1) == 0",
    "assert candidate(s = \"2323232323232323\",k = 8,minLength = 2) == 0",
    "assert candidate(s = \"33333333333333\",k = 5,minLength = 2) == 0",
    "assert candidate(s = \"33129583312958331295833129583312958331\",k = 10,minLength = 3) == 15",
    "assert candidate(s = \"373737373737\",k = 6,minLength = 1) == 0",
    "assert candidate(s = \"2233557711886644\",k = 6,minLength = 1) == 0",
    "assert candidate(s = \"235476918235476918235476918\",k = 6,minLength = 3) == 1",
    "assert candidate(s = \"333222111777555333222111\",k = 9,minLength = 2) == 0",
    "assert candidate(s = \"29292929292929\",k = 3,minLength = 3) == 3",
    "assert candidate(s = \"7235719753197532\",k = 5,minLength = 2) == 0",
    "assert candidate(s = \"35235235235235235235235235235\",k = 10,minLength = 3) == 0",
    "assert candidate(s = \"333555777222444666888999\",k = 5,minLength = 2) == 0",
    "assert candidate(s = \"373737373737373737\",k = 5,minLength = 3) == 0",
    "assert candidate(s = \"222333555777111222333555777111\",k = 6,minLength = 3) == 0",
    "assert candidate(s = \"23572357235723\",k = 1,minLength = 1) == 0",
    "assert candidate(s = \"23571113171923293137414347\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"22222222222222\",k = 2,minLength = 5) == 0",
    "assert candidate(s = \"23751937519375193\",k = 5,minLength = 2) == 0",
    "assert candidate(s = \"235421851312354218513123542185\",k = 6,minLength = 4) == 0",
    "assert candidate(s = \"22222222222222222222222222222222222222\",k = 20,minLength = 1) == 0",
    "assert candidate(s = \"27272727272727272727272727272\",k = 8,minLength = 2) == 0",
    "assert candidate(s = \"2222222222222222222222222222\",k = 12,minLength = 1) == 0",
    "assert candidate(s = \"753753753753753753753753753753753753753753\",k = 15,minLength = 5) == 0",
    "assert candidate(s = \"235421851312354218513123542185131\",k = 6,minLength = 2) == 462",
    "assert candidate(s = \"52373197357537325\",k = 5,minLength = 1) == 0",
    "assert candidate(s = \"23232323232323232323232323\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"222333555777222333555777222333555777\",k = 6,minLength = 4) == 0",
    "assert candidate(s = \"23542185131973\",k = 4,minLength = 2) == 0",
    "assert candidate(s = \"375375375375\",k = 5,minLength = 2) == 0",
    "assert candidate(s = \"75319753197531975319753197531975\",k = 8,minLength = 4) == 0",
    "assert candidate(s = \"3257113257113257113257\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"223355771199\",k = 6,minLength = 2) == 0",
    "assert candidate(s = \"375375375375375375375375375375\",k = 7,minLength = 4) == 0",
    "assert candidate(s = \"23572357235723\",k = 2,minLength = 5) == 0",
    "assert candidate(s = \"2354218513123542185131\",k = 6,minLength = 2) == 21",
    "assert candidate(s = \"23572357235723572357235723572357235723\",k = 15,minLength = 3) == 0",
    "assert candidate(s = \"3572535725357\",k = 5,minLength = 1) == 0",
    "assert candidate(s = \"2357135713571357\",k = 7,minLength = 2) == 0",
    "assert candidate(s = \"22223333555577772222\",k = 4,minLength = 5) == 0",
    "assert candidate(s = \"53725372537253725372537253725372\",k = 10,minLength = 3) == 0",
    "assert candidate(s = \"257357257357\",k = 4,minLength = 2) == 0",
    "assert candidate(s = \"2197531975319753\",k = 8,minLength = 3) == 0",
    "assert candidate(s = \"2357235723572357\",k = 1,minLength = 15) == 0",
    "assert candidate(s = \"23542185131719\",k = 5,minLength = 2) == 1",
    "assert candidate(s = \"57575757575757575757575757575\",k = 6,minLength = 4) == 0",
    "assert candidate(s = \"22335577223355772233\",k = 6,minLength = 1) == 0",
    "assert candidate(s = \"2357235723572357235723572357\",k = 7,minLength = 5) == 0",
    "assert candidate(s = \"37531975319753197537531975319753\",k = 12,minLength = 2) == 0",
    "assert candidate(s = \"25252525252525\",k = 5,minLength = 2) == 0",
    "assert candidate(s = \"21212121212121\",k = 3,minLength = 2) == 15",
    "assert candidate(s = \"2357198462357\",k = 4,minLength = 2) == 0",
    "assert candidate(s = \"235723572357235723572357\",k = 10,minLength = 2) == 0",
    "assert candidate(s = \"23232323232323232323232323232323\",k = 10,minLength = 2) == 0"
  ]
}