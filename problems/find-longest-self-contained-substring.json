{
  "id": "find-longest-self-contained-substring",
  "title": "Find Longest Self Contained Substring",
  "difficulty": "Hard",
  "tags": [
    "Hash Table",
    "String",
    "Binary Search",
    "Prefix Sum"
  ],
  "description": "Given a string s, your task is to find the length of the longest self-contained substring of s.\nA substring t of a string s is called self-contained if t != s and for every character in t, it doesn't exist in the rest of s.\nReturn the length of the longest self-contained substring of s if it exists, otherwise, return -1.\n\u00a0\nExample 1:\n\nInput: s = \"abba\"\nOutput: 2\nExplanation:\nLet's check the substring \"bb\". You can see that no other \"b\" is outside of this substring. Hence the answer is 2.\n\nExample 2:\n\nInput: s = \"abab\"\nOutput: -1\nExplanation:\nEvery substring we choose does not satisfy the described property (there is some character which is inside and outside of that substring). So the answer would be -1.\n\nExample 3:\n\nInput: s = \"abacd\"\nOutput: 4\nExplanation:\nLet's check the substring \"abac\". There is only one character outside of this substring and that is \"d\". There is no \"d\" inside the chosen substring, so it satisfies the condition and the answer is 4.\n\n\u00a0\nConstraints:\n\n2 <= s.length <= 5 * 104\ns consists only of lowercase English letters.\n\n",
  "entry_point": "Solution().maxSubstringLength",
  "starter_code": "class Solution:\n    def maxSubstringLength(self, s: str) -> int:\n        ",
  "preamble": "from typing import *\nfrom collections import *\nfrom functools import *\nfrom itertools import *\nfrom heapq import *\nfrom bisect import *\nfrom math import *\nimport math, collections, functools, itertools, bisect, heapq, string, re\n",
  "check_function": "def check(candidate):\n    assert candidate(s = \"abcdeabcde\") == -1\n    assert candidate(s = \"abba\") == 2\n    assert candidate(s = \"zzzzzz\") == -1\n    assert candidate(s = \"aabbcc\") == 4\n    assert candidate(s = \"abacabadabacaba\") == 1\n    assert candidate(s = \"abcabcabcabc\") == -1\n    assert candidate(s = \"xyzzyx\") == 4\n    assert candidate(s = \"abacd\") == 4\n    assert candidate(s = \"abcdef\") == 5\n    assert candidate(s = \"aabbccddeeff\") == 10\n    assert candidate(s = \"abcdeabc\") == 2\n    assert candidate(s = \"xyzabc\") == 5\n    assert candidate(s = \"aaaa\") == -1\n    assert candidate(s = \"abab\") == -1\n    assert candidate(s = \"abcabcabcabcabcabcabc\") == -1\n    assert candidate(s = \"aaabbbccc\") == 6\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == -1\n    assert candidate(s = \"abacabadabacabadabacabad\") == -1\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyz\") == 25\n    assert candidate(s = \"abcdefghijabcdefghijabcdefghijabcdefghij\") == -1\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == -1\n    assert candidate(s = \"mnopqrsmnopqrsmnopqrsmnopqrsmnopqrsmnopqrs\") == -1\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\") == 60\n    assert candidate(s = \"abcdefgihgfedcba\") == 14\n    assert candidate(s = \"abcdabcde\") == 8\n    assert candidate(s = \"mnopmnopmnop\") == -1\n    assert candidate(s = \"aabbaaabbbaaabbbaaa\") == -1\n    assert candidate(s = \"xyzxyzxyzxyzxyzxyzxyzxyzxyzxyzxyzxyz\") == -1\n    assert candidate(s = \"abcabcabcabcabcabcabcabcabcabc\") == -1\n    assert candidate(s = \"aaaaaaaaaabbbbbbbbbbbbbccccccccdddddd\") == 31\n    assert candidate(s = \"abcdeffedcbaa\") == 10\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzzxyz\") == 53\n    assert candidate(s = \"zzzzzzzzzzzzzzz\") == -1\n    assert candidate(s = \"abcdabcdeabcdabcdeabcd\") == -1\n    assert candidate(s = \"abcdefabcdefabcdefabcdefabcdef\") == -1\n    assert candidate(s = \"mnopqrsmnopqrsmnopqrs\") == -1\n    assert candidate(s = \"zzzzzzzzzzzzzzzzzzzz\") == -1\n    assert candidate(s = \"abcdefgabcdefgabcdefgabcdefgabcdefgabcdefg\") == -1\n    assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcd\") == -1\n    assert candidate(s = \"abcdefgabcdefgabcdefg\") == -1\n    assert candidate(s = \"aaaaaaaaaabbbbbbbbbbccccccccccdddddddddd\") == 30\n    assert candidate(s = \"mnopqrstmnopqrstmnopqrstmnopqrstmnopqrstmnopqrst\") == -1\n    assert candidate(s = \"abcdefgihgfedcbamnopqrsmnopqrsmnopqrs\") == 21\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzzab\") == 48\n    assert candidate(s = \"abcdefgabcdefgabcdefgabcdefgabcdefgabcdefgabcdefg\") == -1\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyz\") == 50\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzzabcdefghijklmnopqrstuvwxyz\") == -1\n    assert candidate(s = \"abacabadabacabadabacabadabacabadabacabad\") == -1\n    assert candidate(s = \"abcabcabcabcabcabcabcabcabc\") == -1\n    assert candidate(s = \"ababababababababababababababab\") == -1\n    assert candidate(s = \"abcdefgabcdefgabcdefgabcdefgabcdefg\") == -1\n    assert candidate(s = \"abcdefghijabcdefghij\") == -1\n    assert candidate(s = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\") == -1\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyzzyxwvutsrqponmlkjihgfedcba\") == 50\n    assert candidate(s = \"abcdefabcdefabcdefabcdef\") == -1\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz\") == -1\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzzzz\") == 52\n    assert candidate(s = \"abcdabcdabcd\") == -1\n    assert candidate(s = \"abababababababababababababababababababababababababababababababab\") == -1\n    assert candidate(s = \"xyzxyzxyzxyzxyzxyzxyzxyzxyzxyz\") == -1\n    assert candidate(s = \"abcabcabcabcabcabcabcabc\") == -1\n    assert candidate(s = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabc\") == -1\n    assert candidate(s = \"abababababab\") == -1\n    assert candidate(s = \"zyxwzyxwzyxwzyxwzyxwzyxwzyxwzyxwzyxwzyxw\") == -1\n    assert candidate(s = \"abcdefgabcdefg\") == -1\n    assert candidate(s = \"abcdefghijkabcdefghijk\") == -1\n    assert candidate(s = \"abababababababababababababababab\") == -1\n    assert candidate(s = \"abacabadabac\") == 1\n    assert candidate(s = \"aabbccddeeffgghhii\") == 16\n    assert candidate(s = \"mnopqrstuvwxyz\") == 13\n    assert candidate(s = \"aabbaabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\") == 54\n    assert candidate(s = \"abcdefgabcdefgabcdefgabcdefgh\") == 28\n    assert candidate(s = \"abcdeffedcba\") == 10\n    assert candidate(s = \"abcdabcdeabcdeabcde\") == -1\n    assert candidate(s = \"aaabbbcccdddcccbbaaa\") == 14\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzxy\") == 51\n    assert candidate(s = \"qwertyqwertyqwertyqwerty\") == -1\n    assert candidate(s = \"zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcba\") == -1\n    assert candidate(s = \"abcdefghijklmnopqrstuvwxyabcdefghijklmnopqrstuvwxy\") == -1\n    assert candidate(s = \"abcdeabcdeabcdeabcdeabcdeabcde\") == -1\n    assert candidate(s = \"xyzxyzxyzxyz\") == -1\n    assert candidate(s = \"xyzabcxyzabcxyzabcxyzabc\") == -1\n    assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\") == 50\n    assert candidate(s = \"zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcba\") == -1\n    assert candidate(s = \"mnopqrstmnopqrstmnopqrstmnopqrst\") == -1\n    assert candidate(s = \"abcabcabcabcfdefgdefgdefg\") == 13\n    assert candidate(s = \"aabbaabbaabbaabb\") == -1\n",
  "test_cases": [
    "assert candidate(s = \"abcdeabcde\") == -1",
    "assert candidate(s = \"abba\") == 2",
    "assert candidate(s = \"zzzzzz\") == -1",
    "assert candidate(s = \"aabbcc\") == 4",
    "assert candidate(s = \"abacabadabacaba\") == 1",
    "assert candidate(s = \"abcabcabcabc\") == -1",
    "assert candidate(s = \"xyzzyx\") == 4",
    "assert candidate(s = \"abacd\") == 4",
    "assert candidate(s = \"abcdef\") == 5",
    "assert candidate(s = \"aabbccddeeff\") == 10",
    "assert candidate(s = \"abcdeabc\") == 2",
    "assert candidate(s = \"xyzabc\") == 5",
    "assert candidate(s = \"aaaa\") == -1",
    "assert candidate(s = \"abab\") == -1",
    "assert candidate(s = \"abcabcabcabcabcabcabc\") == -1",
    "assert candidate(s = \"aaabbbccc\") == 6",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == -1",
    "assert candidate(s = \"abacabadabacabadabacabad\") == -1",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyz\") == 25",
    "assert candidate(s = \"abcdefghijabcdefghijabcdefghijabcdefghij\") == -1",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcdabcdabcd\") == -1",
    "assert candidate(s = \"mnopqrsmnopqrsmnopqrsmnopqrsmnopqrsmnopqrs\") == -1",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\") == 60",
    "assert candidate(s = \"abcdefgihgfedcba\") == 14",
    "assert candidate(s = \"abcdabcde\") == 8",
    "assert candidate(s = \"mnopmnopmnop\") == -1",
    "assert candidate(s = \"aabbaaabbbaaabbbaaa\") == -1",
    "assert candidate(s = \"xyzxyzxyzxyzxyzxyzxyzxyzxyzxyzxyzxyz\") == -1",
    "assert candidate(s = \"abcabcabcabcabcabcabcabcabcabc\") == -1",
    "assert candidate(s = \"aaaaaaaaaabbbbbbbbbbbbbccccccccdddddd\") == 31",
    "assert candidate(s = \"abcdeffedcbaa\") == 10",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzzxyz\") == 53",
    "assert candidate(s = \"zzzzzzzzzzzzzzz\") == -1",
    "assert candidate(s = \"abcdabcdeabcdabcdeabcd\") == -1",
    "assert candidate(s = \"abcdefabcdefabcdefabcdefabcdef\") == -1",
    "assert candidate(s = \"mnopqrsmnopqrsmnopqrs\") == -1",
    "assert candidate(s = \"zzzzzzzzzzzzzzzzzzzz\") == -1",
    "assert candidate(s = \"abcdefgabcdefgabcdefgabcdefgabcdefgabcdefg\") == -1",
    "assert candidate(s = \"abcdabcdabcdabcdabcdabcdabcdabcd\") == -1",
    "assert candidate(s = \"abcdefgabcdefgabcdefg\") == -1",
    "assert candidate(s = \"aaaaaaaaaabbbbbbbbbbccccccccccdddddddddd\") == 30",
    "assert candidate(s = \"mnopqrstmnopqrstmnopqrstmnopqrstmnopqrstmnopqrst\") == -1",
    "assert candidate(s = \"abcdefgihgfedcbamnopqrsmnopqrsmnopqrs\") == 21",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzzab\") == 48",
    "assert candidate(s = \"abcdefgabcdefgabcdefgabcdefgabcdefgabcdefgabcdefg\") == -1",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyz\") == 50",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzzabcdefghijklmnopqrstuvwxyz\") == -1",
    "assert candidate(s = \"abacabadabacabadabacabadabacabadabacabad\") == -1",
    "assert candidate(s = \"abcabcabcabcabcabcabcabcabc\") == -1",
    "assert candidate(s = \"ababababababababababababababab\") == -1",
    "assert candidate(s = \"abcdefgabcdefgabcdefgabcdefgabcdefg\") == -1",
    "assert candidate(s = \"abcdefghijabcdefghij\") == -1",
    "assert candidate(s = \"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz\") == -1",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyzzyxwvutsrqponmlkjihgfedcba\") == 50",
    "assert candidate(s = \"abcdefabcdefabcdefabcdef\") == -1",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz\") == -1",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzzzz\") == 52",
    "assert candidate(s = \"abcdabcdabcd\") == -1",
    "assert candidate(s = \"abababababababababababababababababababababababababababababababab\") == -1",
    "assert candidate(s = \"xyzxyzxyzxyzxyzxyzxyzxyzxyzxyz\") == -1",
    "assert candidate(s = \"abcabcabcabcabcabcabcabc\") == -1",
    "assert candidate(s = \"abcabcabcabcabcabcabcabcabcabcabcabcabcabc\") == -1",
    "assert candidate(s = \"abababababab\") == -1",
    "assert candidate(s = \"zyxwzyxwzyxwzyxwzyxwzyxwzyxwzyxwzyxwzyxw\") == -1",
    "assert candidate(s = \"abcdefgabcdefg\") == -1",
    "assert candidate(s = \"abcdefghijkabcdefghijk\") == -1",
    "assert candidate(s = \"abababababababababababababababab\") == -1",
    "assert candidate(s = \"abacabadabac\") == 1",
    "assert candidate(s = \"aabbccddeeffgghhii\") == 16",
    "assert candidate(s = \"mnopqrstuvwxyz\") == 13",
    "assert candidate(s = \"aabbaabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\") == 54",
    "assert candidate(s = \"abcdefgabcdefgabcdefgabcdefgh\") == 28",
    "assert candidate(s = \"abcdeffedcba\") == 10",
    "assert candidate(s = \"abcdabcdeabcdeabcde\") == -1",
    "assert candidate(s = \"aaabbbcccdddcccbbaaa\") == 14",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzxy\") == 51",
    "assert candidate(s = \"qwertyqwertyqwertyqwerty\") == -1",
    "assert candidate(s = \"zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcba\") == -1",
    "assert candidate(s = \"abcdefghijklmnopqrstuvwxyabcdefghijklmnopqrstuvwxy\") == -1",
    "assert candidate(s = \"abcdeabcdeabcdeabcdeabcdeabcde\") == -1",
    "assert candidate(s = \"xyzxyzxyzxyz\") == -1",
    "assert candidate(s = \"xyzabcxyzabcxyzabcxyzabc\") == -1",
    "assert candidate(s = \"aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz\") == 50",
    "assert candidate(s = \"zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcba\") == -1",
    "assert candidate(s = \"mnopqrstmnopqrstmnopqrstmnopqrst\") == -1",
    "assert candidate(s = \"abcabcabcabcfdefgdefgdefg\") == 13",
    "assert candidate(s = \"aabbaabbaabbaabb\") == -1"
  ]
}