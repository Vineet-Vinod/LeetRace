{
  "id": "minimum-number-of-visited-cells-in-a-grid",
  "title": "Minimum Number Of Visited Cells In A Grid",
  "difficulty": "Hard",
  "tags": [
    "Stack",
    "Breadth-First Search",
    "Union Find",
    "Array",
    "Dynamic Programming",
    "Matrix",
    "Monotonic Stack",
    "Heap (Priority Queue)"
  ],
  "description": "You are given a 0-indexed m x n integer matrix grid. Your initial position is at the top-left cell (0, 0).\nStarting from the cell (i, j), you can move to one of the following cells:\n\nCells (i, k) with j < k <= grid[i][j] + j (rightward movement), or\nCells (k, j) with i < k <= grid[i][j] + i (downward movement).\n\nReturn the minimum number of cells you need to visit to reach the bottom-right cell (m - 1, n - 1). If there is no valid path, return -1.\n\u00a0\nExample 1:\n\n\nInput: grid = [[3,4,2,1],[4,2,3,1],[2,1,0,0],[2,4,0,0]]\nOutput: 4\nExplanation: The image above shows one of the paths that visits exactly 4 cells.\n\nExample 2:\n\n\nInput: grid = [[3,4,2,1],[4,2,1,1],[2,1,1,0],[3,4,1,0]]\nOutput: 3\nExplanation: The image above shows one of the paths that visits exactly 3 cells.\n\nExample 3:\n\n\nInput: grid = [[2,1,0],[1,0,0]]\nOutput: -1\nExplanation: It can be proven that no path exists.\n\n\u00a0\nConstraints:\n\nm == grid.length\nn == grid[i].length\n1 <= m, n <= 105\n1 <= m * n <= 105\n0 <= grid[i][j] < m * n\ngrid[m - 1][n - 1] == 0\n\n",
  "entry_point": "Solution().minimumVisitedCells",
  "starter_code": "class Solution:\n    def minimumVisitedCells(self, grid: List[List[int]]) -> int:\n        ",
  "preamble": "from typing import *\nfrom collections import *\nfrom functools import *\nfrom itertools import *\nfrom heapq import *\nfrom bisect import *\nfrom math import *\nimport math, collections, functools, itertools, bisect, heapq, string, re\n",
  "check_function": "def check(candidate):\n    assert candidate(grid = [[2, 0, 0], [1, 3, 1], [0, 1, 0]]) == 5\n    assert candidate(grid = [[1, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[3, 4, 2, 1], [4, 2, 3, 1], [2, 1, 0, 0], [2, 4, 0, 0]]) == 4\n    assert candidate(grid = [[3, 4, 2, 1], [4, 2, 1, 1], [2, 1, 1, 0], [3, 4, 1, 0]]) == 3\n    assert candidate(grid = [[0, 0], [0, 0]]) == -1\n    assert candidate(grid = [[1, 1, 1], [1, 1, 1], [1, 1, 0]]) == 5\n    assert candidate(grid = [[2, 1, 0], [1, 0, 0]]) == -1\n    assert candidate(grid = [[0]]) == 1\n    assert candidate(grid = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]) == 4\n    assert candidate(grid = [[0, 0, 0], [0, 0, 0], [0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 0], [0, 0]]) == -1\n    assert candidate(grid = [[1, 2, 3, 4, 5], [2, 3, 4, 5, 0], [3, 4, 5, 0, 0], [4, 5, 0, 0, 0], [5, 0, 0, 0, 0]]) == 5\n    assert candidate(grid = [[3, 2, 1, 4, 0], [4, 1, 2, 3, 1], [2, 3, 0, 1, 0], [3, 0, 2, 0, 1], [0, 0, 0, 0, 0]]) == 5\n    assert candidate(grid = [[2, 0, 0], [0, 2, 0], [0, 0, 0]]) == -1\n    assert candidate(grid = [[0, 1, 0, 1, 0], [1, 0, 1, 0, 1], [0, 1, 0, 1, 0], [1, 0, 1, 0, 0]]) == -1\n    assert candidate(grid = [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[2, 1, 0, 0, 0], [0, 0, 3, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[2, 2, 2, 2, 2], [2, 1, 1, 1, 2], [2, 1, 0, 1, 2], [2, 1, 1, 1, 2], [2, 2, 2, 2, 0]]) == 5\n    assert candidate(grid = [[2, 2, 1, 1], [1, 2, 2, 1], [1, 1, 2, 2], [1, 1, 1, 0]]) == 5\n    assert candidate(grid = [[2, 2, 0, 0], [2, 2, 0, 0], [0, 0, 3, 0], [0, 0, 0, 3], [0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 2, 3], [4, 5, 6], [7, 8, 0]]) == 4\n    assert candidate(grid = [[3, 0, 0, 0], [0, 3, 0, 0], [0, 0, 3, 0], [0, 0, 0, 3]]) == -1\n    assert candidate(grid = [[3, 3, 3, 3], [3, 3, 3, 3], [3, 3, 3, 3], [3, 3, 3, 0]]) == 3\n    assert candidate(grid = [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [1, 3, 5, 7, 9], [9, 7, 5, 3, 1], [0, 0, 0, 0, 0]]) == 5\n    assert candidate(grid = [[2, 3, 0, 0, 1], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 0]]) == 9\n    assert candidate(grid = [[0, 1, 2, 3, 4], [1, 0, 1, 2, 3], [2, 1, 0, 1, 2], [3, 2, 1, 0, 1], [4, 3, 2, 1, 0]]) == -1\n    assert candidate(grid = [[3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 0]]) == 5\n    assert candidate(grid = [[1, 2, 3, 4], [2, 3, 4, 5], [3, 4, 5, 6], [4, 5, 6, 0]]) == 4\n    assert candidate(grid = [[0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[3, 3, 0, 2, 1, 1], [2, 2, 0, 1, 1, 0], [1, 1, 0, 0, 0, 0], [1, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [0, 0, 0, 0, 0, 0]]) == 11\n    assert candidate(grid = [[1, 2, 3, 4], [1, 2, 3, 4], [1, 2, 3, 4], [1, 2, 3, 0]]) == 4\n    assert candidate(grid = [[1, 2, 3, 4, 5], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [5, 4, 3, 2, 0]]) == 5\n    assert candidate(grid = [[2, 2, 2, 2], [2, 2, 2, 2], [2, 2, 2, 2], [2, 2, 2, 0]]) == 5\n    assert candidate(grid = [[3, 0, 0, 1], [0, 0, 0, 1], [1, 0, 0, 1], [1, 1, 1, 0]]) == 5\n    assert candidate(grid = [[5, 0, 0, 0, 0], [4, 0, 0, 0, 0], [3, 0, 0, 0, 0], [2, 0, 0, 0, 0], [1, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 0]]) == 13\n    assert candidate(grid = [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]]) == -1\n    assert candidate(grid = [[0, 1, 0, 1, 0, 1], [1, 0, 1, 0, 1, 0], [0, 1, 0, 1, 0, 1], [1, 0, 1, 0, 1, 0], [0, 1, 0, 1, 0, 0]]) == -1\n    assert candidate(grid = [[1, 2, 3, 4, 5], [2, 3, 4, 5, 6], [3, 4, 5, 6, 7], [4, 5, 6, 7, 8], [5, 6, 7, 8, 0]]) == 5\n    assert candidate(grid = [[1, 2, 3, 4], [4, 3, 2, 1], [2, 1, 4, 3], [3, 4, 1, 0]]) == 4\n    assert candidate(grid = [[3, 2, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 0]]) == 7\n    assert candidate(grid = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 0]]) == 11\n    assert candidate(grid = [[2, 1, 0, 0], [0, 2, 1, 0], [1, 0, 2, 0], [0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[3, 0, 2, 1, 1], [0, 0, 0, 0, 0], [1, 0, 0, 0, 0], [0, 0, 0, 0, 0], [1, 1, 1, 1, 0]]) == -1\n    assert candidate(grid = [[0, 1, 2, 3], [1, 2, 3, 0], [2, 3, 0, 0], [3, 0, 0, 0]]) == -1\n    assert candidate(grid = [[5, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 0]]) == 7\n    assert candidate(grid = [[2, 0, 0, 0, 0], [0, 2, 0, 0, 0], [0, 0, 2, 0, 0], [0, 0, 0, 2, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[2, 3, 1, 1, 4], [2, 2, 2, 2, 2], [1, 1, 2, 1, 2], [2, 2, 2, 2, 2], [0, 0, 0, 0, 0]]) == 4\n    assert candidate(grid = [[2, 3, 0, 0, 0], [1, 1, 0, 0, 0], [1, 0, 0, 0, 0], [1, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[4, 3, 2, 1, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[3, 1, 0, 2, 0], [0, 1, 1, 0, 0], [0, 0, 0, 1, 1], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[0, 1, 2, 3, 4, 5], [1, 2, 3, 4, 5, 0], [2, 3, 4, 5, 0, 5], [3, 4, 5, 0, 5, 4], [4, 5, 0, 5, 4, 3], [5, 0, 5, 4, 3, 0]]) == -1\n    assert candidate(grid = [[3, 2, 1, 0], [2, 2, 2, 2], [1, 2, 2, 2], [0, 2, 2, 0]]) == 5\n    assert candidate(grid = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 0]]) == 7\n    assert candidate(grid = [[2, 3, 1, 1, 1], [1, 2, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 0]]) == 7\n    assert candidate(grid = [[5, 4, 3, 2, 1, 0], [4, 3, 2, 1, 0, 0], [3, 2, 1, 0, 0, 0], [2, 1, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 3, 1, 3, 1, 3], [3, 1, 3, 1, 3, 1], [1, 3, 1, 3, 1, 0], [3, 1, 3, 1, 3, 1], [1, 3, 1, 3, 1, 1]]) == 6\n    assert candidate(grid = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]) == 19\n    assert candidate(grid = [[5, 3, 2, 1], [2, 2, 2, 1], [1, 1, 1, 1], [0, 0, 0, 0]]) == 5\n    assert candidate(grid = [[10, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[3, 2, 2, 1], [1, 2, 3, 4], [2, 3, 1, 1], [1, 1, 1, 0]]) == 4\n    assert candidate(grid = [[3, 1, 2, 1, 1], [2, 2, 1, 1, 2], [1, 1, 2, 1, 1], [1, 2, 1, 2, 1], [0, 0, 0, 0, 0]]) == 6\n    assert candidate(grid = [[1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 0]]) == 11\n    assert candidate(grid = [[2, 0, 2, 0, 1, 0], [0, 2, 0, 2, 0, 2], [2, 0, 2, 0, 2, 0], [0, 2, 0, 2, 0, 2], [1, 0, 1, 0, 1, 0], [0, 0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[0, 2, 2], [2, 0, 2], [2, 2, 0]]) == -1\n    assert candidate(grid = [[5, 4, 3, 2, 1], [4, 3, 2, 1, 0], [3, 2, 1, 0, 0], [2, 1, 0, 0, 0], [1, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[2, 0, 0, 0, 0, 0], [0, 2, 0, 0, 0, 0], [0, 0, 2, 0, 0, 0], [0, 0, 0, 2, 0, 0], [0, 0, 0, 0, 2, 0], [0, 0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[5, 5, 5, 5], [5, 5, 5, 5], [5, 5, 5, 5], [5, 5, 5, 0]]) == 3\n    assert candidate(grid = [[4, 3, 2, 1, 0], [3, 3, 3, 3, 3], [2, 3, 2, 3, 2], [1, 3, 2, 3, 1], [0, 3, 2, 3, 0]]) == 5\n    assert candidate(grid = [[4, 4, 4, 4, 4], [4, 4, 4, 4, 4], [4, 4, 4, 4, 4], [4, 4, 4, 4, 4], [4, 4, 4, 4, 0]]) == 3\n    assert candidate(grid = [[2, 2, 2, 2], [2, 0, 0, 2], [2, 0, 0, 2], [2, 2, 2, 0]]) == 5\n    assert candidate(grid = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [0, 0, 0, 0, 0]]) == 9\n    assert candidate(grid = [[3, 1, 2, 3, 2], [1, 1, 1, 1, 1], [2, 1, 2, 1, 2], [1, 2, 1, 2, 1], [2, 1, 1, 1, 0]]) == 5\n    assert candidate(grid = [[1, 1, 1, 1, 1, 1], [1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 1], [1, 1, 1, 1, 1, 0]]) == 11\n    assert candidate(grid = [[4, 4, 4, 4], [4, 4, 4, 4], [4, 4, 4, 4], [4, 4, 4, 0]]) == 3\n    assert candidate(grid = [[2, 3, 3, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0]]) == 12\n    assert candidate(grid = [[2, 2, 1, 2], [2, 2, 2, 1], [1, 2, 2, 2], [2, 1, 1, 0]]) == 5\n    assert candidate(grid = [[3, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 3]]) == -1\n    assert candidate(grid = [[3, 2, 1, 1, 2], [2, 2, 3, 1, 1], [1, 3, 2, 1, 1], [1, 1, 1, 2, 3], [1, 1, 1, 1, 0]]) == 6\n    assert candidate(grid = [[3, 2, 1, 0], [2, 3, 1, 0], [1, 1, 0, 0], [0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[5, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[2, 1, 1, 1], [1, 1, 2, 1], [1, 2, 1, 1], [1, 1, 1, 2]]) == 5\n    assert candidate(grid = [[2, 1, 2, 1, 2], [1, 2, 1, 2, 1], [2, 1, 2, 1, 2], [1, 2, 1, 2, 1], [0, 0, 0, 0, 0]]) == 5\n    assert candidate(grid = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[2, 3, 4, 5, 6], [1, 1, 1, 1, 1], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == 4\n    assert candidate(grid = [[2, 0, 3, 0, 0], [1, 0, 0, 0, 4], [0, 0, 0, 0, 0], [3, 0, 0, 0, 2], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[4, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 2, 3, 4], [2, 3, 4, 3], [3, 4, 3, 2], [4, 3, 2, 1]]) == 4\n    assert candidate(grid = [[2, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[3, 3, 3], [3, 0, 0], [3, 0, 0]]) == 3\n    assert candidate(grid = [[5, 5, 5, 5, 5], [5, 0, 0, 0, 0], [5, 0, 0, 0, 0], [5, 0, 0, 0, 0], [5, 0, 0, 0, 0]]) == 3\n    assert candidate(grid = [[3, 2, 1, 4, 0, 0, 0], [0, 1, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[3, 2, 1, 0, 0], [2, 2, 0, 1, 0], [0, 1, 0, 2, 3], [1, 0, 0, 0, 4], [0, 0, 0, 0, 0]]) == 7\n    assert candidate(grid = [[1, 1, 1], [1, 0, 0], [1, 0, 0]]) == -1\n    assert candidate(grid = [[4, 2, 0, 0, 0], [2, 2, 2, 0, 0], [0, 2, 2, 2, 0], [0, 0, 2, 2, 2], [0, 0, 0, 2, 0]]) == 6\n    assert candidate(grid = [[0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[2, 1, 2], [1, 2, 1], [2, 1, 0]]) == 3\n    assert candidate(grid = [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1\n    assert candidate(grid = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 0]]) == 9\n",
  "test_cases": [
    "assert candidate(grid = [[2, 0, 0], [1, 3, 1], [0, 1, 0]]) == 5",
    "assert candidate(grid = [[1, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[3, 4, 2, 1], [4, 2, 3, 1], [2, 1, 0, 0], [2, 4, 0, 0]]) == 4",
    "assert candidate(grid = [[3, 4, 2, 1], [4, 2, 1, 1], [2, 1, 1, 0], [3, 4, 1, 0]]) == 3",
    "assert candidate(grid = [[0, 0], [0, 0]]) == -1",
    "assert candidate(grid = [[1, 1, 1], [1, 1, 1], [1, 1, 0]]) == 5",
    "assert candidate(grid = [[2, 1, 0], [1, 0, 0]]) == -1",
    "assert candidate(grid = [[0]]) == 1",
    "assert candidate(grid = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]) == 4",
    "assert candidate(grid = [[0, 0, 0], [0, 0, 0], [0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 0], [0, 0]]) == -1",
    "assert candidate(grid = [[1, 2, 3, 4, 5], [2, 3, 4, 5, 0], [3, 4, 5, 0, 0], [4, 5, 0, 0, 0], [5, 0, 0, 0, 0]]) == 5",
    "assert candidate(grid = [[3, 2, 1, 4, 0], [4, 1, 2, 3, 1], [2, 3, 0, 1, 0], [3, 0, 2, 0, 1], [0, 0, 0, 0, 0]]) == 5",
    "assert candidate(grid = [[2, 0, 0], [0, 2, 0], [0, 0, 0]]) == -1",
    "assert candidate(grid = [[0, 1, 0, 1, 0], [1, 0, 1, 0, 1], [0, 1, 0, 1, 0], [1, 0, 1, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[2, 1, 0, 0, 0], [0, 0, 3, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[2, 2, 2, 2, 2], [2, 1, 1, 1, 2], [2, 1, 0, 1, 2], [2, 1, 1, 1, 2], [2, 2, 2, 2, 0]]) == 5",
    "assert candidate(grid = [[2, 2, 1, 1], [1, 2, 2, 1], [1, 1, 2, 2], [1, 1, 1, 0]]) == 5",
    "assert candidate(grid = [[2, 2, 0, 0], [2, 2, 0, 0], [0, 0, 3, 0], [0, 0, 0, 3], [0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 2, 3], [4, 5, 6], [7, 8, 0]]) == 4",
    "assert candidate(grid = [[3, 0, 0, 0], [0, 3, 0, 0], [0, 0, 3, 0], [0, 0, 0, 3]]) == -1",
    "assert candidate(grid = [[3, 3, 3, 3], [3, 3, 3, 3], [3, 3, 3, 3], [3, 3, 3, 0]]) == 3",
    "assert candidate(grid = [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [1, 3, 5, 7, 9], [9, 7, 5, 3, 1], [0, 0, 0, 0, 0]]) == 5",
    "assert candidate(grid = [[2, 3, 0, 0, 1], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 0]]) == 9",
    "assert candidate(grid = [[0, 1, 2, 3, 4], [1, 0, 1, 2, 3], [2, 1, 0, 1, 2], [3, 2, 1, 0, 1], [4, 3, 2, 1, 0]]) == -1",
    "assert candidate(grid = [[3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 3], [3, 3, 3, 3, 3, 0]]) == 5",
    "assert candidate(grid = [[1, 2, 3, 4], [2, 3, 4, 5], [3, 4, 5, 6], [4, 5, 6, 0]]) == 4",
    "assert candidate(grid = [[0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[3, 3, 0, 2, 1, 1], [2, 2, 0, 1, 1, 0], [1, 1, 0, 0, 0, 0], [1, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [0, 0, 0, 0, 0, 0]]) == 11",
    "assert candidate(grid = [[1, 2, 3, 4], [1, 2, 3, 4], [1, 2, 3, 4], [1, 2, 3, 0]]) == 4",
    "assert candidate(grid = [[1, 2, 3, 4, 5], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [5, 4, 3, 2, 0]]) == 5",
    "assert candidate(grid = [[2, 2, 2, 2], [2, 2, 2, 2], [2, 2, 2, 2], [2, 2, 2, 0]]) == 5",
    "assert candidate(grid = [[3, 0, 0, 1], [0, 0, 0, 1], [1, 0, 0, 1], [1, 1, 1, 0]]) == 5",
    "assert candidate(grid = [[5, 0, 0, 0, 0], [4, 0, 0, 0, 0], [3, 0, 0, 0, 0], [2, 0, 0, 0, 0], [1, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 0]]) == 13",
    "assert candidate(grid = [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]]) == -1",
    "assert candidate(grid = [[0, 1, 0, 1, 0, 1], [1, 0, 1, 0, 1, 0], [0, 1, 0, 1, 0, 1], [1, 0, 1, 0, 1, 0], [0, 1, 0, 1, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 2, 3, 4, 5], [2, 3, 4, 5, 6], [3, 4, 5, 6, 7], [4, 5, 6, 7, 8], [5, 6, 7, 8, 0]]) == 5",
    "assert candidate(grid = [[1, 2, 3, 4], [4, 3, 2, 1], [2, 1, 4, 3], [3, 4, 1, 0]]) == 4",
    "assert candidate(grid = [[3, 2, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 0]]) == 7",
    "assert candidate(grid = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 0]]) == 11",
    "assert candidate(grid = [[2, 1, 0, 0], [0, 2, 1, 0], [1, 0, 2, 0], [0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[3, 0, 2, 1, 1], [0, 0, 0, 0, 0], [1, 0, 0, 0, 0], [0, 0, 0, 0, 0], [1, 1, 1, 1, 0]]) == -1",
    "assert candidate(grid = [[0, 1, 2, 3], [1, 2, 3, 0], [2, 3, 0, 0], [3, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[5, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 0]]) == 7",
    "assert candidate(grid = [[2, 0, 0, 0, 0], [0, 2, 0, 0, 0], [0, 0, 2, 0, 0], [0, 0, 0, 2, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[2, 3, 1, 1, 4], [2, 2, 2, 2, 2], [1, 1, 2, 1, 2], [2, 2, 2, 2, 2], [0, 0, 0, 0, 0]]) == 4",
    "assert candidate(grid = [[2, 3, 0, 0, 0], [1, 1, 0, 0, 0], [1, 0, 0, 0, 0], [1, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[4, 3, 2, 1, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[3, 1, 0, 2, 0], [0, 1, 1, 0, 0], [0, 0, 0, 1, 1], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[0, 1, 2, 3, 4, 5], [1, 2, 3, 4, 5, 0], [2, 3, 4, 5, 0, 5], [3, 4, 5, 0, 5, 4], [4, 5, 0, 5, 4, 3], [5, 0, 5, 4, 3, 0]]) == -1",
    "assert candidate(grid = [[3, 2, 1, 0], [2, 2, 2, 2], [1, 2, 2, 2], [0, 2, 2, 0]]) == 5",
    "assert candidate(grid = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 0]]) == 7",
    "assert candidate(grid = [[2, 3, 1, 1, 1], [1, 2, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 0]]) == 7",
    "assert candidate(grid = [[5, 4, 3, 2, 1, 0], [4, 3, 2, 1, 0, 0], [3, 2, 1, 0, 0, 0], [2, 1, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 3, 1, 3, 1, 3], [3, 1, 3, 1, 3, 1], [1, 3, 1, 3, 1, 0], [3, 1, 3, 1, 3, 1], [1, 3, 1, 3, 1, 1]]) == 6",
    "assert candidate(grid = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]) == 19",
    "assert candidate(grid = [[5, 3, 2, 1], [2, 2, 2, 1], [1, 1, 1, 1], [0, 0, 0, 0]]) == 5",
    "assert candidate(grid = [[10, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[3, 2, 2, 1], [1, 2, 3, 4], [2, 3, 1, 1], [1, 1, 1, 0]]) == 4",
    "assert candidate(grid = [[3, 1, 2, 1, 1], [2, 2, 1, 1, 2], [1, 1, 2, 1, 1], [1, 2, 1, 2, 1], [0, 0, 0, 0, 0]]) == 6",
    "assert candidate(grid = [[1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 0]]) == 11",
    "assert candidate(grid = [[2, 0, 2, 0, 1, 0], [0, 2, 0, 2, 0, 2], [2, 0, 2, 0, 2, 0], [0, 2, 0, 2, 0, 2], [1, 0, 1, 0, 1, 0], [0, 0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[0, 2, 2], [2, 0, 2], [2, 2, 0]]) == -1",
    "assert candidate(grid = [[5, 4, 3, 2, 1], [4, 3, 2, 1, 0], [3, 2, 1, 0, 0], [2, 1, 0, 0, 0], [1, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[2, 0, 0, 0, 0, 0], [0, 2, 0, 0, 0, 0], [0, 0, 2, 0, 0, 0], [0, 0, 0, 2, 0, 0], [0, 0, 0, 0, 2, 0], [0, 0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[5, 5, 5, 5], [5, 5, 5, 5], [5, 5, 5, 5], [5, 5, 5, 0]]) == 3",
    "assert candidate(grid = [[4, 3, 2, 1, 0], [3, 3, 3, 3, 3], [2, 3, 2, 3, 2], [1, 3, 2, 3, 1], [0, 3, 2, 3, 0]]) == 5",
    "assert candidate(grid = [[4, 4, 4, 4, 4], [4, 4, 4, 4, 4], [4, 4, 4, 4, 4], [4, 4, 4, 4, 4], [4, 4, 4, 4, 0]]) == 3",
    "assert candidate(grid = [[2, 2, 2, 2], [2, 0, 0, 2], [2, 0, 0, 2], [2, 2, 2, 0]]) == 5",
    "assert candidate(grid = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [0, 0, 0, 0, 0]]) == 9",
    "assert candidate(grid = [[3, 1, 2, 3, 2], [1, 1, 1, 1, 1], [2, 1, 2, 1, 2], [1, 2, 1, 2, 1], [2, 1, 1, 1, 0]]) == 5",
    "assert candidate(grid = [[1, 1, 1, 1, 1, 1], [1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 1], [1, 1, 1, 1, 1, 0]]) == 11",
    "assert candidate(grid = [[4, 4, 4, 4], [4, 4, 4, 4], [4, 4, 4, 4], [4, 4, 4, 0]]) == 3",
    "assert candidate(grid = [[2, 3, 3, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0]]) == 12",
    "assert candidate(grid = [[2, 2, 1, 2], [2, 2, 2, 1], [1, 2, 2, 2], [2, 1, 1, 0]]) == 5",
    "assert candidate(grid = [[3, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 3]]) == -1",
    "assert candidate(grid = [[3, 2, 1, 1, 2], [2, 2, 3, 1, 1], [1, 3, 2, 1, 1], [1, 1, 1, 2, 3], [1, 1, 1, 1, 0]]) == 6",
    "assert candidate(grid = [[3, 2, 1, 0], [2, 3, 1, 0], [1, 1, 0, 0], [0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[5, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[2, 1, 1, 1], [1, 1, 2, 1], [1, 2, 1, 1], [1, 1, 1, 2]]) == 5",
    "assert candidate(grid = [[2, 1, 2, 1, 2], [1, 2, 1, 2, 1], [2, 1, 2, 1, 2], [1, 2, 1, 2, 1], [0, 0, 0, 0, 0]]) == 5",
    "assert candidate(grid = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[2, 3, 4, 5, 6], [1, 1, 1, 1, 1], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == 4",
    "assert candidate(grid = [[2, 0, 3, 0, 0], [1, 0, 0, 0, 4], [0, 0, 0, 0, 0], [3, 0, 0, 0, 2], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[4, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 2, 3, 4], [2, 3, 4, 3], [3, 4, 3, 2], [4, 3, 2, 1]]) == 4",
    "assert candidate(grid = [[2, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[3, 3, 3], [3, 0, 0], [3, 0, 0]]) == 3",
    "assert candidate(grid = [[5, 5, 5, 5, 5], [5, 0, 0, 0, 0], [5, 0, 0, 0, 0], [5, 0, 0, 0, 0], [5, 0, 0, 0, 0]]) == 3",
    "assert candidate(grid = [[3, 2, 1, 4, 0, 0, 0], [0, 1, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[3, 2, 1, 0, 0], [2, 2, 0, 1, 0], [0, 1, 0, 2, 3], [1, 0, 0, 0, 4], [0, 0, 0, 0, 0]]) == 7",
    "assert candidate(grid = [[1, 1, 1], [1, 0, 0], [1, 0, 0]]) == -1",
    "assert candidate(grid = [[4, 2, 0, 0, 0], [2, 2, 2, 0, 0], [0, 2, 2, 2, 0], [0, 0, 2, 2, 2], [0, 0, 0, 2, 0]]) == 6",
    "assert candidate(grid = [[0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[2, 1, 2], [1, 2, 1], [2, 1, 0]]) == 3",
    "assert candidate(grid = [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]]) == -1",
    "assert candidate(grid = [[1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 1], [1, 1, 1, 1, 0]]) == 9"
  ]
}