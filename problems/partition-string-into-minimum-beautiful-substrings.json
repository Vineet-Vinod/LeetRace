{
  "id": "partition-string-into-minimum-beautiful-substrings",
  "title": "Partition String Into Minimum Beautiful Substrings",
  "difficulty": "Medium",
  "tags": [
    "Hash Table",
    "String",
    "Dynamic Programming",
    "Backtracking"
  ],
  "description": "Given a binary string s, partition the string into one or more substrings such that each substring is beautiful.\nA string is beautiful if:\n\nIt doesn't contain leading zeros.\nIt's the binary representation of a number that is a power of 5.\n\nReturn the minimum number of substrings in such partition. If it is impossible to partition the string s into beautiful substrings,\u00a0return -1.\nA substring is a contiguous sequence of characters in a string.\n\u00a0\nExample 1:\n\nInput: s = \"1011\"\nOutput: 2\nExplanation: We can paritition the given string into [\"101\", \"1\"].\n- The string \"101\" does not contain leading zeros and is the binary representation of integer 51 = 5.\n- The string \"1\" does not contain leading zeros and is the binary representation of integer 50 = 1.\nIt can be shown that 2 is the minimum number of beautiful substrings that s can be partitioned into.\n\nExample 2:\n\nInput: s = \"111\"\nOutput: 3\nExplanation: We can paritition the given string into [\"1\", \"1\", \"1\"].\n- The string \"1\" does not contain leading zeros and is the binary representation of integer 50 = 1.\nIt can be shown that 3 is the minimum number of beautiful substrings that s can be partitioned into.\n\nExample 3:\n\nInput: s = \"0\"\nOutput: -1\nExplanation: We can not partition the given string into beautiful substrings.\n\n\u00a0\nConstraints:\n\n1 <= s.length <= 15\ns[i] is either '0' or '1'.\n\n",
  "entry_point": "Solution().minimumBeautifulSubstrings",
  "starter_code": "class Solution:\n    def minimumBeautifulSubstrings(self, s: str) -> int:\n        ",
  "preamble": "from typing import *\nfrom collections import *\nfrom functools import *\nfrom itertools import *\nfrom heapq import *\nfrom bisect import *\nfrom math import *\nimport math, collections, functools, itertools, bisect, heapq, string, re\n",
  "check_function": "def check(candidate):\n    assert candidate(s = \"1100101\") == -1\n    assert candidate(s = \"100000000000000\") == -1\n    assert candidate(s = \"101010101010101\") == -1\n    assert candidate(s = \"101010101\") == -1\n    assert candidate(s = \"111\") == 3\n    assert candidate(s = \"100000\") == -1\n    assert candidate(s = \"111111111\") == 9\n    assert candidate(s = \"0\") == -1\n    assert candidate(s = \"1010101\") == -1\n    assert candidate(s = \"1111111\") == 7\n    assert candidate(s = \"111111111111111\") == 15\n    assert candidate(s = \"1100001\") == -1\n    assert candidate(s = \"1011\") == 2\n    assert candidate(s = \"100111\") == -1\n    assert candidate(s = \"100111011\") == -1\n    assert candidate(s = \"1\") == 1\n    assert candidate(s = \"110000\") == -1\n    assert candidate(s = \"1000000\") == -1\n    assert candidate(s = \"1110111\") == 5\n    assert candidate(s = \"100000000\") == -1\n    assert candidate(s = \"110011001\") == -1\n    assert candidate(s = \"11001\") == 1\n    assert candidate(s = \"0111000111000111000111000111000\") == -1\n    assert candidate(s = \"10101010101\") == -1\n    assert candidate(s = \"100010001000100\") == -1\n    assert candidate(s = \"01101101101101101\") == -1\n    assert candidate(s = \"1101010101010101\") == -1\n    assert candidate(s = \"1010101010101010101010101\") == -1\n    assert candidate(s = \"1111111111111111111\") == 19\n    assert candidate(s = \"1010101010101010101\") == -1\n    assert candidate(s = \"00001000010000100001\") == -1\n    assert candidate(s = \"101010101010001\") == -1\n    assert candidate(s = \"111011011001111\") == -1\n    assert candidate(s = \"1011011011011011011\") == 7\n    assert candidate(s = \"100000000000001\") == -1\n    assert candidate(s = \"111000111000111\") == -1\n    assert candidate(s = \"10000000000000\") == -1\n    assert candidate(s = \"1001101\") == -1\n    assert candidate(s = \"00110011001100110011001100110011001\") == -1\n    assert candidate(s = \"110101011010101\") == -1\n    assert candidate(s = \"111101111\") == 7\n    assert candidate(s = \"1111111111111111111111111111111111111\") == 37\n    assert candidate(s = \"101010101010101010101\") == -1\n    assert candidate(s = \"1010101010\") == -1\n    assert candidate(s = \"1100011\") == -1\n    assert candidate(s = \"111111111111111111111\") == 21\n    assert candidate(s = \"11010110101101101\") == -1\n    assert candidate(s = \"10001000100010001000100010001\") == -1\n    assert candidate(s = \"11000011000011000011\") == -1\n    assert candidate(s = \"1010101010101010\") == -1\n    assert candidate(s = \"11010101101\") == -1\n    assert candidate(s = \"110011001100110011\") == -1\n    assert candidate(s = \"10100001001\") == -1\n    assert candidate(s = \"1111100000001\") == -1\n    assert candidate(s = \"1011101110111011101110111011101\") == 15\n    assert candidate(s = \"11111111111111101\") == 11\n    assert candidate(s = \"111110111110111\") == 7\n    assert candidate(s = \"010001\") == -1\n    assert candidate(s = \"110011\") == 2\n    assert candidate(s = \"10000000000000000\") == -1\n    assert candidate(s = \"11110000111100001111\") == -1\n    assert candidate(s = \"10011101\") == -1\n    assert candidate(s = \"100100100100100\") == -1\n    assert candidate(s = \"11111111111111111111111\") == 23\n    assert candidate(s = \"1111111111111111111111111111111\") == 31\n    assert candidate(s = \"11111111111111111111111111111111111\") == 35\n    assert candidate(s = \"1011101\") == 3\n    assert candidate(s = \"11001100110011001\") == -1\n    assert candidate(s = \"111001110011100\") == -1\n    assert candidate(s = \"1111111111111111\") == 16\n    assert candidate(s = \"11101110111011101\") == 9\n    assert candidate(s = \"110011001100110\") == -1\n    assert candidate(s = \"10101010101010101010101010101010101\") == -1\n    assert candidate(s = \"11111100111\") == 7\n    assert candidate(s = \"101010101010101010101010101010101010101\") == -1\n    assert candidate(s = \"1111101111101\") == 5\n    assert candidate(s = \"010101010101010101010101010101\") == -1\n    assert candidate(s = \"11100111001110011\") == 5\n    assert candidate(s = \"1010010101010\") == -1\n    assert candidate(s = \"11111111111111011\") == 11\n    assert candidate(s = \"11010110111\") == -1\n    assert candidate(s = \"11001101\") == 2\n    assert candidate(s = \"101101001\") == -1\n    assert candidate(s = \"100100010010001\") == -1\n    assert candidate(s = \"111100001111\") == -1\n    assert candidate(s = \"110010\") == -1\n    assert candidate(s = \"1001001\") == -1\n    assert candidate(s = \"100110010011001\") == -1\n    assert candidate(s = \"1100110011001100110\") == -1\n    assert candidate(s = \"1100100110001\") == -1\n    assert candidate(s = \"1000000000000\") == -1\n    assert candidate(s = \"1111100111\") == 6\n    assert candidate(s = \"111111111111110\") == -1\n    assert candidate(s = \"111011101110111\") == 9\n    assert candidate(s = \"1011101110111011101110111\") == 13\n    assert candidate(s = \"1111111111111111111111111\") == 25\n    assert candidate(s = \"000000000000000\") == -1\n    assert candidate(s = \"11010101010\") == -1\n    assert candidate(s = \"111111111111111111111111111111111\") == 33\n    assert candidate(s = \"1111111111111\") == 13\n    assert candidate(s = \"111110111100001\") == -1\n    assert candidate(s = \"1111000011110000111\") == -1\n    assert candidate(s = \"10000100001\") == -1\n    assert candidate(s = \"11101001101\") == -1\n    assert candidate(s = \"0101010101\") == -1\n    assert candidate(s = \"11001001001001001\") == -1\n    assert candidate(s = \"11001000110101\") == -1\n    assert candidate(s = \"111111111111111111111111111111111111111\") == 39\n    assert candidate(s = \"10101010101010101\") == -1\n    assert candidate(s = \"10110110110\") == -1\n    assert candidate(s = \"11011011011\") == 5\n    assert candidate(s = \"101010101010110\") == -1\n    assert candidate(s = \"11111111101\") == 5\n    assert candidate(s = \"101101101101101101\") == 6\n    assert candidate(s = \"1010101010101\") == -1\n    assert candidate(s = \"1100010000100\") == -1\n    assert candidate(s = \"1110011100111\") == 5\n    assert candidate(s = \"11111111101111111\") == 11\n    assert candidate(s = \"1111100001\") == -1\n    assert candidate(s = \"10011001\") == -1\n    assert candidate(s = \"11111011111011111\") == 9\n    assert candidate(s = \"110010111011101\") == -1\n    assert candidate(s = \"110011101100111\") == -1\n    assert candidate(s = \"111101110111011\") == 9\n    assert candidate(s = \"1100110011001100110011001100110\") == -1\n    assert candidate(s = \"1001001001001\") == -1\n    assert candidate(s = \"11111111111\") == 11\n    assert candidate(s = \"100101010100101\") == -1\n    assert candidate(s = \"101111111111111\") == 13\n    assert candidate(s = \"111100001111000\") == -1\n    assert candidate(s = \"1100110011001100110011\") == -1\n    assert candidate(s = \"111111000111111\") == -1\n    assert candidate(s = \"1010101010101011\") == -1\n    assert candidate(s = \"1111101\") == 1\n    assert candidate(s = \"11011011011011011\") == 7\n    assert candidate(s = \"000000\") == -1\n    assert candidate(s = \"100100001001000100\") == -1\n    assert candidate(s = \"111111000000111\") == -1\n    assert candidate(s = \"10001000100010001\") == -1\n    assert candidate(s = \"110110110110110\") == -1\n    assert candidate(s = \"111111111111111111111111111\") == 27\n    assert candidate(s = \"1000000000001\") == -1\n    assert candidate(s = \"0000000000000000000000\") == -1\n    assert candidate(s = \"110010111\") == -1\n    assert candidate(s = \"1010010001101010\") == -1\n    assert candidate(s = \"11001100110011001100110011\") == -1\n    assert candidate(s = \"100000100000100\") == -1\n    assert candidate(s = \"1001110001\") == 1\n",
  "test_cases": [
    "assert candidate(s = \"1100101\") == -1",
    "assert candidate(s = \"100000000000000\") == -1",
    "assert candidate(s = \"101010101010101\") == -1",
    "assert candidate(s = \"101010101\") == -1",
    "assert candidate(s = \"111\") == 3",
    "assert candidate(s = \"100000\") == -1",
    "assert candidate(s = \"111111111\") == 9",
    "assert candidate(s = \"0\") == -1",
    "assert candidate(s = \"1010101\") == -1",
    "assert candidate(s = \"1111111\") == 7",
    "assert candidate(s = \"111111111111111\") == 15",
    "assert candidate(s = \"1100001\") == -1",
    "assert candidate(s = \"1011\") == 2",
    "assert candidate(s = \"100111\") == -1",
    "assert candidate(s = \"100111011\") == -1",
    "assert candidate(s = \"1\") == 1",
    "assert candidate(s = \"110000\") == -1",
    "assert candidate(s = \"1000000\") == -1",
    "assert candidate(s = \"1110111\") == 5",
    "assert candidate(s = \"100000000\") == -1",
    "assert candidate(s = \"110011001\") == -1",
    "assert candidate(s = \"11001\") == 1",
    "assert candidate(s = \"0111000111000111000111000111000\") == -1",
    "assert candidate(s = \"10101010101\") == -1",
    "assert candidate(s = \"100010001000100\") == -1",
    "assert candidate(s = \"01101101101101101\") == -1",
    "assert candidate(s = \"1101010101010101\") == -1",
    "assert candidate(s = \"1010101010101010101010101\") == -1",
    "assert candidate(s = \"1111111111111111111\") == 19",
    "assert candidate(s = \"1010101010101010101\") == -1",
    "assert candidate(s = \"00001000010000100001\") == -1",
    "assert candidate(s = \"101010101010001\") == -1",
    "assert candidate(s = \"111011011001111\") == -1",
    "assert candidate(s = \"1011011011011011011\") == 7",
    "assert candidate(s = \"100000000000001\") == -1",
    "assert candidate(s = \"111000111000111\") == -1",
    "assert candidate(s = \"10000000000000\") == -1",
    "assert candidate(s = \"1001101\") == -1",
    "assert candidate(s = \"00110011001100110011001100110011001\") == -1",
    "assert candidate(s = \"110101011010101\") == -1",
    "assert candidate(s = \"111101111\") == 7",
    "assert candidate(s = \"1111111111111111111111111111111111111\") == 37",
    "assert candidate(s = \"101010101010101010101\") == -1",
    "assert candidate(s = \"1010101010\") == -1",
    "assert candidate(s = \"1100011\") == -1",
    "assert candidate(s = \"111111111111111111111\") == 21",
    "assert candidate(s = \"11010110101101101\") == -1",
    "assert candidate(s = \"10001000100010001000100010001\") == -1",
    "assert candidate(s = \"11000011000011000011\") == -1",
    "assert candidate(s = \"1010101010101010\") == -1",
    "assert candidate(s = \"11010101101\") == -1",
    "assert candidate(s = \"110011001100110011\") == -1",
    "assert candidate(s = \"10100001001\") == -1",
    "assert candidate(s = \"1111100000001\") == -1",
    "assert candidate(s = \"1011101110111011101110111011101\") == 15",
    "assert candidate(s = \"11111111111111101\") == 11",
    "assert candidate(s = \"111110111110111\") == 7",
    "assert candidate(s = \"010001\") == -1",
    "assert candidate(s = \"110011\") == 2",
    "assert candidate(s = \"10000000000000000\") == -1",
    "assert candidate(s = \"11110000111100001111\") == -1",
    "assert candidate(s = \"10011101\") == -1",
    "assert candidate(s = \"100100100100100\") == -1",
    "assert candidate(s = \"11111111111111111111111\") == 23",
    "assert candidate(s = \"1111111111111111111111111111111\") == 31",
    "assert candidate(s = \"11111111111111111111111111111111111\") == 35",
    "assert candidate(s = \"1011101\") == 3",
    "assert candidate(s = \"11001100110011001\") == -1",
    "assert candidate(s = \"111001110011100\") == -1",
    "assert candidate(s = \"1111111111111111\") == 16",
    "assert candidate(s = \"11101110111011101\") == 9",
    "assert candidate(s = \"110011001100110\") == -1",
    "assert candidate(s = \"10101010101010101010101010101010101\") == -1",
    "assert candidate(s = \"11111100111\") == 7",
    "assert candidate(s = \"101010101010101010101010101010101010101\") == -1",
    "assert candidate(s = \"1111101111101\") == 5",
    "assert candidate(s = \"010101010101010101010101010101\") == -1",
    "assert candidate(s = \"11100111001110011\") == 5",
    "assert candidate(s = \"1010010101010\") == -1",
    "assert candidate(s = \"11111111111111011\") == 11",
    "assert candidate(s = \"11010110111\") == -1",
    "assert candidate(s = \"11001101\") == 2",
    "assert candidate(s = \"101101001\") == -1",
    "assert candidate(s = \"100100010010001\") == -1",
    "assert candidate(s = \"111100001111\") == -1",
    "assert candidate(s = \"110010\") == -1",
    "assert candidate(s = \"1001001\") == -1",
    "assert candidate(s = \"100110010011001\") == -1",
    "assert candidate(s = \"1100110011001100110\") == -1",
    "assert candidate(s = \"1100100110001\") == -1",
    "assert candidate(s = \"1000000000000\") == -1",
    "assert candidate(s = \"1111100111\") == 6",
    "assert candidate(s = \"111111111111110\") == -1",
    "assert candidate(s = \"111011101110111\") == 9",
    "assert candidate(s = \"1011101110111011101110111\") == 13",
    "assert candidate(s = \"1111111111111111111111111\") == 25",
    "assert candidate(s = \"000000000000000\") == -1",
    "assert candidate(s = \"11010101010\") == -1",
    "assert candidate(s = \"111111111111111111111111111111111\") == 33",
    "assert candidate(s = \"1111111111111\") == 13",
    "assert candidate(s = \"111110111100001\") == -1",
    "assert candidate(s = \"1111000011110000111\") == -1",
    "assert candidate(s = \"10000100001\") == -1",
    "assert candidate(s = \"11101001101\") == -1",
    "assert candidate(s = \"0101010101\") == -1",
    "assert candidate(s = \"11001001001001001\") == -1",
    "assert candidate(s = \"11001000110101\") == -1",
    "assert candidate(s = \"111111111111111111111111111111111111111\") == 39",
    "assert candidate(s = \"10101010101010101\") == -1",
    "assert candidate(s = \"10110110110\") == -1",
    "assert candidate(s = \"11011011011\") == 5",
    "assert candidate(s = \"101010101010110\") == -1",
    "assert candidate(s = \"11111111101\") == 5",
    "assert candidate(s = \"101101101101101101\") == 6",
    "assert candidate(s = \"1010101010101\") == -1",
    "assert candidate(s = \"1100010000100\") == -1",
    "assert candidate(s = \"1110011100111\") == 5",
    "assert candidate(s = \"11111111101111111\") == 11",
    "assert candidate(s = \"1111100001\") == -1",
    "assert candidate(s = \"10011001\") == -1",
    "assert candidate(s = \"11111011111011111\") == 9",
    "assert candidate(s = \"110010111011101\") == -1",
    "assert candidate(s = \"110011101100111\") == -1",
    "assert candidate(s = \"111101110111011\") == 9",
    "assert candidate(s = \"1100110011001100110011001100110\") == -1",
    "assert candidate(s = \"1001001001001\") == -1",
    "assert candidate(s = \"11111111111\") == 11",
    "assert candidate(s = \"100101010100101\") == -1",
    "assert candidate(s = \"101111111111111\") == 13",
    "assert candidate(s = \"111100001111000\") == -1",
    "assert candidate(s = \"1100110011001100110011\") == -1",
    "assert candidate(s = \"111111000111111\") == -1",
    "assert candidate(s = \"1010101010101011\") == -1",
    "assert candidate(s = \"1111101\") == 1",
    "assert candidate(s = \"11011011011011011\") == 7",
    "assert candidate(s = \"000000\") == -1",
    "assert candidate(s = \"100100001001000100\") == -1",
    "assert candidate(s = \"111111000000111\") == -1",
    "assert candidate(s = \"10001000100010001\") == -1",
    "assert candidate(s = \"110110110110110\") == -1",
    "assert candidate(s = \"111111111111111111111111111\") == 27",
    "assert candidate(s = \"1000000000001\") == -1",
    "assert candidate(s = \"0000000000000000000000\") == -1",
    "assert candidate(s = \"110010111\") == -1",
    "assert candidate(s = \"1010010001101010\") == -1",
    "assert candidate(s = \"11001100110011001100110011\") == -1",
    "assert candidate(s = \"100000100000100\") == -1",
    "assert candidate(s = \"1001110001\") == 1"
  ]
}